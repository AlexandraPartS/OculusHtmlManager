!function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var i = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(i.exports, i, i.exports, n), i.l = !0, i.exports } n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) n.d(r, i, function (t) { return e[t] }.bind(null, i)); return r }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 45) }([function (e, t, n) {
    "use strict"; n.r(t), n.d(t, "__extends", (function () { return i })), n.d(t, "__assign", (function () { return o })), n.d(t, "__rest", (function () { return a })), n.d(t, "__decorate", (function () { return s })), n.d(t, "__param", (function () { return u })), n.d(t, "__metadata", (function () { return c })), n.d(t, "__awaiter", (function () { return l })), n.d(t, "__generator", (function () { return d })), n.d(t, "__createBinding", (function () { return f })), n.d(t, "__exportStar", (function () { return h })), n.d(t, "__values", (function () { return p })), n.d(t, "__read", (function () { return E })), n.d(t, "__spread", (function () { return v })), n.d(t, "__spreadArrays", (function () { return m })), n.d(t, "__await", (function () { return y })), n.d(t, "__asyncGenerator", (function () { return _ })), n.d(t, "__asyncDelegator", (function () { return g })), n.d(t, "__asyncValues", (function () { return S })), n.d(t, "__makeTemplateObject", (function () { return C })), n.d(t, "__importStar", (function () { return O })), n.d(t, "__importDefault", (function () { return T })), n.d(t, "__classPrivateFieldGet", (function () { return D })), n.d(t, "__classPrivateFieldSet", (function () { return I }));
    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation.
    
    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.
    
    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
    var r = function (e, t) { return (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) })(e, t) }; function i(e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) } var o = function () { return (o = Object.assign || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var i in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]); return e }).apply(this, arguments) }; function a(e, t) { var n = {}; for (var r in e) Object.prototype.hasOwnProperty.call(e, r) && t.indexOf(r) < 0 && (n[r] = e[r]); if (null != e && "function" == typeof Object.getOwnPropertySymbols) { var i = 0; for (r = Object.getOwnPropertySymbols(e); i < r.length; i++)t.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(e, r[i]) && (n[r[i]] = e[r[i]]) } return n } function s(e, t, n, r) { var i, o = arguments.length, a = o < 3 ? t : null === r ? r = Object.getOwnPropertyDescriptor(t, n) : r; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) a = Reflect.decorate(e, t, n, r); else for (var s = e.length - 1; s >= 0; s--)(i = e[s]) && (a = (o < 3 ? i(a) : o > 3 ? i(t, n, a) : i(t, n)) || a); return o > 3 && a && Object.defineProperty(t, n, a), a } function u(e, t) { return function (n, r) { t(n, r, e) } } function c(e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) } function l(e, t, n, r) { return new (n || (n = Promise))((function (i, o) { function a(e) { try { u(r.next(e)) } catch (e) { o(e) } } function s(e) { try { u(r.throw(e)) } catch (e) { o(e) } } function u(e) { var t; e.done ? i(e.value) : (t = e.value, t instanceof n ? t : new n((function (e) { e(t) }))).then(a, s) } u((r = r.apply(e, t || [])).next()) })) } function d(e, t) { var n, r, i, o, a = { label: 0, sent: function () { if (1 & i[0]) throw i[1]; return i[1] }, trys: [], ops: [] }; return o = { next: s(0), throw: s(1), return: s(2) }, "function" == typeof Symbol && (o[Symbol.iterator] = function () { return this }), o; function s(o) { return function (s) { return function (o) { if (n) throw new TypeError("Generator is already executing."); for (; a;)try { if (n = 1, r && (i = 2 & o[0] ? r.return : o[0] ? r.throw || ((i = r.return) && i.call(r), 0) : r.next) && !(i = i.call(r, o[1])).done) return i; switch (r = 0, i && (o = [2 & o[0], i.value]), o[0]) { case 0: case 1: i = o; break; case 4: return a.label++, { value: o[1], done: !1 }; case 5: a.label++, r = o[1], o = [0]; continue; case 7: o = a.ops.pop(), a.trys.pop(); continue; default: if (!(i = a.trys, (i = i.length > 0 && i[i.length - 1]) || 6 !== o[0] && 2 !== o[0])) { a = 0; continue } if (3 === o[0] && (!i || o[1] > i[0] && o[1] < i[3])) { a.label = o[1]; break } if (6 === o[0] && a.label < i[1]) { a.label = i[1], i = o; break } if (i && a.label < i[2]) { a.label = i[2], a.ops.push(o); break } i[2] && a.ops.pop(), a.trys.pop(); continue }o = t.call(e, a) } catch (e) { o = [6, e], r = 0 } finally { n = i = 0 } if (5 & o[0]) throw o[1]; return { value: o[0] ? o[1] : void 0, done: !0 } }([o, s]) } } } function f(e, t, n, r) { void 0 === r && (r = n), e[r] = t[n] } function h(e, t) { for (var n in e) "default" === n || t.hasOwnProperty(n) || (t[n] = e[n]) } function p(e) { var t = "function" == typeof Symbol && Symbol.iterator, n = t && e[t], r = 0; if (n) return n.call(e); if (e && "number" == typeof e.length) return { next: function () { return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e } } }; throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.") } function E(e, t) { var n = "function" == typeof Symbol && e[Symbol.iterator]; if (!n) return e; var r, i, o = n.call(e), a = []; try { for (; (void 0 === t || t-- > 0) && !(r = o.next()).done;)a.push(r.value) } catch (e) { i = { error: e } } finally { try { r && !r.done && (n = o.return) && n.call(o) } finally { if (i) throw i.error } } return a } function v() { for (var e = [], t = 0; t < arguments.length; t++)e = e.concat(E(arguments[t])); return e } function m() { for (var e = 0, t = 0, n = arguments.length; t < n; t++)e += arguments[t].length; var r = Array(e), i = 0; for (t = 0; t < n; t++)for (var o = arguments[t], a = 0, s = o.length; a < s; a++, i++)r[i] = o[a]; return r } function y(e) { return this instanceof y ? (this.v = e, this) : new y(e) } function _(e, t, n) { if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined."); var r, i = n.apply(e, t || []), o = []; return r = {}, a("next"), a("throw"), a("return"), r[Symbol.asyncIterator] = function () { return this }, r; function a(e) { i[e] && (r[e] = function (t) { return new Promise((function (n, r) { o.push([e, t, n, r]) > 1 || s(e, t) })) }) } function s(e, t) { try { (n = i[e](t)).value instanceof y ? Promise.resolve(n.value.v).then(u, c) : l(o[0][2], n) } catch (e) { l(o[0][3], e) } var n } function u(e) { s("next", e) } function c(e) { s("throw", e) } function l(e, t) { e(t), o.shift(), o.length && s(o[0][0], o[0][1]) } } function g(e) { var t, n; return t = {}, r("next"), r("throw", (function (e) { throw e })), r("return"), t[Symbol.iterator] = function () { return this }, t; function r(r, i) { t[r] = e[r] ? function (t) { return (n = !n) ? { value: y(e[r](t)), done: "return" === r } : i ? i(t) : t } : i } } function S(e) { if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined."); var t, n = e[Symbol.asyncIterator]; return n ? n.call(e) : (e = p(e), t = {}, r("next"), r("throw"), r("return"), t[Symbol.asyncIterator] = function () { return this }, t); function r(n) { t[n] = e[n] && function (t) { return new Promise((function (r, i) { (function (e, t, n, r) { Promise.resolve(r).then((function (t) { e({ value: t, done: n }) }), t) })(r, i, (t = e[n](t)).done, t.value) })) } } } function C(e, t) { return Object.defineProperty ? Object.defineProperty(e, "raw", { value: t }) : e.raw = t, e } function O(e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var n in e) Object.hasOwnProperty.call(e, n) && (t[n] = e[n]); return t.default = e, t } function T(e) { return e && e.__esModule ? e : { default: e } } function D(e, t) { if (!t.has(e)) throw new TypeError("attempted to get private field on non-instance"); return t.get(e) } function I(e, t, n) { if (!t.has(e)) throw new TypeError("attempted to set private field on non-instance"); return t.set(e, n), n }
}, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.filterTrailingZeroes = function (e) { var t = 0; return e.reverse().filter((function (e) { return t || (t = e) })).reverse() }, e.prettyBytes = function (t) { for (var n = 0; t >= 512;)n++, t /= 1024; return "" + t.toFixed(n ? 1 : 0) + e.SUFFIX[n] }, e.escapeUdid = function (e) { return "udid_" + e.replace(/[. :]/g, "_") }, e.parseBooleanEnv = function (e) { return "boolean" == typeof e ? e : void 0 !== e ? (Array.isArray(e) && (e = e[e.length - 1]), "1" === e || "true" === e.toLowerCase()) : void 0 }, e.parseStringEnv = function (e) { return void 0 === e ? "" : (Array.isArray(e) && (e = e[e.length - 1]), e) }, e.parseIntEnv = function (e) { if ("number" == typeof e) return e; if (void 0 !== e) { Array.isArray(e) && (e = e[e.length - 1]); var t = parseInt(e, 10); if (!isNaN(t)) return t } }, e.utf8ByteArrayToString = function (e) { for (var t = [], n = 0, r = 0; n < e.length;) { var i = e[n++]; if (i < 128) t[r++] = String.fromCharCode(i); else if (i > 191 && i < 224) { var o = e[n++]; t[r++] = String.fromCharCode((31 & i) << 6 | 63 & o) } else if (i > 239 && i < 365) { var a = ((7 & i) << 18 | (63 & (o = e[n++])) << 12 | (63 & (s = e[n++])) << 6 | 63 & e[n++]) - 65536; t[r++] = String.fromCharCode(55296 + (a >> 10)), t[r++] = String.fromCharCode(56320 + (1023 & a)) } else { o = e[n++]; var s = e[n++]; t[r++] = String.fromCharCode((15 & i) << 12 | (63 & o) << 6 | 63 & s) } } return t.join("") }, e.supportsPassive = function () { if ("boolean" == typeof e.supportsPassiveValue) return e.supportsPassiveValue; var t = !1; try { var n = Object.defineProperty({}, "passive", { get: function () { t = !0 } }); window.addEventListener("testPassive", null, n), window.removeEventListener("testPassive", null, n) } catch (e) { } return e.supportsPassiveValue = t }, e.SUFFIX = { 0: "B", 1: "KiB", 2: "MiB", 3: "GiB", 4: "TiB" }, e.stringToUtf8ByteArray = function (e) { for (var t = [], n = 0, r = 0; r < e.length; r++) { var i = e.charCodeAt(r); i < 128 ? t[n++] = i : i < 2048 ? (t[n++] = i >> 6 | 192, t[n++] = 63 & i | 128) : 55296 == (64512 & i) && r + 1 < e.length && 56320 == (64512 & e.charCodeAt(r + 1)) ? (i = 65536 + ((1023 & i) << 10) + (1023 & e.charCodeAt(++r)), t[n++] = i >> 18 | 240, t[n++] = i >> 12 & 63 | 128, t[n++] = i >> 6 & 63 | 128, t[n++] = 63 & i | 128) : (t[n++] = i >> 12 | 224, t[n++] = i >> 6 & 63 | 128, t[n++] = 63 & i | 128) } return Uint8Array.from(t) }, e }(); t.default = r }, function (e, t, n) {
    "use strict"; (function (e) {
        /*!
         * The buffer module from node.js, for the browser.
         *
         * @author   Feross Aboukhadijeh <http://feross.org>
         * @license  MIT
         */
        var r = n(50), i = n(51), o = n(52); function a() { return u.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823 } function s(e, t) { if (a() < t) throw new RangeError("Invalid typed array length"); return u.TYPED_ARRAY_SUPPORT ? (e = new Uint8Array(t)).__proto__ = u.prototype : (null === e && (e = new u(t)), e.length = t), e } function u(e, t, n) { if (!(u.TYPED_ARRAY_SUPPORT || this instanceof u)) return new u(e, t, n); if ("number" == typeof e) { if ("string" == typeof t) throw new Error("If encoding is specified then the first argument must be a string"); return d(this, e) } return c(this, e, t, n) } function c(e, t, n, r) { if ("number" == typeof t) throw new TypeError('"value" argument must not be a number'); return "undefined" != typeof ArrayBuffer && t instanceof ArrayBuffer ? function (e, t, n, r) { if (t.byteLength, n < 0 || t.byteLength < n) throw new RangeError("'offset' is out of bounds"); if (t.byteLength < n + (r || 0)) throw new RangeError("'length' is out of bounds"); t = void 0 === n && void 0 === r ? new Uint8Array(t) : void 0 === r ? new Uint8Array(t, n) : new Uint8Array(t, n, r); u.TYPED_ARRAY_SUPPORT ? (e = t).__proto__ = u.prototype : e = f(e, t); return e }(e, t, n, r) : "string" == typeof t ? function (e, t, n) { "string" == typeof n && "" !== n || (n = "utf8"); if (!u.isEncoding(n)) throw new TypeError('"encoding" must be a valid string encoding'); var r = 0 | p(t, n), i = (e = s(e, r)).write(t, n); i !== r && (e = e.slice(0, i)); return e }(e, t, n) : function (e, t) { if (u.isBuffer(t)) { var n = 0 | h(t.length); return 0 === (e = s(e, n)).length || t.copy(e, 0, 0, n), e } if (t) { if ("undefined" != typeof ArrayBuffer && t.buffer instanceof ArrayBuffer || "length" in t) return "number" != typeof t.length || (r = t.length) != r ? s(e, 0) : f(e, t); if ("Buffer" === t.type && o(t.data)) return f(e, t.data) } var r; throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.") }(e, t) } function l(e) { if ("number" != typeof e) throw new TypeError('"size" argument must be a number'); if (e < 0) throw new RangeError('"size" argument must not be negative') } function d(e, t) { if (l(t), e = s(e, t < 0 ? 0 : 0 | h(t)), !u.TYPED_ARRAY_SUPPORT) for (var n = 0; n < t; ++n)e[n] = 0; return e } function f(e, t) { var n = t.length < 0 ? 0 : 0 | h(t.length); e = s(e, n); for (var r = 0; r < n; r += 1)e[r] = 255 & t[r]; return e } function h(e) { if (e >= a()) throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + a().toString(16) + " bytes"); return 0 | e } function p(e, t) { if (u.isBuffer(e)) return e.length; if ("undefined" != typeof ArrayBuffer && "function" == typeof ArrayBuffer.isView && (ArrayBuffer.isView(e) || e instanceof ArrayBuffer)) return e.byteLength; "string" != typeof e && (e = "" + e); var n = e.length; if (0 === n) return 0; for (var r = !1; ;)switch (t) { case "ascii": case "latin1": case "binary": return n; case "utf8": case "utf-8": case void 0: return x(e).length; case "ucs2": case "ucs-2": case "utf16le": case "utf-16le": return 2 * n; case "hex": return n >>> 1; case "base64": return k(e).length; default: if (r) return x(e).length; t = ("" + t).toLowerCase(), r = !0 } } function E(e, t, n) { var r = !1; if ((void 0 === t || t < 0) && (t = 0), t > this.length) return ""; if ((void 0 === n || n > this.length) && (n = this.length), n <= 0) return ""; if ((n >>>= 0) <= (t >>>= 0)) return ""; for (e || (e = "utf8"); ;)switch (e) { case "hex": return A(this, t, n); case "utf8": case "utf-8": return I(this, t, n); case "ascii": return w(this, t, n); case "latin1": case "binary": return b(this, t, n); case "base64": return D(this, t, n); case "ucs2": case "ucs-2": case "utf16le": case "utf-16le": return P(this, t, n); default: if (r) throw new TypeError("Unknown encoding: " + e); e = (e + "").toLowerCase(), r = !0 } } function v(e, t, n) { var r = e[t]; e[t] = e[n], e[n] = r } function m(e, t, n, r, i) { if (0 === e.length) return -1; if ("string" == typeof n ? (r = n, n = 0) : n > 2147483647 ? n = 2147483647 : n < -2147483648 && (n = -2147483648), n = +n, isNaN(n) && (n = i ? 0 : e.length - 1), n < 0 && (n = e.length + n), n >= e.length) { if (i) return -1; n = e.length - 1 } else if (n < 0) { if (!i) return -1; n = 0 } if ("string" == typeof t && (t = u.from(t, r)), u.isBuffer(t)) return 0 === t.length ? -1 : y(e, t, n, r, i); if ("number" == typeof t) return t &= 255, u.TYPED_ARRAY_SUPPORT && "function" == typeof Uint8Array.prototype.indexOf ? i ? Uint8Array.prototype.indexOf.call(e, t, n) : Uint8Array.prototype.lastIndexOf.call(e, t, n) : y(e, [t], n, r, i); throw new TypeError("val must be string, number or Buffer") } function y(e, t, n, r, i) { var o, a = 1, s = e.length, u = t.length; if (void 0 !== r && ("ucs2" === (r = String(r).toLowerCase()) || "ucs-2" === r || "utf16le" === r || "utf-16le" === r)) { if (e.length < 2 || t.length < 2) return -1; a = 2, s /= 2, u /= 2, n /= 2 } function c(e, t) { return 1 === a ? e[t] : e.readUInt16BE(t * a) } if (i) { var l = -1; for (o = n; o < s; o++)if (c(e, o) === c(t, -1 === l ? 0 : o - l)) { if (-1 === l && (l = o), o - l + 1 === u) return l * a } else -1 !== l && (o -= o - l), l = -1 } else for (n + u > s && (n = s - u), o = n; o >= 0; o--) { for (var d = !0, f = 0; f < u; f++)if (c(e, o + f) !== c(t, f)) { d = !1; break } if (d) return o } return -1 } function _(e, t, n, r) { n = Number(n) || 0; var i = e.length - n; r ? (r = Number(r)) > i && (r = i) : r = i; var o = t.length; if (o % 2 != 0) throw new TypeError("Invalid hex string"); r > o / 2 && (r = o / 2); for (var a = 0; a < r; ++a) { var s = parseInt(t.substr(2 * a, 2), 16); if (isNaN(s)) return a; e[n + a] = s } return a } function g(e, t, n, r) { return H(x(t, e.length - n), e, n, r) } function S(e, t, n, r) { return H(function (e) { for (var t = [], n = 0; n < e.length; ++n)t.push(255 & e.charCodeAt(n)); return t }(t), e, n, r) } function C(e, t, n, r) { return S(e, t, n, r) } function O(e, t, n, r) { return H(k(t), e, n, r) } function T(e, t, n, r) { return H(function (e, t) { for (var n, r, i, o = [], a = 0; a < e.length && !((t -= 2) < 0); ++a)n = e.charCodeAt(a), r = n >> 8, i = n % 256, o.push(i), o.push(r); return o }(t, e.length - n), e, n, r) } function D(e, t, n) { return 0 === t && n === e.length ? r.fromByteArray(e) : r.fromByteArray(e.slice(t, n)) } function I(e, t, n) { n = Math.min(e.length, n); for (var r = [], i = t; i < n;) { var o, a, s, u, c = e[i], l = null, d = c > 239 ? 4 : c > 223 ? 3 : c > 191 ? 2 : 1; if (i + d <= n) switch (d) { case 1: c < 128 && (l = c); break; case 2: 128 == (192 & (o = e[i + 1])) && (u = (31 & c) << 6 | 63 & o) > 127 && (l = u); break; case 3: o = e[i + 1], a = e[i + 2], 128 == (192 & o) && 128 == (192 & a) && (u = (15 & c) << 12 | (63 & o) << 6 | 63 & a) > 2047 && (u < 55296 || u > 57343) && (l = u); break; case 4: o = e[i + 1], a = e[i + 2], s = e[i + 3], 128 == (192 & o) && 128 == (192 & a) && 128 == (192 & s) && (u = (15 & c) << 18 | (63 & o) << 12 | (63 & a) << 6 | 63 & s) > 65535 && u < 1114112 && (l = u) }null === l ? (l = 65533, d = 1) : l > 65535 && (l -= 65536, r.push(l >>> 10 & 1023 | 55296), l = 56320 | 1023 & l), r.push(l), i += d } return function (e) { var t = e.length; if (t <= 4096) return String.fromCharCode.apply(String, e); var n = "", r = 0; for (; r < t;)n += String.fromCharCode.apply(String, e.slice(r, r += 4096)); return n }(r) } t.Buffer = u, t.SlowBuffer = function (e) { +e != e && (e = 0); return u.alloc(+e) }, t.INSPECT_MAX_BYTES = 50, u.TYPED_ARRAY_SUPPORT = void 0 !== e.TYPED_ARRAY_SUPPORT ? e.TYPED_ARRAY_SUPPORT : function () { try { var e = new Uint8Array(1); return e.__proto__ = { __proto__: Uint8Array.prototype, foo: function () { return 42 } }, 42 === e.foo() && "function" == typeof e.subarray && 0 === e.subarray(1, 1).byteLength } catch (e) { return !1 } }(), t.kMaxLength = a(), u.poolSize = 8192, u._augment = function (e) { return e.__proto__ = u.prototype, e }, u.from = function (e, t, n) { return c(null, e, t, n) }, u.TYPED_ARRAY_SUPPORT && (u.prototype.__proto__ = Uint8Array.prototype, u.__proto__ = Uint8Array, "undefined" != typeof Symbol && Symbol.species && u[Symbol.species] === u && Object.defineProperty(u, Symbol.species, { value: null, configurable: !0 })), u.alloc = function (e, t, n) { return function (e, t, n, r) { return l(t), t <= 0 ? s(e, t) : void 0 !== n ? "string" == typeof r ? s(e, t).fill(n, r) : s(e, t).fill(n) : s(e, t) }(null, e, t, n) }, u.allocUnsafe = function (e) { return d(null, e) }, u.allocUnsafeSlow = function (e) { return d(null, e) }, u.isBuffer = function (e) { return !(null == e || !e._isBuffer) }, u.compare = function (e, t) { if (!u.isBuffer(e) || !u.isBuffer(t)) throw new TypeError("Arguments must be Buffers"); if (e === t) return 0; for (var n = e.length, r = t.length, i = 0, o = Math.min(n, r); i < o; ++i)if (e[i] !== t[i]) { n = e[i], r = t[i]; break } return n < r ? -1 : r < n ? 1 : 0 }, u.isEncoding = function (e) { switch (String(e).toLowerCase()) { case "hex": case "utf8": case "utf-8": case "ascii": case "latin1": case "binary": case "base64": case "ucs2": case "ucs-2": case "utf16le": case "utf-16le": return !0; default: return !1 } }, u.concat = function (e, t) { if (!o(e)) throw new TypeError('"list" argument must be an Array of Buffers'); if (0 === e.length) return u.alloc(0); var n; if (void 0 === t) for (t = 0, n = 0; n < e.length; ++n)t += e[n].length; var r = u.allocUnsafe(t), i = 0; for (n = 0; n < e.length; ++n) { var a = e[n]; if (!u.isBuffer(a)) throw new TypeError('"list" argument must be an Array of Buffers'); a.copy(r, i), i += a.length } return r }, u.byteLength = p, u.prototype._isBuffer = !0, u.prototype.swap16 = function () { var e = this.length; if (e % 2 != 0) throw new RangeError("Buffer size must be a multiple of 16-bits"); for (var t = 0; t < e; t += 2)v(this, t, t + 1); return this }, u.prototype.swap32 = function () { var e = this.length; if (e % 4 != 0) throw new RangeError("Buffer size must be a multiple of 32-bits"); for (var t = 0; t < e; t += 4)v(this, t, t + 3), v(this, t + 1, t + 2); return this }, u.prototype.swap64 = function () { var e = this.length; if (e % 8 != 0) throw new RangeError("Buffer size must be a multiple of 64-bits"); for (var t = 0; t < e; t += 8)v(this, t, t + 7), v(this, t + 1, t + 6), v(this, t + 2, t + 5), v(this, t + 3, t + 4); return this }, u.prototype.toString = function () { var e = 0 | this.length; return 0 === e ? "" : 0 === arguments.length ? I(this, 0, e) : E.apply(this, arguments) }, u.prototype.equals = function (e) { if (!u.isBuffer(e)) throw new TypeError("Argument must be a Buffer"); return this === e || 0 === u.compare(this, e) }, u.prototype.inspect = function () { var e = "", n = t.INSPECT_MAX_BYTES; return this.length > 0 && (e = this.toString("hex", 0, n).match(/.{2}/g).join(" "), this.length > n && (e += " ... ")), "<Buffer " + e + ">" }, u.prototype.compare = function (e, t, n, r, i) { if (!u.isBuffer(e)) throw new TypeError("Argument must be a Buffer"); if (void 0 === t && (t = 0), void 0 === n && (n = e ? e.length : 0), void 0 === r && (r = 0), void 0 === i && (i = this.length), t < 0 || n > e.length || r < 0 || i > this.length) throw new RangeError("out of range index"); if (r >= i && t >= n) return 0; if (r >= i) return -1; if (t >= n) return 1; if (this === e) return 0; for (var o = (i >>>= 0) - (r >>>= 0), a = (n >>>= 0) - (t >>>= 0), s = Math.min(o, a), c = this.slice(r, i), l = e.slice(t, n), d = 0; d < s; ++d)if (c[d] !== l[d]) { o = c[d], a = l[d]; break } return o < a ? -1 : a < o ? 1 : 0 }, u.prototype.includes = function (e, t, n) { return -1 !== this.indexOf(e, t, n) }, u.prototype.indexOf = function (e, t, n) { return m(this, e, t, n, !0) }, u.prototype.lastIndexOf = function (e, t, n) { return m(this, e, t, n, !1) }, u.prototype.write = function (e, t, n, r) { if (void 0 === t) r = "utf8", n = this.length, t = 0; else if (void 0 === n && "string" == typeof t) r = t, n = this.length, t = 0; else { if (!isFinite(t)) throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported"); t |= 0, isFinite(n) ? (n |= 0, void 0 === r && (r = "utf8")) : (r = n, n = void 0) } var i = this.length - t; if ((void 0 === n || n > i) && (n = i), e.length > 0 && (n < 0 || t < 0) || t > this.length) throw new RangeError("Attempt to write outside buffer bounds"); r || (r = "utf8"); for (var o = !1; ;)switch (r) { case "hex": return _(this, e, t, n); case "utf8": case "utf-8": return g(this, e, t, n); case "ascii": return S(this, e, t, n); case "latin1": case "binary": return C(this, e, t, n); case "base64": return O(this, e, t, n); case "ucs2": case "ucs-2": case "utf16le": case "utf-16le": return T(this, e, t, n); default: if (o) throw new TypeError("Unknown encoding: " + r); r = ("" + r).toLowerCase(), o = !0 } }, u.prototype.toJSON = function () { return { type: "Buffer", data: Array.prototype.slice.call(this._arr || this, 0) } }; function w(e, t, n) { var r = ""; n = Math.min(e.length, n); for (var i = t; i < n; ++i)r += String.fromCharCode(127 & e[i]); return r } function b(e, t, n) { var r = ""; n = Math.min(e.length, n); for (var i = t; i < n; ++i)r += String.fromCharCode(e[i]); return r } function A(e, t, n) { var r = e.length; (!t || t < 0) && (t = 0), (!n || n < 0 || n > r) && (n = r); for (var i = "", o = t; o < n; ++o)i += Y(e[o]); return i } function P(e, t, n) { for (var r = e.slice(t, n), i = "", o = 0; o < r.length; o += 2)i += String.fromCharCode(r[o] + 256 * r[o + 1]); return i } function N(e, t, n) { if (e % 1 != 0 || e < 0) throw new RangeError("offset is not uint"); if (e + t > n) throw new RangeError("Trying to access beyond buffer length") } function R(e, t, n, r, i, o) { if (!u.isBuffer(e)) throw new TypeError('"buffer" argument must be a Buffer instance'); if (t > i || t < o) throw new RangeError('"value" argument is out of bounds'); if (n + r > e.length) throw new RangeError("Index out of range") } function M(e, t, n, r) { t < 0 && (t = 65535 + t + 1); for (var i = 0, o = Math.min(e.length - n, 2); i < o; ++i)e[n + i] = (t & 255 << 8 * (r ? i : 1 - i)) >>> 8 * (r ? i : 1 - i) } function L(e, t, n, r) { t < 0 && (t = 4294967295 + t + 1); for (var i = 0, o = Math.min(e.length - n, 4); i < o; ++i)e[n + i] = t >>> 8 * (r ? i : 3 - i) & 255 } function B(e, t, n, r, i, o) { if (n + r > e.length) throw new RangeError("Index out of range"); if (n < 0) throw new RangeError("Index out of range") } function U(e, t, n, r, o) { return o || B(e, 0, n, 4), i.write(e, t, n, r, 23, 4), n + 4 } function F(e, t, n, r, o) { return o || B(e, 0, n, 8), i.write(e, t, n, r, 52, 8), n + 8 } u.prototype.slice = function (e, t) { var n, r = this.length; if ((e = ~~e) < 0 ? (e += r) < 0 && (e = 0) : e > r && (e = r), (t = void 0 === t ? r : ~~t) < 0 ? (t += r) < 0 && (t = 0) : t > r && (t = r), t < e && (t = e), u.TYPED_ARRAY_SUPPORT) (n = this.subarray(e, t)).__proto__ = u.prototype; else { var i = t - e; n = new u(i, void 0); for (var o = 0; o < i; ++o)n[o] = this[o + e] } return n }, u.prototype.readUIntLE = function (e, t, n) { e |= 0, t |= 0, n || N(e, t, this.length); for (var r = this[e], i = 1, o = 0; ++o < t && (i *= 256);)r += this[e + o] * i; return r }, u.prototype.readUIntBE = function (e, t, n) { e |= 0, t |= 0, n || N(e, t, this.length); for (var r = this[e + --t], i = 1; t > 0 && (i *= 256);)r += this[e + --t] * i; return r }, u.prototype.readUInt8 = function (e, t) { return t || N(e, 1, this.length), this[e] }, u.prototype.readUInt16LE = function (e, t) { return t || N(e, 2, this.length), this[e] | this[e + 1] << 8 }, u.prototype.readUInt16BE = function (e, t) { return t || N(e, 2, this.length), this[e] << 8 | this[e + 1] }, u.prototype.readUInt32LE = function (e, t) { return t || N(e, 4, this.length), (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3] }, u.prototype.readUInt32BE = function (e, t) { return t || N(e, 4, this.length), 16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]) }, u.prototype.readIntLE = function (e, t, n) { e |= 0, t |= 0, n || N(e, t, this.length); for (var r = this[e], i = 1, o = 0; ++o < t && (i *= 256);)r += this[e + o] * i; return r >= (i *= 128) && (r -= Math.pow(2, 8 * t)), r }, u.prototype.readIntBE = function (e, t, n) { e |= 0, t |= 0, n || N(e, t, this.length); for (var r = t, i = 1, o = this[e + --r]; r > 0 && (i *= 256);)o += this[e + --r] * i; return o >= (i *= 128) && (o -= Math.pow(2, 8 * t)), o }, u.prototype.readInt8 = function (e, t) { return t || N(e, 1, this.length), 128 & this[e] ? -1 * (255 - this[e] + 1) : this[e] }, u.prototype.readInt16LE = function (e, t) { t || N(e, 2, this.length); var n = this[e] | this[e + 1] << 8; return 32768 & n ? 4294901760 | n : n }, u.prototype.readInt16BE = function (e, t) { t || N(e, 2, this.length); var n = this[e + 1] | this[e] << 8; return 32768 & n ? 4294901760 | n : n }, u.prototype.readInt32LE = function (e, t) { return t || N(e, 4, this.length), this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24 }, u.prototype.readInt32BE = function (e, t) { return t || N(e, 4, this.length), this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3] }, u.prototype.readFloatLE = function (e, t) { return t || N(e, 4, this.length), i.read(this, e, !0, 23, 4) }, u.prototype.readFloatBE = function (e, t) { return t || N(e, 4, this.length), i.read(this, e, !1, 23, 4) }, u.prototype.readDoubleLE = function (e, t) { return t || N(e, 8, this.length), i.read(this, e, !0, 52, 8) }, u.prototype.readDoubleBE = function (e, t) { return t || N(e, 8, this.length), i.read(this, e, !1, 52, 8) }, u.prototype.writeUIntLE = function (e, t, n, r) { (e = +e, t |= 0, n |= 0, r) || R(this, e, t, n, Math.pow(2, 8 * n) - 1, 0); var i = 1, o = 0; for (this[t] = 255 & e; ++o < n && (i *= 256);)this[t + o] = e / i & 255; return t + n }, u.prototype.writeUIntBE = function (e, t, n, r) { (e = +e, t |= 0, n |= 0, r) || R(this, e, t, n, Math.pow(2, 8 * n) - 1, 0); var i = n - 1, o = 1; for (this[t + i] = 255 & e; --i >= 0 && (o *= 256);)this[t + i] = e / o & 255; return t + n }, u.prototype.writeUInt8 = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 1, 255, 0), u.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), this[t] = 255 & e, t + 1 }, u.prototype.writeUInt16LE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 2, 65535, 0), u.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : M(this, e, t, !0), t + 2 }, u.prototype.writeUInt16BE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 2, 65535, 0), u.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : M(this, e, t, !1), t + 2 }, u.prototype.writeUInt32LE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 4, 4294967295, 0), u.TYPED_ARRAY_SUPPORT ? (this[t + 3] = e >>> 24, this[t + 2] = e >>> 16, this[t + 1] = e >>> 8, this[t] = 255 & e) : L(this, e, t, !0), t + 4 }, u.prototype.writeUInt32BE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 4, 4294967295, 0), u.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : L(this, e, t, !1), t + 4 }, u.prototype.writeIntLE = function (e, t, n, r) { if (e = +e, t |= 0, !r) { var i = Math.pow(2, 8 * n - 1); R(this, e, t, n, i - 1, -i) } var o = 0, a = 1, s = 0; for (this[t] = 255 & e; ++o < n && (a *= 256);)e < 0 && 0 === s && 0 !== this[t + o - 1] && (s = 1), this[t + o] = (e / a >> 0) - s & 255; return t + n }, u.prototype.writeIntBE = function (e, t, n, r) { if (e = +e, t |= 0, !r) { var i = Math.pow(2, 8 * n - 1); R(this, e, t, n, i - 1, -i) } var o = n - 1, a = 1, s = 0; for (this[t + o] = 255 & e; --o >= 0 && (a *= 256);)e < 0 && 0 === s && 0 !== this[t + o + 1] && (s = 1), this[t + o] = (e / a >> 0) - s & 255; return t + n }, u.prototype.writeInt8 = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 1, 127, -128), u.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), e < 0 && (e = 255 + e + 1), this[t] = 255 & e, t + 1 }, u.prototype.writeInt16LE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 2, 32767, -32768), u.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : M(this, e, t, !0), t + 2 }, u.prototype.writeInt16BE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 2, 32767, -32768), u.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : M(this, e, t, !1), t + 2 }, u.prototype.writeInt32LE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 4, 2147483647, -2147483648), u.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8, this[t + 2] = e >>> 16, this[t + 3] = e >>> 24) : L(this, e, t, !0), t + 4 }, u.prototype.writeInt32BE = function (e, t, n) { return e = +e, t |= 0, n || R(this, e, t, 4, 2147483647, -2147483648), e < 0 && (e = 4294967295 + e + 1), u.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : L(this, e, t, !1), t + 4 }, u.prototype.writeFloatLE = function (e, t, n) { return U(this, e, t, !0, n) }, u.prototype.writeFloatBE = function (e, t, n) { return U(this, e, t, !1, n) }, u.prototype.writeDoubleLE = function (e, t, n) { return F(this, e, t, !0, n) }, u.prototype.writeDoubleBE = function (e, t, n) { return F(this, e, t, !1, n) }, u.prototype.copy = function (e, t, n, r) { if (n || (n = 0), r || 0 === r || (r = this.length), t >= e.length && (t = e.length), t || (t = 0), r > 0 && r < n && (r = n), r === n) return 0; if (0 === e.length || 0 === this.length) return 0; if (t < 0) throw new RangeError("targetStart out of bounds"); if (n < 0 || n >= this.length) throw new RangeError("sourceStart out of bounds"); if (r < 0) throw new RangeError("sourceEnd out of bounds"); r > this.length && (r = this.length), e.length - t < r - n && (r = e.length - t + n); var i, o = r - n; if (this === e && n < t && t < r) for (i = o - 1; i >= 0; --i)e[i + t] = this[i + n]; else if (o < 1e3 || !u.TYPED_ARRAY_SUPPORT) for (i = 0; i < o; ++i)e[i + t] = this[i + n]; else Uint8Array.prototype.set.call(e, this.subarray(n, n + o), t); return o }, u.prototype.fill = function (e, t, n, r) { if ("string" == typeof e) { if ("string" == typeof t ? (r = t, t = 0, n = this.length) : "string" == typeof n && (r = n, n = this.length), 1 === e.length) { var i = e.charCodeAt(0); i < 256 && (e = i) } if (void 0 !== r && "string" != typeof r) throw new TypeError("encoding must be a string"); if ("string" == typeof r && !u.isEncoding(r)) throw new TypeError("Unknown encoding: " + r) } else "number" == typeof e && (e &= 255); if (t < 0 || this.length < t || this.length < n) throw new RangeError("Out of range index"); if (n <= t) return this; var o; if (t >>>= 0, n = void 0 === n ? this.length : n >>> 0, e || (e = 0), "number" == typeof e) for (o = t; o < n; ++o)this[o] = e; else { var a = u.isBuffer(e) ? e : x(new u(e, r).toString()), s = a.length; for (o = 0; o < n - t; ++o)this[o + t] = a[o % s] } return this }; var K = /[^+\/0-9A-Za-z-_]/g; function Y(e) { return e < 16 ? "0" + e.toString(16) : e.toString(16) } function x(e, t) { var n; t = t || 1 / 0; for (var r = e.length, i = null, o = [], a = 0; a < r; ++a) { if ((n = e.charCodeAt(a)) > 55295 && n < 57344) { if (!i) { if (n > 56319) { (t -= 3) > -1 && o.push(239, 191, 189); continue } if (a + 1 === r) { (t -= 3) > -1 && o.push(239, 191, 189); continue } i = n; continue } if (n < 56320) { (t -= 3) > -1 && o.push(239, 191, 189), i = n; continue } n = 65536 + (i - 55296 << 10 | n - 56320) } else i && (t -= 3) > -1 && o.push(239, 191, 189); if (i = null, n < 128) { if ((t -= 1) < 0) break; o.push(n) } else if (n < 2048) { if ((t -= 2) < 0) break; o.push(n >> 6 | 192, 63 & n | 128) } else if (n < 65536) { if ((t -= 3) < 0) break; o.push(n >> 12 | 224, n >> 6 & 63 | 128, 63 & n | 128) } else { if (!(n < 1114112)) throw new Error("Invalid code point"); if ((t -= 4) < 0) break; o.push(n >> 18 | 240, n >> 12 & 63 | 128, n >> 6 & 63 | 128, 63 & n | 128) } } return o } function k(e) { return r.toByteArray(function (e) { if ((e = function (e) { return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "") }(e).replace(K, "")).length < 2) return ""; for (; e.length % 4 != 0;)e += "="; return e }(e)) } function H(e, t, n, r) { for (var i = 0; i < r && !(i + n >= t.length || i >= e.length); ++i)t[i + n] = e[i]; return i }
    }).call(this, n(17))
}, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { this.width = e, this.height = t, this.w = e, this.h = t } return e.equals = function (e, t) { return !e && !t || !!e && !!t && e.equals(t) }, e.copy = function (t) { return t ? new e(t.width, t.height) : null }, e.prototype.length = function () { return this.w * this.h }, e.prototype.rotate = function () { return new e(this.height, this.width) }, e.prototype.equals = function (e) { return this === e || !!e && (this.width === e.width && this.height === e.height) }, e.prototype.intersect = function (t) { if (!t) return this; var n = Math.min(this.height, t.height); return new e(Math.min(this.width, t.width), n) }, e.prototype.getHalfSize = function () { return new e(this.width >>> 1, this.height >>> 1) }, e.prototype.toString = function () { return "Size{width=" + this.width + ", height=" + this.height + "}" }, e.prototype.toJSON = function () { return { width: this.width, height: this.height } }, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ACTION = void 0, function (e) { e.LIST_HOSTS = "list-hosts", e.APPL_DEVICE_LIST = "appl-device-list", e.GOOG_DEVICE_LIST = "goog-device-list", e.MULTIPLEX = "multiplex", e.SHELL = "shell", e.PROXY_WS = "proxy-ws", e.PROXY_ADB = "proxy-adb", e.DEVTOOLS = "devtools", e.STREAM_SCRCPY = "stream", e.STREAM_WS_QVH = "stream-qvh", e.PROXY_WDA = "proxy-wda", e.FILE_LISTING = "list-files" }(t.ACTION || (t.ACTION = {})) }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), i = r.__importDefault(n(9)), o = r.__importDefault(n(3)), a = r.__importDefault(n(1)), s = function () { function t(e, n) { void 0 === n && (n = t.BASE_BUFFER_LENGTH), this.bytesLength = n, this.crop = null, this.bitrate = 0, this.bounds = null, this.maxFps = 0, this.iFrameInterval = 0, this.sendFrameMeta = !1, this.lockedVideoOrientation = -1, this.displayId = 0, e && (this.crop = e.crop, this.bitrate = e.bitrate, this.bounds = e.bounds, this.maxFps = e.maxFps, this.iFrameInterval = e.iFrameInterval, this.sendFrameMeta = e.sendFrameMeta || !1, this.lockedVideoOrientation = e.lockedVideoOrientation || -1, "number" == typeof e.displayId && !isNaN(e.displayId) && e.displayId >= 0 && (this.displayId = e.displayId), e.codecOptions && (this.codecOptions = e.codecOptions.trim()), e.encoderName && (this.encoderName = e.encoderName.trim())) } return t.fromBuffer = function (e) { var n = 0, r = e.readInt32BE(n); n += 4; var s = e.readInt32BE(n); n += 4; var u = e.readInt8(n); n += 1; var c = e.readInt16BE(n); n += 2; var l = e.readInt16BE(n); n += 2; var d = e.readInt16BE(n); n += 2; var f = e.readInt16BE(n); n += 2; var h = e.readInt16BE(n); n += 2; var p = e.readInt16BE(n); n += 2; var E = !!e.readInt8(n); n += 1; var v = e.readInt8(n); n += 1; var m = e.readInt32BE(n); n += 4; var y, _, g = null, S = null; 0 !== c && 0 !== l && (g = new o.default(c, l)), (d || f || h || p) && (S = new i.default(d, f, h, p)); var C = e.readInt32BE(n); if (n += 4, C) { var O = e.slice(n, n + C); n += C, y = a.default.utf8ByteArrayToString(O) } var T = e.readInt32BE(n); if (n += 4, T) { var D = e.slice(n, n + T); n += T, _ = a.default.utf8ByteArrayToString(D) } return new t({ crop: S, bitrate: r, bounds: g, maxFps: s, iFrameInterval: u, lockedVideoOrientation: v, displayId: m, sendFrameMeta: E, codecOptions: y, encoderName: _ }, n) }, t.copy = function (e) { return new t({ bitrate: e.bitrate, crop: i.default.copy(e.crop), bounds: o.default.copy(e.bounds), maxFps: e.maxFps, iFrameInterval: e.iFrameInterval, lockedVideoOrientation: e.lockedVideoOrientation, displayId: e.displayId, sendFrameMeta: e.sendFrameMeta, codecOptions: e.codecOptions, encoderName: e.encoderName }, e.bytesLength) }, t.prototype.equals = function (e) { return !!e && (this.encoderName === e.encoderName && this.codecOptions === e.codecOptions && i.default.equals(this.crop, e.crop) && this.lockedVideoOrientation === e.lockedVideoOrientation && this.displayId === e.displayId && o.default.equals(this.bounds, e.bounds) && this.bitrate === e.bitrate && this.maxFps === e.maxFps && this.iFrameInterval === e.iFrameInterval) }, t.prototype.toBuffer = function () { var n, r, i = 0; this.codecOptions && (i += (n = a.default.stringToUtf8ByteArray(this.codecOptions)).length), this.encoderName && (i += (r = a.default.stringToUtf8ByteArray(this.encoderName)).length); var o = new e(t.BASE_BUFFER_LENGTH + i), s = this.bounds || {}, u = s.width, c = void 0 === u ? 0 : u, l = s.height, d = void 0 === l ? 0 : l, f = this.crop || {}, h = f.left, p = void 0 === h ? 0 : h, E = f.top, v = void 0 === E ? 0 : E, m = f.right, y = void 0 === m ? 0 : m, _ = f.bottom, g = void 0 === _ ? 0 : _, S = 0; return S = o.writeInt32BE(this.bitrate, S), S = o.writeInt32BE(this.maxFps, S), S = o.writeInt8(this.iFrameInterval, S), S = o.writeInt16BE(c, S), S = o.writeInt16BE(d, S), S = o.writeInt16BE(p, S), S = o.writeInt16BE(v, S), S = o.writeInt16BE(y, S), S = o.writeInt16BE(g, S), S = o.writeInt8(this.sendFrameMeta ? 1 : 0, S), S = o.writeInt8(this.lockedVideoOrientation, S), S = o.writeInt32BE(this.displayId, S), n ? (S = o.writeInt32BE(n.length, S), o.fill(n, S), S += n.length) : S = o.writeInt32BE(0, S), r ? (S = o.writeInt32BE(r.length, S), o.fill(r, S), S += r.length) : o.writeInt32BE(0, S), o }, t.prototype.toString = function () { return "VideoSettings{bitrate=" + this.bitrate + ", maxFps=" + this.maxFps + ", iFrameInterval=" + this.iFrameInterval + ", bounds=" + this.bounds + ", crop=" + this.crop + ", metaFrame=" + this.sendFrameMeta + ", lockedVideoOrientation=" + this.lockedVideoOrientation + ", displayId=" + this.displayId + ", codecOptions=" + this.codecOptions + ", encoderName=" + this.encoderName + "}" }, t.prototype.toJSON = function () { return { bitrate: this.bitrate, maxFps: this.maxFps, iFrameInterval: this.iFrameInterval, bounds: this.bounds, crop: this.crop, sendFrameMeta: this.sendFrameMeta, lockedVideoOrientation: this.lockedVideoOrientation, displayId: this.displayId, codecOptions: this.codecOptions, encoderName: this.encoderName } }, t.BASE_BUFFER_LENGTH = 35, t }(); t.default = s }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Icon = void 0; var r, i = n(0), o = i.__importDefault(n(62)), a = i.__importDefault(n(63)), s = i.__importDefault(n(64)), u = i.__importDefault(n(65)), c = i.__importDefault(n(66)), l = i.__importDefault(n(67)), d = i.__importDefault(n(68)), f = i.__importDefault(n(69)), h = i.__importDefault(n(70)), p = i.__importDefault(n(71)), E = i.__importDefault(n(72)), v = i.__importDefault(n(73)), m = i.__importDefault(n(74)), y = i.__importDefault(n(75)), _ = i.__importDefault(n(76)), g = i.__importDefault(n(77)), S = i.__importDefault(n(78)); !function (e) { e[e.BACK = 0] = "BACK", e[e.HOME = 1] = "HOME", e[e.OVERVIEW = 2] = "OVERVIEW", e[e.POWER = 3] = "POWER", e[e.VOLUME_UP = 4] = "VOLUME_UP", e[e.VOLUME_DOWN = 5] = "VOLUME_DOWN", e[e.MORE = 6] = "MORE", e[e.CAMERA = 7] = "CAMERA", e[e.KEYBOARD = 8] = "KEYBOARD", e[e.CANCEL = 9] = "CANCEL", e[e.OFFLINE = 10] = "OFFLINE", e[e.REFRESH = 11] = "REFRESH", e[e.SETTINGS = 12] = "SETTINGS", e[e.MENU = 13] = "MENU", e[e.ARROW_BACK = 14] = "ARROW_BACK", e[e.TOGGLE_ON = 15] = "TOGGLE_ON", e[e.TOGGLE_OFF = 16] = "TOGGLE_OFF" }(r = t.Icon || (t.Icon = {})); var C = function () { function e() { } return e.getSvgString = function (e) { switch (e) { case r.KEYBOARD: return o.default; case r.MORE: return a.default; case r.CAMERA: return s.default; case r.POWER: return u.default; case r.VOLUME_DOWN: return c.default; case r.VOLUME_UP: return l.default; case r.BACK: return d.default; case r.HOME: return f.default; case r.OVERVIEW: return h.default; case r.CANCEL: return p.default; case r.OFFLINE: return E.default; case r.REFRESH: return v.default; case r.SETTINGS: return m.default; case r.MENU: return y.default; case r.ARROW_BACK: return _.default; case r.TOGGLE_ON: return g.default; case r.TOGGLE_OFF: return S.default; default: return "" } }, e.create = function (e) { var t = document.createElement("div"); t.innerHTML = this.getSvgString(e); for (var n = t.children[0], r = n.getElementsByTagName("title"), i = 0, o = r.length; i < o; i++)n.removeChild(r[i]); return n }, e.Icon = r, e }(); t.default = C }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.BaseClient = void 0; var r = n(0), i = n(8), o = r.__importDefault(n(1)), a = function (e) { function t(t) { var n = e.call(this) || this; return n.title = "BaseClient", n.params = n.parseParameters(t), n } return r.__extends(t, e), t.prototype.parseParameters = function (e) { return void 0 === e.action ? { action: "stream", useProxy: o.default.parseBooleanEnv(e.useProxy), secure: o.default.parseBooleanEnv(e.secure), hostname: o.default.parseStringEnv(e.hostname), port: o.default.parseIntEnv(e.port) } : { action: o.default.parseStringEnv(e.action), useProxy: o.default.parseBooleanEnv(e.useProxy), secure: o.default.parseBooleanEnv(e.secure), hostname: o.default.parseStringEnv(e.hostname), port: o.default.parseIntEnv(e.port) } }, t.prototype.setTitle = function (e) { void 0 === e && (e = this.title); var t = document.querySelector("head > title"); t || (t = document.createElement("title")), t.innerText = e }, t.prototype.setBodyClass = function (e) { document.body.className = e }, t }(i.TypedEmitter); t.BaseClient = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.TypedEmitter = void 0; var r = n(49), i = function () { function e() { this.emitter = new r.EventEmitter } return e.prototype.addEventListener = function (e, t) { this.emitter.on(e, t) }, e.prototype.removeEventListener = function (e, t) { this.emitter.off(e, t) }, e.prototype.dispatchEvent = function (e) { return this.emitter.emit(e.type, e) }, e.prototype.on = function (e, t) { this.emitter.on(e, t) }, e.prototype.once = function (e, t) { this.emitter.once(e, t) }, e.prototype.off = function (e, t) { this.emitter.off(e, t) }, e.prototype.emit = function (e, t) { return this.emitter.emit(e, t) }, e }(); t.TypedEmitter = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t, n, r) { this.left = e, this.top = t, this.right = n, this.bottom = r, this.left = e, this.top = t, this.right = n, this.bottom = r } return e.equals = function (e, t) { return !e && !t || !!e && !!t && e.equals(t) }, e.copy = function (t) { return t ? new e(t.left, t.top, t.right, t.bottom) : null }, e.prototype.equals = function (e) { return this === e || !!e && (this.left === e.left && this.top === e.top && this.right === e.right && this.bottom === e.bottom) }, e.prototype.getWidth = function () { return this.right - this.left }, e.prototype.getHeight = function () { return this.bottom - this.top }, e.prototype.toString = function () { return "Rect{left=" + this.left + ", top=" + this.top + ", right=" + this.right + ", bottom=" + this.bottom + "}" }, e.prototype.toJSON = function () { return { left: this.left, right: this.right, top: this.top, bottom: this.bottom } }, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ControlMessage = void 0; var r = function () { function e(e) { this.type = e } return e.prototype.toBuffer = function () { throw Error("Not implemented") }, e.prototype.toString = function () { return "ControlMessage" }, e.prototype.toJSON = function () { return { type: this.type } }, e.TYPE_KEYCODE = 0, e.TYPE_TEXT = 1, e.TYPE_TOUCH = 2, e.TYPE_SCROLL = 3, e.TYPE_BACK_OR_SCREEN_ON = 4, e.TYPE_EXPAND_NOTIFICATION_PANEL = 5, e.TYPE_EXPAND_SETTINGS_PANEL = 6, e.TYPE_COLLAPSE_PANELS = 7, e.TYPE_GET_CLIPBOARD = 8, e.TYPE_SET_CLIPBOARD = 9, e.TYPE_SET_SCREEN_POWER_MODE = 10, e.TYPE_ROTATE_DEVICE = 11, e.TYPE_CHANGE_STREAM_PARAMETERS = 101, e.TYPE_PUSH_FILE = 102, e }(); t.ControlMessage = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.BasePlayer = void 0; var r = n(0), i = r.__importDefault(n(5)), o = r.__importDefault(n(9)), a = r.__importDefault(n(3)), s = r.__importDefault(n(1)), u = n(8), c = n(18), l = function (e) { function t(n, r, i, o, a) { void 0 === i && (i = "BasePlayer"), void 0 === o && (o = "Dummy"), void 0 === a && (a = document.createElement("div")); var s = e.call(this) || this; s.udid = n, s.displayInfo = r, s.name = i, s.storageKeyPrefix = o, s.tag = a, s.inputBytes = [], s.bounds = null, s.totalStats = { decodedFrames: 0, droppedFrames: 0, inputFrames: 0, inputBytes: 0, timestamp: 0 }, s.totalStatsCounter = 0, s.dirtyStatsWidth = 0, s.state = t.STATE.STOPPED, s.showQualityStats = t.DEFAULT_SHOW_QUALITY_STATS, s.receivedFirstFrame = !1, s.statLines = [], s.supportsScreenshot = !1, s.updateQualityStats = function () { var e = Date.now(), n = e - 1e3; s.calculateMomentumStats(), s.momentumQualityStats && (s.totalStats.timestamp < n && (s.totalStats = { timestamp: e, decodedFrames: s.totalStats.decodedFrames + s.momentumQualityStats.decodedFrames, droppedFrames: s.totalStats.droppedFrames + s.momentumQualityStats.droppedFrames, inputFrames: s.totalStats.inputFrames + s.momentumQualityStats.inputFrames, inputBytes: s.totalStats.inputBytes + s.momentumQualityStats.inputBytes }, 0 !== s.totalStatsCounter && (s.perSecondQualityStats = { avgDecoded: s.totalStats.decodedFrames / s.totalStatsCounter, avgDropped: s.totalStats.droppedFrames / s.totalStatsCounter, avgInput: s.totalStats.inputFrames / s.totalStatsCounter, avgSize: s.totalStats.inputBytes / s.totalStatsCounter }), s.totalStatsCounter++), s.drawStats(), s.state !== t.STATE.STOPPED && (s.qualityAnimationId = requestAnimationFrame(s.updateQualityStats))) }, s.touchableCanvas = document.createElement("canvas"), s.touchableCanvas.className = "touch-layer", s.touchableCanvas.oncontextmenu = function (e) { e.preventDefault() }; var u = s.getPreferredVideoSetting(); return s.videoSettings = t.getVideoSettingFromStorage(u, s.storageKeyPrefix, n, r), s } return r.__extends(t, e), t.isIFrame = function (e) { return e && e.length > 4 && 5 == (31 & e[4]) }, t.getStorageKey = function (e, t) { var n = window.innerHeight; return e + ":" + t + ":" + window.innerWidth + "x" + n }, t.getFullStorageKey = function (e, t, n) { var r = window.innerHeight, i = e + ":" + t + ":" + window.innerWidth + "x" + r; if (n) { var o = n.displayId, a = n.size; i = i + ":" + o + ":" + a.width + "x" + a.height } return i }, t.getFromStorageCompat = function (e, t, n) { var r = this.getStorageKey(e, t), i = window.localStorage.getItem(r); if (!n) return i; var o = n.displayId === c.DisplayInfo.DEFAULT_DISPLAY, a = this.getFullStorageKey(e, t, n), s = window.localStorage.getItem(a); return s ? (i && o && window.localStorage.removeItem(r), s) : o ? i : null }, t.getFitToScreenFromStorage = function (e, t, n) { if (!window.localStorage) return !1; var r = !1, i = this.getFullStorageKey(e, t, n) + ":fit", o = window.localStorage.getItem(i); if (!o) return !1; try { r = JSON.parse(o) } catch (e) { console.error("[" + this.name + "]", "Failed to parse", o) } return r }, t.getVideoSettingFromStorage = function (e, t, n, r) { if (!window.localStorage) return e; var s = this.getFromStorageCompat(t, n, r); if (!s) return e; var u = JSON.parse(s), c = u.displayId, l = u.crop, d = u.bitrate, f = u.iFrameInterval, h = u.sendFrameMeta, p = u.lockedVideoOrientation, E = u.codecOptions, v = u.encoderName, m = isNaN(u.maxFps) ? u.frameRate : u.maxFps, y = null; return "object" != typeof u.bounds || isNaN(u.bounds.width) || isNaN(u.bounds.height) ? isNaN(u.maxSize) || (y = new a.default(u.maxSize, u.maxSize)) : y = new a.default(u.bounds.width, u.bounds.height), new i.default({ displayId: "number" == typeof c ? c : 0, crop: l ? new o.default(l.left, l.top, l.right, l.bottom) : e.crop, bitrate: isNaN(d) ? e.bitrate : d, bounds: null !== y ? y : e.bounds, maxFps: isNaN(m) ? e.maxFps : m, iFrameInterval: isNaN(f) ? e.iFrameInterval : f, sendFrameMeta: "boolean" == typeof h ? h : e.sendFrameMeta, lockedVideoOrientation: isNaN(p) ? e.lockedVideoOrientation : p, codecOptions: E, encoderName: v }) }, t.putVideoSettingsToStorage = function (e, t, n, r, i) { if (window.localStorage) { var o = this.getFullStorageKey(e, t, i); window.localStorage.setItem(o, JSON.stringify(n)); var a = o + ":fit"; window.localStorage.setItem(a, JSON.stringify(r)) } }, t.prototype.createScreenshot = function (e) { var t = document.createElement("a"); t.href = this.getImageDataURL(), t.download = e + " " + (new Date).toLocaleString() + ".png", t.click() }, t.prototype.play = function () { this.needScreenInfoBeforePlay() && !this.screenInfo || (this.state = t.STATE.PLAYING) }, t.prototype.pause = function () { this.state = t.STATE.PAUSED }, t.prototype.stop = function () { this.state = t.STATE.STOPPED }, t.prototype.getState = function () { return this.state }, t.prototype.pushFrame = function (e) { this.receivedFirstFrame || (this.receivedFirstFrame = !0, "number" != typeof this.qualityAnimationId && (this.qualityAnimationId = requestAnimationFrame(this.updateQualityStats))), this.inputBytes.push({ timestamp: Date.now(), bytes: e.byteLength }) }, t.prototype.getTouchableElement = function () { return this.touchableCanvas }, t.prototype.setParent = function (e) { this.parentElement = e, e.appendChild(this.tag), e.appendChild(this.touchableCanvas) }, t.prototype.needScreenInfoBeforePlay = function () { return !0 }, t.prototype.getVideoSettings = function () { return this.videoSettings }, t.prototype.setVideoSettings = function (e, n, r) { this.videoSettings = e, r && t.putVideoSettingsToStorage(this.storageKeyPrefix, this.udid, e, n, this.displayInfo), this.resetStats(), this.emit("video-settings", i.default.copy(e)) }, t.prototype.getScreenInfo = function () { return this.screenInfo }, t.prototype.setScreenInfo = function (e) { this.needScreenInfoBeforePlay() && this.pause(), this.receivedFirstFrame = !1, this.screenInfo = e; var t = e.videoSize, n = t.width, r = t.height; this.touchableCanvas.width = n, this.touchableCanvas.height = r, this.parentElement && (this.parentElement.style.height = r + "px", this.parentElement.style.width = n + "px"); var i = new a.default(n, r); this.emit("video-view-resize", i) }, t.prototype.getName = function () { return this.name }, t.prototype.resetStats = function () { this.receivedFirstFrame = !1, this.totalStatsCounter = 0, this.totalStats = { droppedFrames: 0, decodedFrames: 0, inputFrames: 0, inputBytes: 0, timestamp: 0 }, this.perSecondQualityStats = { avgDecoded: 0, avgDropped: 0, avgInput: 0, avgSize: 0 } }, t.prototype.drawStats = function () { if (this.showQualityStats && this.touchableCanvas.getContext("2d")) { var e = []; if (this.perSecondQualityStats && this.momentumQualityStats) { var t = this.momentumQualityStats, n = t.decodedFrames, r = t.droppedFrames, i = t.inputBytes, o = t.inputFrames, a = this.perSecondQualityStats, u = a.avgDecoded, c = a.avgDropped, l = a.avgSize, d = a.avgInput, f = o.toString().padStart(3, " "), h = n.toString().padStart(3, " "), p = r.toString().padStart(3, " "), E = u.toFixed(1).padStart(5, " "), v = c.toFixed(1).padStart(5, " "), m = d.toFixed(1).padStart(5, " "), y = s.default.prettyBytes(i).padStart(8, " "), _ = s.default.prettyBytes(l).padStart(8, " "); e.push("Input bytes: " + y + " (avg: " + _ + "/s)"), e.push("Input   FPS: " + f + " (avg: " + m + ")"), e.push("Dropped FPS: " + p + " (avg: " + v + ")"), e.push("Decoded FPS: " + h + " (avg: " + E + ")") } else e.push("Not supported"); for (var g = this.statLines.length !== e.length, S = 0; !g && S++ < e.length;)e[S] !== this.statLines[S] && (g = !0); g && (this.statLines = e, this.updateCanvas(!1)) } }, t.prototype.updateCanvas = function (e) { var n = this, r = this.touchableCanvas.getContext("2d"); if (r) { var i = this.touchableCanvas.height, o = t.STATS_HEIGHT, a = this.statLines.length, s = o / 2, u = 2 * s, c = o * a + s * (a + 1); r.clearRect(0, i - c, this.dirtyStatsWidth + u, c), this.dirtyStatsWidth = 0, e || (r.save(), r.font = o + "px monospace", this.statLines.forEach((function (e) { var t = r.measureText(e), i = Math.abs(t.actualBoundingBoxLeft) + Math.abs(t.actualBoundingBoxRight); n.dirtyStatsWidth = Math.max(i, n.dirtyStatsWidth) })), r.fillStyle = t.STAT_BACKGROUND, r.fillRect(0, i - c, this.dirtyStatsWidth + u, c), r.fillStyle = t.STAT_TEXT_COLOR, this.statLines.forEach((function (e, t) { r.fillText(e, s, i - s - t * (o + s)) })), r.restore()) } }, t.prototype.setShowQualityStats = function (e) { this.showQualityStats = e, e ? this.drawStats() : this.updateCanvas(!0) }, t.prototype.getShowQualityStats = function () { return this.showQualityStats }, t.prototype.setBounds = function (e) { this.bounds = a.default.copy(e) }, t.prototype.getDisplayInfo = function () { return this.displayInfo }, t.prototype.setDisplayInfo = function (e) { this.displayInfo = e }, t.loadVideoSettings = function (e, t) { return this.getVideoSettingFromStorage(this.preferredVideoSettings, this.storageKeyPrefix, e, t) }, t.getFitToScreenStatus = function (e, t) { return this.getFitToScreenFromStorage(this.storageKeyPrefix, e, t) }, t.getPreferredVideoSetting = function () { return this.preferredVideoSettings }, t.saveVideoSettings = function (e, t, n, r) { this.putVideoSettingsToStorage(this.storageKeyPrefix, e, t, n, r) }, t.STAT_BACKGROUND = "rgba(0, 0, 0, 0.5)", t.STAT_TEXT_COLOR = "hsl(24, 85%, 50%)", t.DEFAULT_SHOW_QUALITY_STATS = !1, t.STATE = { PLAYING: 1, PAUSED: 2, STOPPED: 3 }, t.STATS_HEIGHT = 12, t.storageKeyPrefix = "BaseDecoder", t.playerFullName = "BasePlayer", t.playerCodeName = "baseplayer", t.preferredVideoSettings = new i.default({ lockedVideoOrientation: -1, bitrate: 524288, maxFps: 24, iFrameInterval: 5, bounds: new a.default(480, 480), sendFrameMeta: !1 }), t }(u.TypedEmitter); t.BasePlayer = l }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.ManagerClient = void 0; var r = n(0), i = n(7), o = n(4), a = r.__importDefault(n(1)), s = n(79), u = function (t) { function n(e) { var n = t.call(this, e) || this; return n.destroyed = !1, n.action = a.default.parseStringEnv(e.action), n.url = n.buildWebSocketUrl(), n } return r.__extends(n, t), n.start = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; throw Error("Not implemented") }, n.prototype.hasConnection = function () { return !(!this.ws || this.ws.readyState !== this.ws.OPEN) }, n.prototype.openNewConnection = function () { this.ws && this.ws.readyState === this.ws.OPEN && (this.ws.close(), delete this.ws); var e = this.url.toString(); if (e = e.includes("8003") ? e.slice(0, e.indexOf("://")) + "://localhost:8000" + e.slice(e.indexOf("8003") + 4) : e, this.supportMultiplexing()) { var t = n.sockets.get(e); if (!t) { var r = new WebSocket(e); r.addEventListener("close", (function () { n.sockets.delete(e) })); var i = s.Multiplexer.wrap(r); i.on("empty", (function () { i.close() })), n.sockets.set(e, i), t = i } (o = t.createChannel(this.getChannelInitData())).addEventListener("open", this.onSocketOpen.bind(this)), o.addEventListener("message", this.onSocketMessage.bind(this)), o.addEventListener("close", this.onSocketClose.bind(this)), this.ws = o } else { var o; (o = new WebSocket(e)).addEventListener("open", this.onSocketOpen.bind(this)), o.addEventListener("message", this.onSocketMessage.bind(this)), o.addEventListener("close", this.onSocketClose.bind(this)), this.ws = o } return this.ws }, n.prototype.destroy = function () { this.destroyed ? console.error(new Error("Already disposed")) : (this.destroyed = !0, this.ws && this.ws.readyState === this.ws.OPEN && this.ws.close()) }, n.prototype.buildWebSocketUrl = function () { var e = this.buildDirectWebSocketUrl(); return this.params.useProxy && !this.supportMultiplexing() ? this.wrapInProxy(e) : e }, n.prototype.buildDirectWebSocketUrl = function () { var e, t = this.params, n = t.hostname, r = t.port, i = t.secure, a = t.action; "string" == typeof n && "number" == typeof r ? e = (i ? "wss:" : "ws:") + "//" + n + ":" + r : e = "" + ("https:" === location.protocol ? "wss:" : "ws:") + location.host; var s = new URL(e); return this.supportMultiplexing() ? s.searchParams.set("action", o.ACTION.MULTIPLEX) : a && s.searchParams.set("action", a), s }, n.prototype.wrapInProxy = function (e) { var t = "https:" === location.protocol ? "wss:" : "ws:", n = new URL(t + "//" + location.host); return n.searchParams.set("action", o.ACTION.PROXY_WS), n.searchParams.set("ws", e.toString()), n }, n.prototype.supportMultiplexing = function () { return !1 }, n.prototype.getChannelInitData = function () { return e.from(n.CODE) }, n.ACTION = "unknown", n.CODE = "NONE", n.sockets = new Map, n }(i.BaseClient); t.ManagerClient = u }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.EventClass = t.Event2 = void 0; var r = n(0), i = function () { function e(e, t) { void 0 === t && (t = { cancelable: !0, bubbles: !0, composed: !1 }), this.isTrusted = !0, this.AT_TARGET = 0, this.BUBBLING_PHASE = 0, this.CAPTURING_PHASE = 0, this.NONE = 0; var n = r.__assign({}, t), i = n.cancelable, o = n.bubbles, a = n.composed; this.cancelable = !!i, this.bubbles = !!o, this.composed = !!a, this.type = "" + e, this.defaultPrevented = !1, this.timeStamp = Date.now(), this.target = null } return e.prototype.stopImmediatePropagation = function () { }, e.prototype.preventDefault = function () { this.defaultPrevented = !0 }, Object.defineProperty(e.prototype, "currentTarget", { get: function () { return this.target }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "srcElement", { get: function () { return this.target }, enumerable: !1, configurable: !0 }), e.prototype.composedPath = function () { return this.target ? [this.target] : [] }, Object.defineProperty(e.prototype, "returnValue", { get: function () { return !this.defaultPrevented }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "eventPhase", { get: function () { return this.target ? Event.AT_TARGET : Event.NONE }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "cancelBubble", { get: function () { return !1 }, set: function (e) { e && this.stopPropagation() }, enumerable: !1, configurable: !0 }), e.prototype.stopPropagation = function () { }, e.prototype.initEvent = function (e, t, n) { this.type = e, arguments.length > 1 && (this.bubbles = !!t), arguments.length > 2 && (this.cancelable = !!n) }, e.NONE = 0, e.CAPTURING_PHASE = 1, e.AT_TARGET = 2, e.BUBBLING_PHASE = 3, e }(); t.Event2 = i, t.EventClass = "undefined" != typeof Event ? Event : i }, function (e, t, n) { "use strict"; function r(e) { if (e instanceof HTMLTemplateElement) return e.innerHTML; if (void 0 === e) return "undefined"; if (null === e) return "null"; var t = document.createElement("dummy"); return t.innerText = e.toString(), t.innerHTML } Object.defineProperty(t, "__esModule", { value: !0 }), t.html = void 0, t.html = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var i = document.createElement("template"); return i.innerHTML = t.reduce((function (t, n, i) { return t + r(n) + e[i + 1] }), e[0]).toString(), i } }, function (e, t, n) { "use strict"; var r, i; Object.defineProperty(t, "__esModule", { value: !0 }), t.setLogger = function (e, t) { r = e, i = null != t ? t : e }, t.isEnable = function () { return null != r }, t.log = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; r && r.apply(void 0, [e].concat(t)) }, t.error = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; i && i.apply(void 0, [e].concat(t)) } }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.StreamClientScrcpy = void 0; var r, i = n(0), o = n(7), a = i.__importDefault(n(5)), s = i.__importDefault(n(3)), u = n(26), c = i.__importDefault(n(1)), l = i.__importDefault(n(27)), d = i.__importDefault(n(55)), f = n(56), h = n(11), p = n(60), E = n(39), v = n(21), m = n(14), y = n(87), _ = n(19), g = n(43), S = n(4), C = n(32), O = n(110), T = function (e) { function t(n, r, i, o, s) { var c = e.call(this, n) || this; c.deviceName = "", c.clientId = -1, c.clientsCount = -1, c.joinedStream = !1, c.OnDeviceMessage = function (e) { c.droidMoreBox && c.droidMoreBox.OnDeviceMessage(e) }, c.onVideo = function (e) { if (c.player) { var t = h.BasePlayer.STATE; c.player.getState() === t.PAUSED && c.player.play(), c.player.getState() === t.PLAYING && c.player.pushFrame(new Uint8Array(e)) } }, c.onClientsStats = function (e) { c.deviceName = e.deviceName, c.clientId = e.clientId, c.setTitle("Stream " + c.deviceName) }, c.onDisplayInfo = function (e) { var n; if (c.player) { var r = c.player.getVideoSettings(), i = r.displayId, o = e.find((function (e) { return e.displayInfo.displayId === i })); if (o) { c.player.getState() === h.BasePlayer.STATE.PAUSED && c.player.play(); var s = o.videoSettings, l = o.screenInfo; if (c.player.setDisplayInfo(o.displayInfo), "boolean" != typeof c.fitToScreen && (c.fitToScreen = c.player.getFitToScreenStatus()), c.fitToScreen) { var d = c.getMaxSize(); d && (r = t.createVideoSettingsWithBounds(r, d), c.player.setVideoSettings(r, c.fitToScreen, !1)) } if (!s || !l) return c.joinedStream = !0, void c.sendMessage(u.CommandControlMessage.createSetVideoSettingsCommand(r)); c.clientsCount = o.connectionCount; var f = a.default.copy(s), p = c.player.getScreenInfo(); if (l.equals(p) || c.player.setScreenInfo(l), s.equals(r) || c.applyNewVideoSettings(s, s.equals(c.requestedVideoSettings)), !p) { var E = r.bounds, v = l.videoSize, m = 0 === c.clientsCount, y = E && (E.width < v.width || E.height < v.height); (m || y) && (f = r); var _ = null === (n = r.bounds) || void 0 === n ? void 0 : n.intersect(f.bounds); _ && !_.equals(f.bounds) && (f = t.createVideoSettingsWithBounds(f, _)) } f.equals(s) && c.joinedStream || (c.joinedStream = !0, c.sendMessage(u.CommandControlMessage.createSetVideoSettingsCommand(f))) } } }, c.onDisconnected = function () { var e, t; c.streamReceiver.off("deviceMessage", c.OnDeviceMessage), c.streamReceiver.off("video", c.onVideo), c.streamReceiver.off("clientsStats", c.onClientsStats), c.streamReceiver.off("displayInfo", c.onDisplayInfo), c.streamReceiver.off("disconnected", c.onDisconnected), document.getElementsByClassName("video")[0].innerHTML = "", null === (e = c.filePushHandler) || void 0 === e || e.release(), c.filePushHandler = void 0, null === (t = c.touchHandler) || void 0 === t || t.release(), c.touchHandler = void 0 }, c.streamReceiver = r || new C.StreamReceiverScrcpy(c.params); var l = c.params, d = l.udid, f = l.player; return c.startStream({ udid: d, player: i, playerName: f, fitToScreen: o, videoSettings: s }), c.setBodyClass("stream"), c } return i.__extends(t, e), t.registerPlayer = function (e) { e.isSupported() && this.players.set(e.playerFullName, e) }, t.getPlayers = function () { return Array.from(this.players.values()) }, t.getPlayerClass = function (e) { var n, r, o; try { for (var a = i.__values(t.players.values()), s = a.next(); !s.done; s = a.next()) { var u = s.value; u.playerFullName !== e && u.playerCodeName !== e || (o = u) } } catch (e) { n = { error: e } } finally { try { s && !s.done && (r = a.return) && r.call(a) } finally { if (n) throw n.error } } return o }, t.createPlayer = function (e, t, n) { var r = this.getPlayerClass(e); if (r) return new r(t, n) }, t.getFitToScreen = function (e, t, n) { var r = this.getPlayerClass(e); return !!r && r.getFitToScreenStatus(t, n) }, t.start = function (e, n, r, i, o) { return new t(e, n, r, i, o) }, t.createVideoSettingsWithBounds = function (e, t) { return new a.default({ crop: e.crop, bitrate: e.bitrate, bounds: t, maxFps: e.maxFps, iFrameInterval: e.iFrameInterval, sendFrameMeta: e.sendFrameMeta, lockedVideoOrientation: e.lockedVideoOrientation, displayId: e.displayId, codecOptions: e.codecOptions, encoderName: e.encoderName }) }, t.prototype.parseParameters = function (t) { var n = e.prototype.parseParameters.call(this, t), r = n.action; if (r !== S.ACTION.STREAM_SCRCPY) throw Error("Incorrect action"); return i.__assign(i.__assign({}, n), { action: r, player: c.default.parseStringEnv(t.player), udid: c.default.parseStringEnv(t.udid), ws: c.default.parseStringEnv(t.ws) }) }, t.prototype.startStream = function (e) { var n = e.udid, r = e.player, i = e.playerName, o = e.videoSettings, a = e.fitToScreen; if (!n) throw Error('Invalid udid value: "' + n + '"'); if (this.fitToScreen = a, !r) { if ("string" != typeof i) throw Error("Must provide BasePlayer instance or playerName"); var s = void 0; this.streamReceiver && o && (s = this.streamReceiver.getDisplayInfo(o.displayId)); var u = t.createPlayer(i, n, s); if (!u) throw Error('Unsupported player: "' + i + '"'); "boolean" != typeof a && (a = t.getFitToScreen(i, n, s)), r = u } this.player = r, this.setTouchListeners(r), o || (o = r.getVideoSettings()); var c = document.createElement("div"); c.className = "device-view"; var f = document.createElement("div"); f.className = "video", c.appendChild(f), r.setParent(f); var h = document.getElementById("streamtranslation"); if (null !== h ? h.appendChild(c) : document.body.appendChild(c), a) { var p = this.getMaxSize(); p && (o = t.createVideoSettingsWithBounds(o, p)) } this.applyNewVideoSettings(o, !1); var E = r.getTouchableElement(), v = new d.default(E); this.filePushHandler = new l.default(E, new O.ScrcpyFilePushStream(this.streamReceiver)), this.filePushHandler.addEventListener(v); var m = this.streamReceiver; m.on("deviceMessage", this.OnDeviceMessage), m.on("video", this.onVideo), m.on("clientsStats", this.onClientsStats), m.on("displayInfo", this.onDisplayInfo), m.on("disconnected", this.onDisconnected), console.log("[StreamClientScrcpy]", r.getName(), n) }, t.prototype.sendMessage = function (e) { this.streamReceiver.sendEvent(e) }, t.prototype.getDeviceName = function () { return this.deviceName }, t.prototype.setHandleKeyboardEvents = function (e) { e ? f.KeyInputHandler.addEventListener(this) : f.KeyInputHandler.removeEventListener(this) }, t.prototype.onKeyEvent = function (e) { this.sendMessage(e) }, t.prototype.sendNewVideoSetting = function (e) { this.requestedVideoSettings = e, this.sendMessage(u.CommandControlMessage.createSetVideoSettingsCommand(e)) }, t.prototype.getClientId = function () { return this.clientId }, t.prototype.getClientsCount = function () { return this.clientsCount }, t.prototype.getMaxSize = function () { if (this.controlButtons) { var e = document.body, t = e.clientWidth - this.controlButtons.clientWidth & -1; console.log("body.clientWidth  :  " + e.clientWidth + "   this.controlButtons.clientWidth  :  " + this.controlButtons.clientWidth); var n = -1 & e.clientHeight; return console.log(n), new s.default(t, n) } }, t.prototype.setTouchListeners = function (e) { this.touchHandler || (this.touchHandler = new y.FeaturedInteractionHandler(e, this)) }, t.prototype.applyNewVideoSettings = function (e, t) { var n = !1; e.bounds && e.bounds.equals(this.getMaxSize()) && (n = !0), this.player && this.player.setVideoSettings(e, n, t) }, t.createEntryForDeviceList = function (e, t, n, o) { if (-1 !== e.pid) { var a = "configure_" + c.default.escapeUdid(e.udid), s = m.html(r || (r = i.__makeTemplateObject(['<div class="stream ', '">\n                <button\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    id="', '"\n                    class="active action-button"\n                >\n                    Configure stream\n                </button>\n            </div>'], ['<div class="stream ', '">\n                <button\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    ', '="', '"\n                    id="', '"\n                    class="active action-button"\n                >\n                    Configure stream\n                </button>\n            </div>'])), t, _.Attribute.UDID, e.udid, _.Attribute.COMMAND, v.ControlCenterCommand.CONFIGURE_STREAM, _.Attribute.FULL_NAME, n, _.Attribute.SECURE, o.secure, _.Attribute.HOSTNAME, o.hostname, _.Attribute.PORT, o.port, _.Attribute.USE_PROXY, o.useProxy, a), u = s.content.getElementById(a); return u && (u.onclick = this.onConfigureStreamClick), s.content } }, t.ACTION = "stream", t.players = new Map, t.onConfigureStreamClick = function (e) { var n = e.currentTarget, r = c.default.parseStringEnv(n.getAttribute(_.Attribute.UDID) || ""), i = n.getAttribute(_.Attribute.FULL_NAME), o = c.default.parseBooleanEnv(n.getAttribute(_.Attribute.SECURE) || void 0) || !1, a = c.default.parseStringEnv(n.getAttribute(_.Attribute.HOSTNAME) || void 0), s = c.default.parseIntEnv(n.getAttribute(_.Attribute.PORT) || void 0), u = c.default.parseBooleanEnv(n.getAttribute(_.Attribute.USE_PROXY) || void 0); if (!r) throw Error('Invalid udid value: "' + r + '"'); if ("number" != typeof s) throw Error("Invalid port type: " + typeof s); var l = E.DeviceTracker.getInstance({ type: "android", secure: o, hostname: a, port: s, useProxy: u }), d = l.getDescriptorByUdid(r); if (d) { e.preventDefault(); var f = document.getElementsByName("" + E.DeviceTracker.AttributePrefixInterfaceSelectFor + i); if (f && f.length) { var h = f[0], v = h.options[h.selectedIndex], m = v.getAttribute(_.Attribute.URL), y = v.getAttribute(_.Attribute.NAME); if (m && y) { var g = { udid: r, ws: m, player: "", action: S.ACTION.STREAM_SCRCPY, secure: o, hostname: a, port: s, useProxy: u }; new p.ConfigureScrcpy(l, d, g).on("closed", t.onConfigureDialogClosed) } } } }, t.onConfigureDialogClosed = function (e) { e.dialog.off("closed", t.onConfigureDialogClosed), e.result && g.HostTracker.getInstance().destroy() }, t }(o.BaseClient); t.StreamClientScrcpy = T }, function (e, t) { var n; n = function () { return this }(); try { n = n || new Function("return this")() } catch (e) { "object" == typeof window && (n = window) } e.exports = n }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.DisplayInfo = void 0; var r = n(0).__importDefault(n(3)), i = function () { function t(e, t, n, r, i) { this.displayId = e, this.size = t, this.rotation = n, this.layerStack = r, this.flags = i } return t.prototype.toBuffer = function () { var n = new e(t.BUFFER_LENGTH), r = 0; return r = n.writeInt32BE(this.displayId, r), r = n.writeInt32BE(this.size.width, r), r = n.writeInt32BE(this.size.height, r), r = n.writeInt32BE(this.rotation, r), r = n.writeInt32BE(this.layerStack, r), n.writeInt32BE(this.flags, r), n }, t.prototype.toString = function () { return "DisplayInfo{displayId=" + this.displayId + ", size=" + this.size + ", rotation=" + this.rotation + ", layerStack=" + this.layerStack + ", flags=" + this.flags + "}" }, t.fromBuffer = function (e) { if (e.length !== t.BUFFER_LENGTH) throw Error("Incorrect buffer length. Expected: " + t.BUFFER_LENGTH + ", received: " + e.length); var n = 0, i = e.readInt32BE(n); n += 4; var o = e.readInt32BE(n); n += 4; var a = e.readInt32BE(n); n += 4; var s = e.readInt32BE(n); n += 4; var u = e.readInt32BE(n); n += 4; var c = e.readInt32BE(n); return new t(i, new r.default(o, a), s, u, c) }, t.DEFAULT_DISPLAY = 0, t.FLAG_ROUND = 16, t.FLAG_PRESENTATION = 8, t.FLAG_PRIVATE = 4, t.FLAG_SECURE = 2, t.FLAG_SUPPORTS_PROTECTED_BUFFERS = 1, t.INVALID_DISPLAY = -1, t.BUFFER_LENGTH = 24, t }(); t.DisplayInfo = i }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Attribute = void 0, t.Attribute = { COMMAND: "data-command", FULL_NAME: "data-full-name", NAME: "data-name", PID: "data-pid", UDID: "data-udid", URL: "data-url", USE_PROXY: "data-use-proxy", SECURE: "data-secure", HOSTNAME: "data-hostname", PORT: "data-port", VALUE: "data-value" } }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.BaseDeviceTracker = void 0; var r, i = n(0), o = i.__importStar(n(25)), a = n(12), s = n(14), u = "[BaseDeviceTracker]", c = function (t) { function n(e, r) { var i = t.call(this, e) || this; return i.directUrl = r, i.title = "Device list", i.tableId = "base_device_list", i.descriptors = [], i.trackerName = "", i.id = "", i.created = !1, i.messageId = 0, i.elementId = "tracker_instance" + ++n.instanceId, i.trackerName = "Unavailable. Host: " + e.hostname + ", type: " + e.type, i.setBodyClass("list"), i.setTitle(), i } return i.__extends(n, t), n.buildUrl = function (e) { var t = e.secure, n = e.port, r = e.hostname, i = new URL((t ? "wss:" : "ws:") + "//" + r); return n && (i.port = n.toString()), i }, n.buildUrlForTracker = function (e) { var t = this.buildUrl(e); return t.searchParams.set("action", this.ACTION), t }, n.prototype.parseParameters = function (e) { var n = t.prototype.parseParameters.call(this, e), r = e.type; if ("android" !== r && "ios" !== r) throw Error("Incorrect type"); return i.__assign(i.__assign({}, n), { type: r }) }, n.prototype.getNextId = function () { return ++this.messageId }, n.prototype.buildDeviceTable = function () { var e = this, t = this.descriptors, n = this.getOrCreateTableHolder(), r = this.getOrBuildTableBody(n), i = this.getOrCreateTrackerBlock(r, this.trackerName); t.forEach((function (t) { e.buildDeviceRow(i, t) })) }, n.prototype.setNameValue = function (e, t) { if (e) { var n = this.elementId + "_name", r = document.getElementById(n); r || ((r = document.createElement("div")).id = n, r.className = "tracker-name"), r.innerText = t, e.insertBefore(r, e.firstChild) } }, n.prototype.getOrCreateTrackerBlock = function (e, t) { var n = document.getElementById(this.elementId); if (n) for (; n.children.length;)n.removeChild(n.children[0]); else (n = document.createElement("div")).id = this.elementId, e.appendChild(n), this.created = !0; return this.setNameValue(n, t), n }, n.prototype.onSocketClose = function (e) { var t = this; this.destroyed || (console.log(u, "Connection closed: " + e.reason), setTimeout((function () { t.openNewConnection() }), 2e3)) }, n.prototype.onSocketMessage = function (e) { var t; try { t = JSON.parse(e.data) } catch (t) { return console.error(u, t.message), void console.log(u, e.data) } switch (t.type) { case n.ACTION_LIST: var r = t.data; this.descriptors = r.list, this.setIdAndHostName(r.id, r.name), this.buildDeviceTable(); break; case n.ACTION_DEVICE: var i = t.data; this.setIdAndHostName(i.id, i.name), this.updateDescriptor(i.device), this.buildDeviceTable(); break; default: console.log(u, "Unknown message type: " + t.type) } }, n.prototype.setIdAndHostName = function (e, t) { this.id === e && this.trackerName === t || (this.id = e, this.trackerName = t, this.setNameValue(document.getElementById(this.elementId), t)) }, n.prototype.getOrCreateTableHolder = function () { var e = n.HOLDER_ELEMENT_ID, t = document.getElementById(e); return t || ((t = document.createElement("div")).id = e, t.className = "table-wrapper", document.body.appendChild(t)), t }, n.prototype.updateDescriptor = function (e) { var t = this.descriptors.findIndex((function (t) { return t.udid === e.udid })); -1 !== t ? (this.descriptors[t] = e, "device" === this.descriptors[t].state && (n.checkVideoStanding(), setTimeout((function () { return location.reload() }), 3e3))) : (this.descriptors.push(e), this.descriptors.length > 1 && (n.checkVideoStanding(), setTimeout((function () { return location.reload() }), 3e3))) }, n.checkVideoStanding = function () { var e; if (null === (e = document.getElementById("flush-collapseOne")) || void 0 === e ? void 0 : e.classList.contains("show")) { sessionStorage.setItem("itInit", "true"); var t = window.pageYOffset.toString(); sessionStorage.setItem("yOffset", t) } }, n.setVideoStanding = function () { var e; "true" === sessionStorage.getItem("itInit") && (null === (e = document.getElementById("flush-collapseOne")) || void 0 === e || e.classList.add("show"), window.scrollTo(0, Number(sessionStorage.getItem("yOffset"))), sessionStorage.setItem("itInit", "false")) }, n.prototype.getOrBuildTableBody = function (e) { var t = document.querySelector("#" + n.HOLDER_ELEMENT_ID + " #" + this.tableId + ".device-list"); if (!t) { var o = s.html(r || (r = i.__makeTemplateObject(['<div id="', '" class="', '"></div>'], ['<div id="', '" class="', '"></div>'])), this.tableId, "device-list").content; e.appendChild(o); var a = e.children.item(e.children.length - 1); a && (t = a) } return t }, n.buildLink = function (e, t, n) { var r = n.hostname, i = n.port, a = n.secure ? "https:" : "http:"; n.useProxy && (e.hostname = r, e.port = i, e.secure = n.secure, e.useProxy = !0, a = location.protocol, r = location.hostname, i = location.port); var s = "#!" + o.encode(e), u = document.createElement("a"); return u.setAttribute("href", a + "//" + r + ":" + i + "/" + s), u.setAttribute("rel", "noopener noreferrer"), u.setAttribute("target", "_blank"), u.classList.add("link-" + e.action), u.innerText = t, u }, n.prototype.getDescriptorByUdid = function (e) { if (this.descriptors.length) return this.descriptors.find((function (t) { return t.udid === e })) }, n.prototype.destroy = function () { if (t.prototype.destroy.call(this), this.created) { var e = document.getElementById(this.elementId); if (e) { var r = e.parentElement; e.remove(), r && !r.children.length && r.remove() } } var i = document.getElementById(n.HOLDER_ELEMENT_ID); i && !i.children.length && i.remove() }, n.prototype.supportMultiplexing = function () { return !0 }, n.prototype.getChannelCode = function () { throw Error("Not implemented. Must override") }, n.prototype.getChannelInitData = function () { var t = this.getChannelCode(), n = e.alloc(t.length); return n.write(t, "ascii"), n }, n.ACTION_LIST = "devicelist", n.ACTION_DEVICE = "device", n.HOLDER_ELEMENT_ID = "devices", n.AttributePrefixInterfaceSelectFor = "interface_select_for_", n.AttributePlayerFullName = "data-player-full-name", n.AttributePlayerCodeName = "data-player-code-name", n.AttributePrefixPlayerFor = "player_for_", n.instanceId = 0, n }(a.ManagerClient); t.BaseDeviceTracker = c }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ControlCenterCommand = void 0; var r = function () { function e() { this.id = -1, this.type = "", this.pid = 0, this.udid = "", this.method = "" } return e.fromJSON = function (t) { var n = JSON.parse(t); if (!n) throw new Error("Invalid input"); var r = new e, i = r.data = n.data; switch (r.id = n.id, r.type = n.type, "string" == typeof i.udid && (r.udid = i.udid), n.type) { case this.KILL_SERVER: if ("number" != typeof i.pid && i.pid <= 0) throw new Error('Invalid "pid" value'); return r.pid = i.pid, r; case this.REQUEST_WDA: if ("string" != typeof i.method) throw new Error('Invalid "method" value'); return r.method = i.method, r.args = i.args, r; case this.START_SERVER: case this.UPDATE_INTERFACES: case this.CONFIGURE_STREAM: case this.RUN_WDA: return r; default: throw new Error('Unknown command "' + n.command + '"') } }, e.prototype.getType = function () { return this.type }, e.prototype.getPid = function () { return this.pid }, e.prototype.getUdid = function () { return this.udid }, e.prototype.getId = function () { return this.id }, e.prototype.getMethod = function () { return this.method }, e.prototype.getData = function () { return this.data }, e.prototype.getArgs = function () { return this.args }, e.KILL_SERVER = "kill_server", e.START_SERVER = "start_server", e.UPDATE_INTERFACES = "update_interfaces", e.CONFIGURE_STREAM = "configure_stream", e.RUN_WDA = "run-wda", e.REQUEST_WDA = "request-wda", e }(); t.ControlCenterCommand = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ChannelCode = void 0, function (e) { e.FSLS = "FSLS", e.HSTS = "HSTS", e.SHEL = "SHEL", e.GTRC = "GTRC", e.ATRC = "ATRC" }(t.ChannelCode || (t.ChannelCode = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { this.x = Math.round(e), this.y = Math.round(t) } return e.prototype.equals = function (e) { return this === e || null !== e && (this.x === e.x && this.y === e.y) }, e.prototype.distance = function (e) { var t = this.x - e.x, n = this.y - e.y; return Math.sqrt(t * t + n * n) }, e.prototype.toString = function () { return "Point{x=" + this.x + ", y=" + this.y + "}" }, e.prototype.toJSON = function () { return { x: this.x, y: this.y } }, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.data = e, this.nri = (96 & e[0]) >> 5, this.ntype = 31 & e[0] } return Object.defineProperty(e, "NDR", { get: function () { return 1 }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "IDR", { get: function () { return 5 }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "SEI", { get: function () { return 6 }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "SPS", { get: function () { return 7 }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "PPS", { get: function () { return 8 }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "TYPES", { get: function () { var t; return (t = {})[e.IDR] = "IDR", t[e.SEI] = "SEI", t[e.SPS] = "SPS", t[e.PPS] = "PPS", t[e.NDR] = "NDR", t }, enumerable: !0, configurable: !0 }), e.type = function (t) { return t.ntype in e.TYPES ? e.TYPES[t.ntype] : "UNKNOWN" }, e.prototype.type = function () { return this.ntype }, e.prototype.isKeyframe = function () { return this.ntype === e.IDR }, e.prototype.getSize = function () { return 4 + this.data.byteLength }, e.prototype.getData = function () { var e = new Uint8Array(this.getSize()); return new DataView(e.buffer).setUint32(0, this.getSize() - 4), e.set(this.data, 4), e }, e }(); t.default = r }, function (e, t, n) { "use strict"; t.decode = t.parse = n(47), t.encode = t.stringify = n(48) }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.CommandControlMessage = t.FilePushState = void 0; var r, i = n(0), o = n(10), a = i.__importDefault(n(1)); !function (e) { e[e.NEW = 0] = "NEW", e[e.START = 1] = "START", e[e.APPEND = 2] = "APPEND", e[e.FINISH = 3] = "FINISH", e[e.CANCEL = 4] = "CANCEL" }(r = t.FilePushState || (t.FilePushState = {})); var s = function (t) { function n(e) { var n = t.call(this, e) || this; return n.type = e, n } return i.__extends(n, t), n.createSetVideoSettingsCommand = function (t) { var r = t.toBuffer(), i = new n(o.ControlMessage.TYPE_CHANGE_STREAM_PARAMETERS), a = n.PAYLOAD_LENGTH + 1, s = new e(a + r.length); return s.writeUInt8(i.type, 0), r.forEach((function (e, t) { s.writeUInt8(e, t + a) })), i.buffer = s, i }, n.createSetClipboardCommand = function (t, r) { void 0 === r && (r = !1); var i = new n(o.ControlMessage.TYPE_SET_CLIPBOARD), s = t ? a.default.stringToUtf8ByteArray(t) : null, u = s ? s.length : 0, c = 0, l = new e(6 + u); return c = l.writeInt8(i.type, c), c = l.writeInt8(r ? 1 : 0, c), c = l.writeInt32BE(u, c), s && s.forEach((function (e, t) { l.writeUInt8(e, t + c) })), i.buffer = l, i }, n.createSetScreenPowerModeCommand = function (t) { var r = new n(o.ControlMessage.TYPE_SET_SCREEN_POWER_MODE), i = 0, a = e.alloc(2); return i = a.writeInt8(r.type, i), a.writeUInt8(t ? 1 : 0, i), r.buffer = a, r }, n.createPushFileCommand = function (e) { var t = e.id, n = e.fileName, i = e.fileSize, o = e.chunk, a = e.state; if (a === r.START) return this.createPushFileStartCommand(t, n, i); if (a === r.APPEND) { if (!o) throw TypeError("Invalid type"); return this.createPushFileChunkCommand(t, o) } if (a === r.CANCEL || a === r.FINISH || a === r.NEW) return this.createPushFileOtherCommand(t, a); throw TypeError('Unsupported state: "' + a + '"') }, n.createPushFileStartCommand = function (t, i, s) { var u = new n(o.ControlMessage.TYPE_PUSH_FILE), c = a.default.stringToUtf8ByteArray(i), l = c.length, d = n.PAYLOAD_LENGTH, f = new e(d + 1 + 2 + 1 + 4 + 2 + l); return f.writeUInt8(u.type, d), d += 1, f.writeInt16BE(t, d), d += 2, f.writeInt8(r.START, d), d += 1, f.writeUInt32BE(s, d), d += 4, f.writeUInt16BE(l, d), d += 2, c.forEach((function (e, t) { f.writeUInt8(e, t + d) })), u.buffer = f, u }, n.createPushFileChunkCommand = function (t, i) { var a = new n(o.ControlMessage.TYPE_PUSH_FILE), s = i.byteLength, u = n.PAYLOAD_LENGTH, c = new e(u + 1 + 2 + 1 + 4 + s); return c.writeUInt8(a.type, u), u += 1, c.writeInt16BE(t, u), u += 2, c.writeInt8(r.APPEND, u), u += 1, c.writeUInt32BE(s, u), u += 4, Array.from(i).forEach((function (e, t) { c.writeUInt8(e, t + u) })), a.buffer = c, a }, n.createPushFileOtherCommand = function (t, r) { var i = new n(o.ControlMessage.TYPE_PUSH_FILE), a = n.PAYLOAD_LENGTH, s = new e(a + 1 + 2 + 1); return s.writeUInt8(i.type, a), a += 1, s.writeInt16BE(t, a), a += 2, s.writeInt8(r, a), i.buffer = s, i }, n.pushFileCommandFromBuffer = function (e) { var t = 0, i = e.readUInt8(t); if (t += 1, i !== n.TYPE_PUSH_FILE) throw TypeError('Incorrect type: "' + i + '"'); var o = e.readInt16BE(t); t += 2; var s, u, c, l = e.readInt8(t); if (t += 1, l === r.APPEND) { var d = e.readUInt32BE(t); t += 4, s = e.slice(t, t + d) } else if (l === r.START) { u = e.readUInt32BE(t), t += 4; var f = e.readUInt16BE(t); t += 2, c = a.default.utf8ByteArrayToString(e.slice(t, t + f)) } return { id: o, state: l, chunk: s, fileName: c, fileSize: u } }, n.prototype.toBuffer = function () { if (!this.buffer) { var t = new e(n.PAYLOAD_LENGTH + 1); t.writeUInt8(this.type, 0), this.buffer = t } return this.buffer }, n.prototype.toString = function () { var e = this.buffer ? ", buffer=[" + this.buffer.join(",") + "]" : ""; return "CommandControlMessage{action=" + this.type + e + "}" }, n.PAYLOAD_LENGTH = 0, n.Commands = new Map([[o.ControlMessage.TYPE_EXPAND_NOTIFICATION_PANEL, "Expand notifications"], [o.ControlMessage.TYPE_EXPAND_SETTINGS_PANEL, "Expand settings"], [o.ControlMessage.TYPE_COLLAPSE_PANELS, "Collapse panels"], [o.ControlMessage.TYPE_GET_CLIPBOARD, "Get clipboard"], [o.ControlMessage.TYPE_SET_CLIPBOARD, "Set clipboard"], [o.ControlMessage.TYPE_ROTATE_DEVICE, "Rotate device"], [o.ControlMessage.TYPE_CHANGE_STREAM_PARAMETERS, "Change video settings"]]), n }(o.ControlMessage); t.CommandControlMessage = s }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), i = n(53), o = n(54), a = "[FilePushHandler]", s = function () { function e(t, n) { var r = this; this.element = t, this.filePushStream = n, this.responseWaiter = new Map, this.listeners = new Set, this.pushIdFileNameMap = new Map, this.onStreamError = function (e) { var t = e.id, n = e.error, i = r.pushIdFileNameMap.get(t) || "Unknown file"; r.sendUpdate({ pushId: t, fileName: i, message: n.message, progress: -1, error: !0, finished: !0 }) }, this.onStreamResponse = function (t) { var n, i = t.code, s = t.id, u = i === o.FilePushResponseStatus.NEW_PUSH_ID ? e.REQUEST_NEW_PUSH_ID : t.id, c = r.responseWaiter.get(u); c ? (Array.isArray(c) ? (n = c.shift(), c.length || r.responseWaiter.delete(u)) : (n = c, r.responseWaiter.delete(u)), n(i === o.FilePushResponseStatus.NEW_PUSH_ID ? { id: u, code: s } : { id: u, code: i })) : console.warn(a, 'Unexpected push id: "' + u + '", ' + JSON.stringify(t)) }, i.DragAndDropHandler.addEventListener(this), n.on("response", this.onStreamResponse), n.on("error", this.onStreamError) } return e.prototype.sendUpdate = function (e) { e.error && this.pushIdFileNameMap.delete(e.pushId), this.listeners.forEach((function (t) { t.onFilePushUpdate(e) })) }, e.prototype.logError = function (e, t, n) { var r = u.get(n) || "Unknown error (" + n + ")"; this.sendUpdate({ pushId: e, fileName: t, message: 'error: "' + r + '"', progress: -1, error: !0, finished: !0 }) }, e.getStreamReader = function (e) { return r.__awaiter(this, void 0, void 0, (function () { var t, n, i; return r.__generator(this, (function (r) { switch (r.label) { case 0: return [4, new Response(e).blob()]; case 1: return t = r.sent(), [4, (n = t.stream().getReader()).read()]; case 2: return i = r.sent(), [2, { reader: n, result: i }] } })) })) }, e.prototype.pushFile = function (t) { return r.__awaiter(this, void 0, void 0, (function () { var n, i, s, u, c, l, d, f, h, p, E, v, m, y = this; return r.__generator(this, (function (_) { switch (_.label) { case 0: return n = Date.now(), i = t.name, s = t.size, this.filePushStream.hasConnection() ? (u = e.REQUEST_NEW_PUSH_ID, this.sendUpdate({ pushId: u, fileName: i, message: "begins...", progress: 0, error: !1, finished: !1 }), this.filePushStream.sendEventNew({ id: u }), [4, this.waitForResponse(u)]) : (this.listeners.forEach((function (e) { e.onError("WebSocket is not ready") })), [2]); case 1: return (c = _.sent().code) <= 0 ? [2, this.logError(c, i, c)] : (this.pushIdFileNameMap.set(c, i), l = this.waitForResponse(c), this.filePushStream.sendEventStart({ id: c, fileName: i, fileSize: s }), [4, Promise.all([l, e.getStreamReader(t)])]); case 2: return d = r.__read.apply(void 0, [_.sent(), 2]), f = d[0].code, h = d[1], p = h.reader, E = h.result, f !== o.FilePushResponseStatus.NO_ERROR ? (this.logError(c, i, f), [2]) : (v = 0, [2, (m = function (e) { var t = e.done, o = e.value; return r.__awaiter(y, void 0, void 0, (function () { var e, u, l, d, f, h; return r.__generator(this, (function (E) { switch (E.label) { case 0: return !t && o ? [3, 2] : (this.filePushStream.sendEventFinish({ id: c }), [4, this.waitForResponse(c)]); case 1: return 0 !== (e = E.sent().code) ? this.logError(c, i, e) : this.sendUpdate({ pushId: c, fileName: i, message: "success!", progress: 100, error: !1, finished: !0 }), console.log(a, 'File "' + i + '" uploaded in ' + (Date.now() - n) + "ms"), [2]; case 2: return v += o.length, this.filePushStream.sendEventAppend({ id: c, chunk: o }), [4, Promise.all([this.waitForResponse(c), p.read()])]; case 3: return u = r.__read.apply(void 0, [E.sent(), 2]), l = u[0].code, d = u[1], 0 !== l ? (this.logError(c, i, l), [2]) : (h = (f = 100 * v / s).toFixed(2) + "%", this.sendUpdate({ pushId: c, fileName: i, message: h, progress: f, error: !1, finished: !1 }), [2, m(d)]) } })) })) })(E)]) } })) })) }, e.prototype.waitForResponse = function (e) { var t = this; return new Promise((function (n) { var r = t.responseWaiter.get(e); if (Array.isArray(r)) r.push(n); else if (r) { var i = [r]; i.push(n), t.responseWaiter.set(e, i) } else t.responseWaiter.set(e, n) })) }, e.prototype.onFilesDrop = function (t) { var n = this; return this.listeners.forEach((function (e) { e.onDrop() })), t.forEach((function (t) { var r = t.type, i = t.name; if (n.filePushStream.isAllowedFile(t)) n.pushFile(t); else { var o = { pushId: e.REQUEST_NEW_PUSH_ID, fileName: i, message: 'Unsupported type "' + r + '"', progress: -1, error: !0, finished: !0 }; n.sendUpdate(o) } })), !0 }, e.getErrorMessage = function (e, t) { return t || u.get(e) || "Unknown error" }, e.prototype.onDragEnter = function () { var e = !1; return this.listeners.forEach((function (t) { e = e || t.onDragEnter() })), e }, e.prototype.onDragLeave = function () { var e = !1; return this.listeners.forEach((function (t) { e = e || t.onDragLeave() })), e }, e.prototype.getElement = function () { return this.element }, e.prototype.release = function () { this.filePushStream.off("response", this.onStreamResponse), this.filePushStream.off("error", this.onStreamError), this.filePushStream.release(), i.DragAndDropHandler.removeEventListener(this), this.listeners.clear() }, e.prototype.addEventListener = function (e) { this.listeners.add(e) }, e.prototype.removeEventListener = function (e) { this.listeners.delete(e) }, e.REQUEST_NEW_PUSH_ID = 0, e }(); t.default = s; var u = new Map([[o.FilePushResponseStatus.NEW_PUSH_ID, "New push id"], [o.FilePushResponseStatus.NO_ERROR, "No error"], [o.FilePushResponseStatus.ERROR_INVALID_NAME, "Invalid name"], [o.FilePushResponseStatus.ERROR_NO_SPACE, "No space"], [o.FilePushResponseStatus.ERROR_FAILED_TO_DELETE, "Failed to delete existing"], [o.FilePushResponseStatus.ERROR_FAILED_TO_CREATE, "Failed to create new file"], [o.FilePushResponseStatus.ERROR_FILE_NOT_FOUND, "File not found"], [o.FilePushResponseStatus.ERROR_FAILED_TO_WRITE, "Failed to write to file"], [o.FilePushResponseStatus.ERROR_FILE_IS_BUSY, "File is busy"], [o.FilePushResponseStatus.ERROR_INVALID_STATE, "Invalid state"], [o.FilePushResponseStatus.ERROR_UNKNOWN_ID, "Unknown id"], [o.FilePushResponseStatus.ERROR_NO_FREE_ID, "No free id"], [o.FilePushResponseStatus.ERROR_INCORRECT_SIZE, "Incorrect size"]]) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.ACTION_DOWN = 0, e.ACTION_UP = 1, e.KEYCODE_0 = 7, e.KEYCODE_1 = 8, e.KEYCODE_11 = 227, e.KEYCODE_12 = 228, e.KEYCODE_2 = 9, e.KEYCODE_3 = 10, e.KEYCODE_3D_MODE = 206, e.KEYCODE_4 = 11, e.KEYCODE_5 = 12, e.KEYCODE_6 = 13, e.KEYCODE_7 = 14, e.KEYCODE_8 = 15, e.KEYCODE_9 = 16, e.KEYCODE_A = 29, e.KEYCODE_ALL_APPS = 284, e.KEYCODE_ALT_LEFT = 57, e.KEYCODE_ALT_RIGHT = 58, e.KEYCODE_APOSTROPHE = 75, e.KEYCODE_APP_SWITCH = 187, e.KEYCODE_ASSIST = 219, e.KEYCODE_AT = 77, e.KEYCODE_AVR_INPUT = 182, e.KEYCODE_AVR_POWER = 181, e.KEYCODE_B = 30, e.KEYCODE_BACK = 4, e.KEYCODE_BACKSLASH = 73, e.KEYCODE_BOOKMARK = 174, e.KEYCODE_BREAK = 121, e.KEYCODE_BRIGHTNESS_DOWN = 220, e.KEYCODE_BRIGHTNESS_UP = 221, e.KEYCODE_BUTTON_1 = 188, e.KEYCODE_BUTTON_10 = 197, e.KEYCODE_BUTTON_11 = 198, e.KEYCODE_BUTTON_12 = 199, e.KEYCODE_BUTTON_13 = 200, e.KEYCODE_BUTTON_14 = 201, e.KEYCODE_BUTTON_15 = 202, e.KEYCODE_BUTTON_16 = 203, e.KEYCODE_BUTTON_2 = 189, e.KEYCODE_BUTTON_3 = 190, e.KEYCODE_BUTTON_4 = 191, e.KEYCODE_BUTTON_5 = 192, e.KEYCODE_BUTTON_6 = 193, e.KEYCODE_BUTTON_7 = 194, e.KEYCODE_BUTTON_8 = 195, e.KEYCODE_BUTTON_9 = 196, e.KEYCODE_BUTTON_A = 96, e.KEYCODE_BUTTON_B = 97, e.KEYCODE_BUTTON_C = 98, e.KEYCODE_BUTTON_L1 = 102, e.KEYCODE_BUTTON_L2 = 104, e.KEYCODE_BUTTON_MODE = 110, e.KEYCODE_BUTTON_R1 = 103, e.KEYCODE_BUTTON_R2 = 105, e.KEYCODE_BUTTON_SELECT = 109, e.KEYCODE_BUTTON_START = 108, e.KEYCODE_BUTTON_THUMBL = 106, e.KEYCODE_BUTTON_THUMBR = 107, e.KEYCODE_BUTTON_X = 99, e.KEYCODE_BUTTON_Y = 100, e.KEYCODE_BUTTON_Z = 101, e.KEYCODE_C = 31, e.KEYCODE_CALCULATOR = 210, e.KEYCODE_CALENDAR = 208, e.KEYCODE_CALL = 5, e.KEYCODE_CAMERA = 27, e.KEYCODE_CAPS_LOCK = 115, e.KEYCODE_CAPTIONS = 175, e.KEYCODE_CHANNEL_DOWN = 167, e.KEYCODE_CHANNEL_UP = 166, e.KEYCODE_CLEAR = 28, e.KEYCODE_COMMA = 55, e.KEYCODE_CONTACTS = 207, e.KEYCODE_COPY = 278, e.KEYCODE_CTRL_LEFT = 113, e.KEYCODE_CTRL_RIGHT = 114, e.KEYCODE_CUT = 277, e.KEYCODE_D = 32, e.KEYCODE_DEL = 67, e.KEYCODE_DPAD_CENTER = 23, e.KEYCODE_DPAD_DOWN = 20, e.KEYCODE_DPAD_DOWN_LEFT = 269, e.KEYCODE_DPAD_DOWN_RIGHT = 271, e.KEYCODE_DPAD_LEFT = 21, e.KEYCODE_DPAD_RIGHT = 22, e.KEYCODE_DPAD_UP = 19, e.KEYCODE_DPAD_UP_LEFT = 268, e.KEYCODE_DPAD_UP_RIGHT = 270, e.KEYCODE_DVR = 173, e.KEYCODE_E = 33, e.KEYCODE_EISU = 212, e.KEYCODE_ENDCALL = 6, e.KEYCODE_ENTER = 66, e.KEYCODE_ENVELOPE = 65, e.KEYCODE_EQUALS = 70, e.KEYCODE_ESCAPE = 111, e.KEYCODE_EXPLORER = 64, e.KEYCODE_F = 34, e.KEYCODE_F1 = 131, e.KEYCODE_F10 = 140, e.KEYCODE_F11 = 141, e.KEYCODE_F12 = 142, e.KEYCODE_F2 = 132, e.KEYCODE_F3 = 133, e.KEYCODE_F4 = 134, e.KEYCODE_F5 = 135, e.KEYCODE_F6 = 136, e.KEYCODE_F7 = 137, e.KEYCODE_F8 = 138, e.KEYCODE_F9 = 139, e.KEYCODE_FOCUS = 80, e.KEYCODE_FORWARD = 125, e.KEYCODE_FORWARD_DEL = 112, e.KEYCODE_FUNCTION = 119, e.KEYCODE_G = 35, e.KEYCODE_GRAVE = 68, e.KEYCODE_GUIDE = 172, e.KEYCODE_H = 36, e.KEYCODE_HEADSETHOOK = 79, e.KEYCODE_HELP = 259, e.KEYCODE_HENKAN = 214, e.KEYCODE_HOME = 3, e.KEYCODE_I = 37, e.KEYCODE_INFO = 165, e.KEYCODE_INSERT = 124, e.KEYCODE_J = 38, e.KEYCODE_K = 39, e.KEYCODE_KANA = 218, e.KEYCODE_KATAKANA_HIRAGANA = 215, e.KEYCODE_L = 40, e.KEYCODE_LANGUAGE_SWITCH = 204, e.KEYCODE_LAST_CHANNEL = 229, e.KEYCODE_LEFT_BRACKET = 71, e.KEYCODE_M = 41, e.KEYCODE_MANNER_MODE = 205, e.KEYCODE_MEDIA_AUDIO_TRACK = 222, e.KEYCODE_MEDIA_CLOSE = 128, e.KEYCODE_MEDIA_EJECT = 129, e.KEYCODE_MEDIA_FAST_FORWARD = 90, e.KEYCODE_MEDIA_NEXT = 87, e.KEYCODE_MEDIA_PAUSE = 127, e.KEYCODE_MEDIA_PLAY = 126, e.KEYCODE_MEDIA_PLAY_PAUSE = 85, e.KEYCODE_MEDIA_PREVIOUS = 88, e.KEYCODE_MEDIA_RECORD = 130, e.KEYCODE_MEDIA_REWIND = 89, e.KEYCODE_MEDIA_SKIP_BACKWARD = 273, e.KEYCODE_MEDIA_SKIP_FORWARD = 272, e.KEYCODE_MEDIA_STEP_BACKWARD = 275, e.KEYCODE_MEDIA_STEP_FORWARD = 274, e.KEYCODE_MEDIA_STOP = 86, e.KEYCODE_MEDIA_TOP_MENU = 226, e.KEYCODE_MENU = 82, e.KEYCODE_META_LEFT = 117, e.KEYCODE_META_RIGHT = 118, e.KEYCODE_MINUS = 69, e.KEYCODE_MOVE_END = 123, e.KEYCODE_MOVE_HOME = 122, e.KEYCODE_MUHENKAN = 213, e.KEYCODE_MUSIC = 209, e.KEYCODE_MUTE = 91, e.KEYCODE_N = 42, e.KEYCODE_NAVIGATE_IN = 262, e.KEYCODE_NAVIGATE_NEXT = 261, e.KEYCODE_NAVIGATE_OUT = 263, e.KEYCODE_NAVIGATE_PREVIOUS = 260, e.KEYCODE_NOTIFICATION = 83, e.KEYCODE_NUM = 78, e.KEYCODE_NUMPAD_0 = 144, e.KEYCODE_NUMPAD_1 = 145, e.KEYCODE_NUMPAD_2 = 146, e.KEYCODE_NUMPAD_3 = 147, e.KEYCODE_NUMPAD_4 = 148, e.KEYCODE_NUMPAD_5 = 149, e.KEYCODE_NUMPAD_6 = 150, e.KEYCODE_NUMPAD_7 = 151, e.KEYCODE_NUMPAD_8 = 152, e.KEYCODE_NUMPAD_9 = 153, e.KEYCODE_NUMPAD_ADD = 157, e.KEYCODE_NUMPAD_COMMA = 159, e.KEYCODE_NUMPAD_DIVIDE = 154, e.KEYCODE_NUMPAD_DOT = 158, e.KEYCODE_NUMPAD_ENTER = 160, e.KEYCODE_NUMPAD_EQUALS = 161, e.KEYCODE_NUMPAD_LEFT_PAREN = 162, e.KEYCODE_NUMPAD_MULTIPLY = 155, e.KEYCODE_NUMPAD_RIGHT_PAREN = 163, e.KEYCODE_NUMPAD_SUBTRACT = 156, e.KEYCODE_NUM_LOCK = 143, e.KEYCODE_O = 43, e.KEYCODE_P = 44, e.KEYCODE_PAGE_DOWN = 93, e.KEYCODE_PAGE_UP = 92, e.KEYCODE_PAIRING = 225, e.KEYCODE_PASTE = 279, e.KEYCODE_PERIOD = 56, e.KEYCODE_PICTSYMBOLS = 94, e.KEYCODE_PLUS = 81, e.KEYCODE_POUND = 18, e.KEYCODE_POWER = 26, e.KEYCODE_PROFILE_SWITCH = 288, e.KEYCODE_PROG_BLUE = 186, e.KEYCODE_PROG_GREEN = 184, e.KEYCODE_PROG_RED = 183, e.KEYCODE_PROG_YELLOW = 185, e.KEYCODE_Q = 45, e.KEYCODE_R = 46, e.KEYCODE_REFRESH = 285, e.KEYCODE_RIGHT_BRACKET = 72, e.KEYCODE_RO = 217, e.KEYCODE_S = 47, e.KEYCODE_SCROLL_LOCK = 116, e.KEYCODE_SEARCH = 84, e.KEYCODE_SEMICOLON = 74, e.KEYCODE_SETTINGS = 176, e.KEYCODE_SHIFT_LEFT = 59, e.KEYCODE_SHIFT_RIGHT = 60, e.KEYCODE_SLASH = 76, e.KEYCODE_SLEEP = 223, e.KEYCODE_SOFT_LEFT = 1, e.KEYCODE_SOFT_RIGHT = 2, e.KEYCODE_SOFT_SLEEP = 276, e.KEYCODE_SPACE = 62, e.KEYCODE_STAR = 17, e.KEYCODE_STB_INPUT = 180, e.KEYCODE_STB_POWER = 179, e.KEYCODE_STEM_1 = 265, e.KEYCODE_STEM_2 = 266, e.KEYCODE_STEM_3 = 267, e.KEYCODE_STEM_PRIMARY = 264, e.KEYCODE_SWITCH_CHARSET = 95, e.KEYCODE_SYM = 63, e.KEYCODE_SYSRQ = 120, e.KEYCODE_SYSTEM_NAVIGATION_DOWN = 281, e.KEYCODE_SYSTEM_NAVIGATION_LEFT = 282, e.KEYCODE_SYSTEM_NAVIGATION_RIGHT = 283, e.KEYCODE_SYSTEM_NAVIGATION_UP = 280, e.KEYCODE_T = 48, e.KEYCODE_TAB = 61, e.KEYCODE_THUMBS_DOWN = 287, e.KEYCODE_THUMBS_UP = 286, e.KEYCODE_TV = 170, e.KEYCODE_TV_ANTENNA_CABLE = 242, e.KEYCODE_TV_AUDIO_DESCRIPTION = 252, e.KEYCODE_TV_AUDIO_DESCRIPTION_MIX_DOWN = 254, e.KEYCODE_TV_AUDIO_DESCRIPTION_MIX_UP = 253, e.KEYCODE_TV_CONTENTS_MENU = 256, e.KEYCODE_TV_DATA_SERVICE = 230, e.KEYCODE_TV_INPUT = 178, e.KEYCODE_TV_INPUT_COMPONENT_1 = 249, e.KEYCODE_TV_INPUT_COMPONENT_2 = 250, e.KEYCODE_TV_INPUT_COMPOSITE_1 = 247, e.KEYCODE_TV_INPUT_COMPOSITE_2 = 248, e.KEYCODE_TV_INPUT_HDMI_1 = 243, e.KEYCODE_TV_INPUT_HDMI_2 = 244, e.KEYCODE_TV_INPUT_HDMI_3 = 245, e.KEYCODE_TV_INPUT_HDMI_4 = 246, e.KEYCODE_TV_INPUT_VGA_1 = 251, e.KEYCODE_TV_MEDIA_CONTEXT_MENU = 257, e.KEYCODE_TV_NETWORK = 241, e.KEYCODE_TV_NUMBER_ENTRY = 234, e.KEYCODE_TV_POWER = 177, e.KEYCODE_TV_RADIO_SERVICE = 232, e.KEYCODE_TV_SATELLITE = 237, e.KEYCODE_TV_SATELLITE_BS = 238, e.KEYCODE_TV_SATELLITE_CS = 239, e.KEYCODE_TV_SATELLITE_SERVICE = 240, e.KEYCODE_TV_TELETEXT = 233, e.KEYCODE_TV_TERRESTRIAL_ANALOG = 235, e.KEYCODE_TV_TERRESTRIAL_DIGITAL = 236, e.KEYCODE_TV_TIMER_PROGRAMMING = 258, e.KEYCODE_TV_ZOOM_MODE = 255, e.KEYCODE_U = 49, e.KEYCODE_UNKNOWN = 0, e.KEYCODE_V = 50, e.KEYCODE_VOICE_ASSIST = 231, e.KEYCODE_VOLUME_DOWN = 25, e.KEYCODE_VOLUME_MUTE = 164, e.KEYCODE_VOLUME_UP = 24, e.KEYCODE_W = 51, e.KEYCODE_WAKEUP = 224, e.KEYCODE_WINDOW = 171, e.KEYCODE_X = 52, e.KEYCODE_Y = 53, e.KEYCODE_YEN = 216, e.KEYCODE_Z = 54, e.KEYCODE_ZENKAKU_HANKAKU = 211, e.KEYCODE_ZOOM_IN = 168, e.KEYCODE_ZOOM_OUT = 169, e.META_ALT_LEFT_ON = 16, e.META_ALT_MASK = 50, e.META_ALT_ON = 2, e.META_ALT_RIGHT_ON = 32, e.META_CAPS_LOCK_ON = 1048576, e.META_CTRL_LEFT_ON = 8192, e.META_CTRL_MASK = 28672, e.META_CTRL_ON = 4096, e.META_CTRL_RIGHT_ON = 16384, e.META_FUNCTION_ON = 8, e.META_META_LEFT_ON = 131072, e.META_META_MASK = 458752, e.META_META_ON = 65536, e.META_META_RIGHT_ON = 262144, e.META_NUM_LOCK_ON = 2097152, e.META_SCROLL_LOCK_ON = 4194304, e.META_SHIFT_LEFT_ON = 64, e.META_SHIFT_MASK = 193, e.META_SHIFT_ON = 1, e.META_SHIFT_RIGHT_ON = 128, e.META_SYM_ON = 4, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ToolBoxButton = void 0; var r = n(0), i = n(30), o = r.__importDefault(n(6)), a = function (e) { function t(t, n, r) { var i = e.call(this, t, r) || this, a = document.createElement("button"); return a.classList.add("control-button"), a.title = t, a.appendChild(o.default.create(n)), i.btn = a, i } return r.__extends(t, e), t.prototype.getElement = function () { return this.btn }, t.prototype.getAllElements = function () { return [this.btn] }, t }(i.ToolBoxElement); t.ToolBoxButton = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ToolBoxElement = void 0; var r = function () { function e(e, t) { var n = this; this.title = e, this.optional = t, this.listeners = new Map, this.onEvent = function (e) { var t = n.listeners.get(e.type); if (t) { var r = e.type; t.forEach((function (e) { e(r, n) })) } } } return e.prototype.addEventListener = function (e, t, n) { var r = this.listeners.get(e) || new Set; r.size || this.getElement().addEventListener(e, this.onEvent, n); r.add(t), this.listeners.set(e, r) }, e.prototype.removeEventListener = function (e, t) { var n = this.listeners.get(e); n && (n.delete(t), n.size || (this.listeners.delete(e), this.getElement().removeEventListener(e, this.onEvent))) }, e }(); t.ToolBoxElement = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ToolBoxCheckbox = void 0; var r = n(0), i = n(30), o = r.__importDefault(n(6)), a = function (e) { function t(t, n, r, i) { var a = e.call(this, t, i) || this, s = document.createElement("input"); s.type = "checkbox"; var u, c, l = document.createElement("label"); l.title = t, l.classList.add("control-button"), "number" != typeof n ? (u = n.off, c = n.on) : u = n, a.imageOff = o.default.create(u), a.imageOff.classList.add("image", "image-off"), l.appendChild(a.imageOff), c && (a.imageOn = o.default.create(c), a.imageOn.classList.add("image", "image-on"), l.appendChild(a.imageOn), s.classList.add("two-images")); var d = r || t.toLowerCase().replace(" ", "_"); return l.htmlFor = s.id = "input_" + d, a.input = s, a.label = l, a } return r.__extends(t, e), t.prototype.getElement = function () { return this.input }, t.prototype.getAllElements = function () { return [this.input, this.label] }, t }(i.ToolBoxElement); t.ToolBoxCheckbox = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.StreamReceiverScrcpy = void 0; var r = n(0), i = n(33), o = n(4), a = r.__importDefault(n(1)), s = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r.__extends(t, e), t.prototype.parseParameters = function (t) { var n = e.prototype.parseParameters.call(this, t), i = n.action; if (i !== o.ACTION.STREAM_SCRCPY) throw Error("Incorrect action"); return r.__assign(r.__assign({}, n), { action: i, udid: a.default.parseStringEnv(t.udid), ws: a.default.parseStringEnv(t.ws), player: a.default.parseStringEnv(t.player) }) }, t.prototype.buildDirectWebSocketUrl = function () { return new URL(this.params.ws) }, t }(i.StreamReceiver); t.StreamReceiverScrcpy = s }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.StreamReceiver = void 0; var r = n(0), i = n(12), o = r.__importDefault(n(37)), a = r.__importDefault(n(5)), s = r.__importDefault(n(38)), u = r.__importDefault(n(1)), c = n(18), l = u.default.stringToUtf8ByteArray("scrcpy_initial"), d = function (t) { function n(e) { var n = t.call(this, e) || this; return n.events = [], n.encodersSet = new Set, n.clientId = -1, n.deviceName = "", n.displayInfoMap = new Map, n.connectionCountMap = new Map, n.screenInfoMap = new Map, n.videoSettingsMap = new Map, n.hasInitialInfo = !1, n.openNewConnection(), n.ws && (n.ws.binaryType = "arraybuffer"), n } return r.__extends(n, t), n.prototype.handleInitialInfo = function (t) { var n = l.length, r = new Uint8Array(t, n, 64); n += 64; var i = new e(new Uint8Array(t, n)), o = i.readInt32BE(0); this.displayInfoMap.clear(), this.connectionCountMap.clear(), this.screenInfoMap.clear(), this.videoSettingsMap.clear(), i = i.slice(4); for (var d = 0; d < o; d++) { var f = i.slice(0, c.DisplayInfo.BUFFER_LENGTH), h = c.DisplayInfo.fromBuffer(f), p = h.displayId; this.displayInfoMap.set(p, h), i = i.slice(c.DisplayInfo.BUFFER_LENGTH), this.connectionCountMap.set(p, i.readInt32BE(0)); var E = (i = i.slice(4)).readInt32BE(0); i = i.slice(4), E && (this.screenInfoMap.set(p, s.default.fromBuffer(i.slice(0, E))), i = i.slice(E)); var v = i.readInt32BE(0); i = i.slice(4), v && (this.videoSettingsMap.set(p, a.default.fromBuffer(i.slice(0, v))), i = i.slice(v)) } this.encodersSet.clear(); var m = i.readInt32BE(0); i = i.slice(4); for (d = 0; d < m; d++) { var y = i.readInt32BE(0), _ = (i = i.slice(4)).slice(0, y); i = i.slice(y); var g = u.default.utf8ByteArrayToString(_); this.encodersSet.add(g) } this.clientId = i.readInt32BE(0), r = u.default.filterTrailingZeroes(r), this.deviceName = u.default.utf8ByteArrayToString(r), this.hasInitialInfo = !0, this.triggerInitialInfoEvents() }, n.EqualArrays = function (e, t) { if (e.length !== t.length) return !1; for (var n = 0, r = e.length; n < r; n++)if (e[n] !== t[n]) return !1; return !0 }, n.prototype.buildDirectWebSocketUrl = function () { var e = t.prototype.buildDirectWebSocketUrl.call(this); return e.searchParams.set("udid", this.params.udid), e }, n.prototype.onSocketClose = function (e) { console.log("[StreamReceiver]. WS closed: " + e.reason), this.emit("disconnected", e) }, n.prototype.onSocketMessage = function (e) { if (e.data instanceof ArrayBuffer) { if (e.data.byteLength > l.length) { var t = new Uint8Array(e.data, 0, l.length); if (n.EqualArrays(t, l)) return void this.handleInitialInfo(e.data); if (n.EqualArrays(t, o.default.MAGIC_BYTES_MESSAGE)) { var r = o.default.fromBuffer(e.data); return void this.emit("deviceMessage", r) } } this.emit("video", new Uint8Array(e.data)) } }, n.prototype.onSocketOpen = function () { this.emit("connected", void 0); for (var e = this.events.shift(); e;)this.sendEvent(e), e = this.events.shift() }, n.prototype.sendEvent = function (e) { this.ws && this.ws.readyState === this.ws.OPEN ? this.ws.send(e.toBuffer()) : this.events.push(e) }, n.prototype.stop = function () { this.ws && this.ws.readyState === this.ws.OPEN && this.ws.close(), this.events.length = 0 }, n.prototype.getEncoders = function () { return Array.from(this.encodersSet.values()) }, n.prototype.getDeviceName = function () { return this.deviceName }, n.prototype.triggerInitialInfoEvents = function () { var e = this; if (this.hasInitialInfo) { var t = this.getEncoders(); this.emit("encoders", t); var n = this.clientId, r = this.deviceName; this.emit("clientsStats", { clientId: n, deviceName: r }); var i = []; this.displayInfoMap.forEach((function (t, n) { var r = e.connectionCountMap.get(n) || 0; i.push({ displayInfo: t, videoSettings: e.videoSettingsMap.get(n), screenInfo: e.screenInfoMap.get(n), connectionCount: r }) })), this.emit("displayInfo", i) } }, n.prototype.getDisplayInfo = function (e) { return this.displayInfoMap.get(e) }, n }(i.ManagerClient); t.StreamReceiver = d }).call(this, n(2).Buffer) }, function (e, t, n) { (function (e) { var r = void 0 !== e && e || "undefined" != typeof self && self || window, i = Function.prototype.apply; function o(e, t) { this._id = e, this._clearFn = t } t.setTimeout = function () { return new o(i.call(setTimeout, r, arguments), clearTimeout) }, t.setInterval = function () { return new o(i.call(setInterval, r, arguments), clearInterval) }, t.clearTimeout = t.clearInterval = function (e) { e && e.close() }, o.prototype.unref = o.prototype.ref = function () { }, o.prototype.close = function () { this._clearFn.call(r, this._id) }, t.enroll = function (e, t) { clearTimeout(e._idleTimeoutId), e._idleTimeout = t }, t.unenroll = function (e) { clearTimeout(e._idleTimeoutId), e._idleTimeout = -1 }, t._unrefActive = t.active = function (e) { clearTimeout(e._idleTimeoutId); var t = e._idleTimeout; t >= 0 && (e._idleTimeoutId = setTimeout((function () { e._onTimeout && e._onTimeout() }), t)) }, n(80), t.setImmediate = "undefined" != typeof self && self.setImmediate || void 0 !== e && e.setImmediate || this && this.setImmediate, t.clearImmediate = "undefined" != typeof self && self.clearImmediate || void 0 !== e && e.clearImmediate || this && this.clearImmediate }).call(this, n(17)) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MessageType = void 0, function (e) { e[e.CreateChannel = 4] = "CreateChannel", e[e.CloseChannel = 8] = "CloseChannel", e[e.RawBinaryData = 16] = "RawBinaryData", e[e.RawStringData = 32] = "RawStringData", e[e.Data = 64] = "Data" }(t.MessageType || (t.MessageType = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.CloseEventClass = t.CloseEvent2 = void 0; var r = n(0), i = function (e) { function t(t, n) { var r = void 0 === n ? {} : n, i = r.code, o = r.reason, a = e.call(this, t) || this; return a.code = i || 0, a.reason = o || "", a.wasClean = 0 === a.code, a } return r.__extends(t, e), t }(n(13).Event2); t.CloseEvent2 = i, t.CloseEventClass = "undefined" != typeof CloseEvent ? CloseEvent : i }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0).__importDefault(n(1)), i = function () { function t(e, t) { this.type = e, this.buffer = t } return t.fromBuffer = function (n) { var r = this.MAGIC_BYTES_MESSAGE.length, i = e.from(n, r, n.byteLength - r); return new t(i.readUInt8(0), i) }, t.prototype.getText = function () { if (this.type !== t.TYPE_CLIPBOARD) throw TypeError("Wrong message type: " + this.type); if (!this.buffer) throw Error("Empty buffer"); var e = 1, n = this.buffer.readInt32BE(e); e += 4; var i = this.buffer.slice(e, e + n); return r.default.utf8ByteArrayToString(i) }, t.prototype.getPushStats = function () { if (this.type !== t.TYPE_PUSH_RESPONSE) throw TypeError("Wrong message type: " + this.type); if (!this.buffer) throw Error("Empty buffer"); return { id: this.buffer.readInt16BE(1), code: this.buffer.readInt8(3) } }, t.prototype.toString = function () { var e; return e = this.type === t.TYPE_CLIPBOARD && this.buffer ? ", text=[" + this.getText() + "]" : this.buffer ? ", buffer=[" + this.buffer.join(",") + "]" : "", "DeviceMessage{type=" + this.type + e + "}" }, t.TYPE_CLIPBOARD = 0, t.TYPE_PUSH_RESPONSE = 101, t.MAGIC_BYTES_MESSAGE = r.default.stringToUtf8ByteArray("scrcpy_message"), t }(); t.default = i }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), i = r.__importDefault(n(9)), o = r.__importDefault(n(3)), a = function () { function e(e, t, n) { this.contentRect = e, this.videoSize = t, this.deviceRotation = n } return e.fromBuffer = function (t) { var n = t.readInt32BE(0), r = t.readInt32BE(4), a = t.readInt32BE(8), s = t.readInt32BE(12), u = t.readInt32BE(16), c = t.readInt32BE(20), l = t.readUInt8(24); return new e(new i.default(n, r, a, s), new o.default(u, c), l) }, e.prototype.equals = function (e) { return !!e && (this.contentRect.equals(e.contentRect) && this.videoSize.equals(e.videoSize) && this.deviceRotation === e.deviceRotation) }, e.prototype.toString = function () { return "ScreenInfo{contentRect=" + this.contentRect + ", videoSize=" + this.videoSize + ", deviceRotation=" + this.deviceRotation + "}" }, e.BUFFER_LENGTH = 25, e }(); t.default = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DeviceTracker = void 0; var r = n(0); n(85); var i, o = n(20), a = n(86), s = n(4), u = n(21), c = n(16), l = r.__importDefault(n(6)), d = n(14), f = r.__importDefault(n(1)), h = n(19), p = n(40), E = n(22), v = [{ title: "Net Interface", field: "interfaces" }, { title: "Server PID", field: "pid" }], m = function (e) { function t(n, i) { var o = e.call(this, r.__assign(r.__assign({}, n), { action: t.ACTION }), i) || this; return o.tableId = "goog_device_list", o.onInterfaceSelected = function (e) { var t = e.currentTarget, n = t.selectedOptions[0], r = decodeURI(n.getAttribute(h.Attribute.URL) || ""), i = n.getAttribute(h.Attribute.NAME) || "", a = decodeURIComponent(t.getAttribute(h.Attribute.FULL_NAME) || ""), s = t.getAttribute(h.Attribute.UDID) || ""; o.updateLink({ url: r, name: i, fullName: a, udid: s, store: !0 }) }, o.onActionButtonClick = function (e) { var t = e.currentTarget, n = t.getAttribute(h.Attribute.UDID), r = t.getAttribute(h.Attribute.PID) || "", i = t.getAttribute(h.Attribute.COMMAND), a = parseInt(r, 10), s = { id: o.getNextId(), type: i, data: { udid: "string" == typeof n ? n : void 0, pid: isNaN(a) ? void 0 : a } }; o.ws && o.ws.readyState === o.ws.OPEN && o.ws.send(JSON.stringify(s)) }, t.instancesByUrl.set(i, o), o.buildDeviceTable(), o.openNewConnection(), o } return r.__extends(t, e), t.start = function (e) { var n = this.buildUrlForTracker(e).toString(), r = this.instancesByUrl.get(n); return r || (r = new t(e, n)), r }, t.getInstance = function (e) { return this.start(e) }, t.registerTool = function (e) { this.tools.add(e) }, t.prototype.onSocketOpen = function () { }, t.prototype.setIdAndHostName = function (n, i) { var o, a; e.prototype.setIdAndHostName.call(this, n, i); try { for (var s = r.__values(t.instancesByUrl.values()), u = s.next(); !u.done; u = s.next()) { var c = u.value; c.id === n && c !== this && (console.warn('Tracker with url: "' + this.url + '" has the same id(' + this.id + ') as tracker with url "' + c.url + '"'), console.warn("This tracker will shut down"), this.destroy()) } } catch (e) { o = { error: e } } finally { try { u && !u.done && (a = s.return) && a.call(s) } finally { if (o) throw o.error } } }, t.prototype.updateLink = function (e) { var n = this, r = e.url, i = e.name, o = e.fullName, a = e.udid, u = e.store, c = document.getElementsByName(encodeURIComponent("" + t.AttributePrefixPlayerFor + o)); if ("string" == typeof a) { if (u) { var l = t.getLocalStorageKey(o || ""); localStorage && i && localStorage.setItem(l, i) } var d = s.ACTION.STREAM_SCRCPY; c.forEach((function (e) { e.innerHTML = ""; var i = e.getAttribute(t.AttributePlayerFullName), o = e.getAttribute(t.AttributePlayerCodeName); if (i && o) { var s = t.buildLink({ action: d, udid: a, player: decodeURIComponent(o), ws: r }, decodeURIComponent(i), n.params); e.appendChild(s) } })) } }, t.getLocalStorageKey = function (e) { return "device_list::" + e + "::interface" }, t.createUrl = function (e, t) { void 0 === t && (t = ""); var n = !!e.secure, i = e.hostname || location.hostname, o = "number" == typeof e.port ? e.port : n ? 443 : 80, u = this.buildUrl(r.__assign(r.__assign({}, e), { secure: n, hostname: i, port: o })); return t && (u.searchParams.set("action", s.ACTION.PROXY_ADB), u.searchParams.set("remote", "tcp:" + a.SERVER_PORT.toString(10)), u.searchParams.set("udid", t)), u }, t.createInterfaceOption = function (e, t) { var n = document.createElement("option"); return n.setAttribute(h.Attribute.URL, t), n.setAttribute(h.Attribute.NAME, e), n.innerText = "proxy over adb", n }, t.titleToClassName = function (e) { return e.toLowerCase().replace(/\s/g, "_") }, t.prototype.buildDeviceRow = function (e, n) { var o = this, s = "", E = "", m = this.id + "_" + f.default.escapeUdid(n.udid), y = n.state === p.DeviceState.DEVICE, _ = !1, g = "device_services_" + m, S = d.html(i || (i = r.__makeTemplateObject(['<div class="device ', '">\n            <div class="device-header">\n                <div class="device-name">', " ", '</div>\n                <div class="device-serial">', '</div>\n                <div class="device-version">\n                    <div class="release-version">', '</div>\n                    <div class="sdk-version">', '</div>\n                </div>\n                <div class="device-state" title="State: ', '"></div>\n            </div>\n            <div id="', '" class="services"></div>\n        </div>'], ['<div class="device ', '">\n            <div class="device-header">\n                <div class="device-name">', " ", '</div>\n                <div class="device-serial">', '</div>\n                <div class="device-version">\n                    <div class="release-version">', '</div>\n                    <div class="sdk-version">', '</div>\n                </div>\n                <div class="device-state" title="State: ', '"></div>\n            </div>\n            <div id="', '" class="services"></div>\n        </div>'])), y ? "active" : "not-active", n["ro.product.manufacturer"], n["ro.product.model"], n.udid, n["ro.build.version.release"], n["ro.build.version.sdk"], n.state, g).content, C = S.getElementById(g); if (C) { t.tools.forEach((function (e) { var t = e.createEntryForDeviceList(n, "desc-block", o.params); t && C.appendChild(t) })); var O = c.StreamClientScrcpy.createEntryForDeviceList(n, "desc-block", m, this.params); if (O && C.appendChild(O), v.forEach((function (e) { var i, c = e.title, d = e.field; i = "string" == typeof e.field ? "" + n[e.field] : e.field(n); var f = document.createElement("div"); if (f.classList.add(t.titleToClassName(c), "desc-block"), C.appendChild(f), "pid" === d) { _ = "-1" !== i, (w = document.createElement("button")).className = "action-button kill-server-button", w.setAttribute(h.Attribute.UDID, n.udid), w.setAttribute(h.Attribute.PID, i); var p = void 0; if (y) w.classList.add("active"), w.onclick = o.onActionButtonClick, _ ? (p = u.ControlCenterCommand.KILL_SERVER, w.title = "Kill server", w.appendChild(l.default.create(l.default.Icon.CANCEL))) : (p = u.ControlCenterCommand.START_SERVER, w.title = "Start server", w.appendChild(l.default.create(l.default.Icon.REFRESH))), w.setAttribute(h.Attribute.COMMAND, p); else { var v = n["last.update.timestamp"]; if (v) { var g = new Date(v); w.title = "Last update on " + g.toLocaleDateString() + " at " + g.toLocaleTimeString() } else w.title = "Not active"; w.appendChild(l.default.create(l.default.Icon.OFFLINE)) } var S = document.createElement("span"); S.innerText = i, w.appendChild(S), f.appendChild(w) } else if ("interfaces" === d) { var O = t.createUrl(o.params, n.udid).toString(), T = t.getLocalStorageKey(m), D = localStorage && localStorage.getItem(T), I = document.createElement("select"); if (I.setAttribute(h.Attribute.UDID, n.udid), I.setAttribute(h.Attribute.FULL_NAME, m), I.setAttribute("name", encodeURIComponent("" + t.AttributePrefixInterfaceSelectFor + m)), n.interfaces.forEach((function (e) { var i = r.__assign(r.__assign({}, o.params), { secure: !1, hostname: e.ipv4, port: a.SERVER_PORT }), u = t.createUrl(i).toString(), c = t.createInterfaceOption(e.name, u); c.innerText = e.name + ": " + e.ipv4, I.appendChild(c), D ? D !== e.name && E || (c.selected = !0, s = u, E = e.name) : n["wifi.interface"] === e.name && (c.selected = !0) })), y) { var w, b = t.createInterfaceOption("proxy", O); "proxy" !== D && E || (b.selected = !0, s = O, E = "proxy"), I.appendChild(b), (w = document.createElement("button")).className = "action-button update-interfaces-button active", w.title = "Update information", w.appendChild(l.default.create(l.default.Icon.REFRESH)), w.setAttribute(h.Attribute.UDID, n.udid), w.setAttribute(h.Attribute.COMMAND, u.ControlCenterCommand.UPDATE_INTERFACES), w.onclick = o.onActionButtonClick, f.appendChild(w) } I.onchange = o.onInterfaceSelected, f.appendChild(I) } else f.innerText = i })), t.CREATE_DIRECT_LINKS) { var T = "" + t.AttributePrefixPlayerFor + m; c.StreamClientScrcpy.getPlayers().forEach((function (e) { var n = e.playerCodeName, r = e.playerFullName, i = document.createElement("div"); i.classList.add("desc-block"), i.setAttribute("name", encodeURIComponent(T)), i.setAttribute(t.AttributePlayerFullName, encodeURIComponent(r)), i.setAttribute(t.AttributePlayerCodeName, encodeURIComponent(n)), C.appendChild(i) })) } e.appendChild(S), t.CREATE_DIRECT_LINKS && _ && s && this.updateLink({ url: s, name: E, fullName: m, udid: n.udid, store: !1 }) } }, t.prototype.getChannelCode = function () { return E.ChannelCode.GTRC }, t.prototype.destroy = function () { if (e.prototype.destroy.call(this), t.instancesByUrl.delete(this.url.toString()), !t.instancesByUrl.size) { var n = document.getElementById(o.BaseDeviceTracker.HOLDER_ELEMENT_ID); n && n.parentElement && n.parentElement.removeChild(n) } }, t.ACTION = s.ACTION.GOOG_DEVICE_LIST, t.CREATE_DIRECT_LINKS = !0, t.instancesByUrl = new Map, t.tools = new Set, t }(o.BaseDeviceTracker); t.DeviceTracker = m }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DeviceState = void 0, function (e) { e.DEVICE = "device", e.DISCONNECTED = "disconnected", e.CONNECTED = "Connected" }(t.DeviceState || (t.DeviceState = {})) }, function (e, t, n) { "use strict"; var r; Object.defineProperty(t, "__esModule", { value: !0 }), t.InteractionHandler = void 0; var i = n(0), o = i.__importDefault(n(42)), a = n(88), s = i.__importDefault(n(3)), u = i.__importDefault(n(23)), c = i.__importDefault(n(89)), l = i.__importDefault(n(90)), d = i.__importDefault(n(91)), f = i.__importDefault(n(1)), h = "[TouchHandler]", p = function () { function e(t, n, r) { this.player = t, this.touchEventsNames = n, this.keyEventsNames = r, this.multiTouchActive = !1, this.multiTouchShift = !1, this.dirtyPlace = [], this.over = !1, this.tag = t.getTouchableElement(), this.ctx = this.tag.getContext("2d"), e.loadImages(), e.bindGlobalListeners(this) } return e.bindGlobalListeners = function (t) { var n = this; t.touchEventsNames.forEach((function (r) { var i = e.eventListeners.get(r); i || (i = new Set, document.body.addEventListener(r, n.onInteractionEvent, e.options), n.eventListeners.set(r, i)), i.add(t) })), t.keyEventsNames.forEach((function (r) { var i = e.eventListeners.get(r); i || (i = new Set, document.body.addEventListener(r, n.onKeyEvent), n.eventListeners.set(r, i)), i.add(t) })) }, e.unbindListeners = function (t) { var n = this; t.touchEventsNames.forEach((function (r) { var i = e.eventListeners.get(r); i && (i.delete(t), i.size <= 0 && (n.eventListeners.delete(r), document.body.removeEventListener(r, n.onInteractionEvent))) })), t.keyEventsNames.forEach((function (r) { var i = e.eventListeners.get(r); i && (i.delete(t), i.size <= 0 && (n.eventListeners.delete(r), document.body.removeEventListener(r, n.onKeyEvent))) })) }, e.loadImages = function () { var e = this; if (!this.pointImagesLoaded) { var t = 0, n = function (n) { 2 == ++t && (e.pointImagesLoaded = !0), n.target === e.touchPointImage ? e.touchPointRadius = e.touchPointImage.width / 2 : n.target === e.centerPointImage && (e.centerPointRadius = e.centerPointImage.width / 2) }, r = this.touchPointImage = new Image; r.src = l.default, r.onload = n; var i = this.centerPointImage = new Image; i.src = d.default, i.onload = n } }, e.getPointerId = function (e, t) { if (this.idToPointerMap.has(t)) { var n = this.idToPointerMap.get(t); return "touchend" !== e && "touchcancel" !== e || (this.idToPointerMap.delete(t), this.pointerToIdMap.delete(n)), n } for (var r = 0; this.pointerToIdMap.has(r);)r++; return this.idToPointerMap.set(t, r), this.pointerToIdMap.set(r, t), r }, e.buildTouchOnClient = function (e, t) { var n = this.mapTypeToAction(e.type), r = t.videoSize, i = r.width, o = r.height, a = e.target, l = a.getBoundingClientRect(), d = a.clientWidth, f = a.clientHeight, h = e.clientX - l.left, p = e.clientY - l.top, E = !1; (h < 0 || h > d || p < 0 || p > f) && (E = !0); var v = i / o, m = Math.round(1e5 * v), y = Math.round(1e5 * d / f); if (m > y) { var _ = Math.ceil(d / v), g = (f - _) / 2; (p < g || p > g + _) && (E = !0), p -= g, f = _ } else if (m < y) { var S = Math.ceil(f * v), C = (d - S) / 2; (h < C || h > C + S) && (E = !0), h -= C, d = S } var O = h * i / d, T = p * o / f, D = new s.default(i, o), I = new u.default(O, T); return (O < 0 || T < 0 || O > i || T > o) && (E = !0), { client: { width: d, height: f }, touch: { invalid: E, action: n, position: new c.default(I, D), buttons: e.buttons } } }, e.validateMessage = function (t, n, r, i) { var a = [], s = n.action, u = n.pointerId, c = r.get(u); if (s === o.default.ACTION_UP) c ? (r.delete(u), a.push(n)) : console.warn(i, "Received ACTION_UP while there are no DOWN stored"); else if (s === o.default.ACTION_DOWN) c ? console.warn(i, "Received ACTION_DOWN while already has one stored") : (r.set(u, n), a.push(n)); else if (s === o.default.ACTION_MOVE) if (c) a.push(n), r.set(u, n); else if (t instanceof MouseEvent && t.buttons || window.TouchEvent && t instanceof TouchEvent) { console.warn(i, "Received ACTION_MOVE while there are no DOWN stored"); var l = e.createEmulatedMessage(o.default.ACTION_DOWN, n); a.push(l), r.set(u, l) } return a }, e.createEmulatedMessage = function (e, t) { var n = t.pointerId, r = t.position, i = t.buttons, s = t.pressure; return e === o.default.ACTION_UP && (s = 0), new a.TouchControlMessage(e, n, r, s, i) }, e.mapTypeToAction = function (e) { return this.EVENT_ACTION_MAP[e] }, e.prototype.getTouch = function (t, n, r, i) { var o = e.buildTouchOnClient(t, n); if (!o) return null; var a = o.client, s = o.touch, l = [s]; if (!r) return this.multiTouchActive = !1, this.multiTouchCenter = void 0, this.multiTouchShift = !1, this.clearCanvas(), l; var d, f = s.position, h = s.action, p = s.buttons, E = f.point, v = f.screenSize, m = v.width, y = v.height, _ = E.x, g = E.y; this.multiTouchActive || (i ? (this.multiTouchCenter = E, this.multiTouchShift = !0) : this.multiTouchCenter = new u.default(a.width / 2, a.height / 2)), this.multiTouchActive = !0; var S = !1; if (this.multiTouchShift && this.multiTouchCenter) { var C = 2 * this.multiTouchCenter.x - _, O = 2 * this.multiTouchCenter.y - g; d = new u.default(C, O), C <= m && C >= 0 && O <= y && O >= 0 || (S = !0) } else d = new u.default(a.width - _, a.height - g), S = s.invalid; return d && l.push({ invalid: S, action: h, buttons: p, position: new c.default(d, v) }), l }, e.prototype.drawCircle = function (e, t, n) { e.beginPath(), e.arc(t.x, t.y, n, 0, 2 * Math.PI, !0), e.stroke() }, e.prototype.drawLine = function (t, n) { this.ctx && (this.ctx.save(), this.ctx.strokeStyle = e.STROKE_STYLE, this.ctx.beginPath(), this.ctx.moveTo(t.x, t.y), this.ctx.lineTo(n.x, n.y), this.ctx.stroke(), this.ctx.restore()) }, e.prototype.drawPoint = function (t, n, r) { if (this.ctx) { var i = this.ctx.lineWidth; e.pointImagesLoaded && r ? (n = r.width / 2, i = 0, this.ctx.drawImage(r, t.x - n, t.y - n)) : this.drawCircle(this.ctx, t, n); var o = new u.default(t.x - n - i, t.y - n - i), a = new u.default(t.x + n + i, t.y + n + i); this.updateDirty(o, a) } }, e.prototype.drawPointer = function (t) { this.drawPoint(t, e.touchPointRadius, e.touchPointImage), this.multiTouchCenter && this.drawLine(this.multiTouchCenter, t) }, e.prototype.drawCenter = function (t) { this.drawPoint(t, e.centerPointRadius, e.centerPointImage) }, e.prototype.updateDirty = function (e, t) { if (this.dirtyPlace.length) { var n = this.dirtyPlace[0], r = this.dirtyPlace[1], i = new u.default(Math.min(n.x, e.x), Math.min(n.y, e.y)), o = new u.default(Math.max(r.x, t.x), Math.max(r.y, t.y)); this.dirtyPlace.length = 0, this.dirtyPlace.push(i, o) } else this.dirtyPlace.push(e, t) }, e.prototype.clearCanvas = function () { var t = this.tag, n = t.clientWidth, r = t.clientHeight, i = this.ctx; if (i && this.dirtyPlace.length) { var o = this.dirtyPlace[0], a = this.dirtyPlace[1]; this.dirtyPlace.length = 0; var s = Math.max(o.x, 0), u = Math.max(o.y, 0), c = Math.min(n, a.x - s), l = Math.min(r, a.y - u); i.clearRect(s, u, c, l), i.strokeStyle = e.STROKE_STYLE } }, e.prototype.formatTouchEvent = function (t, n, r) { var s = h + "[formatTouchEvent]", u = [], c = t.changedTouches; if (c && c.length) for (var l = 0, d = c.length; l < d; l++) { var f = c[l], p = e.getPointerId(t.type, f.identifier); if (f.target === this.tag) { var E = r.get(p), v = { clientX: f.clientX, clientY: f.clientY, type: t.type, buttons: o.default.BUTTON_PRIMARY, target: t.target }, m = e.buildTouchOnClient(v, n); if (m) { var y = m.touch, _ = y.action, g = y.buttons, S = y.position, C = y.invalid, O = 1; if (_ === o.default.ACTION_UP ? O = 0 : "number" == typeof f.force && (O = f.force), C) E && (u.push(e.createEmulatedMessage(o.default.ACTION_UP, E)), r.delete(p)); else { var T = new a.TouchControlMessage(_, p, S, O, g); u.push.apply(u, i.__spread(e.validateMessage(t, T, r, s + "[validate]"))) } } else console.error(s, "Failed to format touch", f) } } else console.error(s, 'No "touches"', t); return u }, e.prototype.buildTouchEvent = function (t, n, r) { var s = this, u = h + "[buildTouchEvent]", c = this.getTouch(t, n, t.ctrlKey, t.shiftKey); if (!c) return []; var l = [], d = []; return this.clearCanvas(), c.forEach((function (n, s) { var c = n.action, f = n.buttons, h = n.position, p = r.get(s); if (n.invalid) p && d.push(p.position.point); else { var E = 1; c === o.default.ACTION_UP && (E = 0); var v = new a.TouchControlMessage(c, s, h, E, f); l.push.apply(l, i.__spread(e.validateMessage(t, v, r, u + "[validate]"))), d.push(n.position.point) } })), this.multiTouchActive && (this.multiTouchCenter && this.drawCenter(this.multiTouchCenter), d.forEach((function (e) { s.drawPointer(e) }))), l.find((function (e) { return e.action === o.default.ACTION_UP })) && r.size && (console.warn(u, "Looks like one of Multi-touch pointers was not raised up"), r.forEach((function (t) { l.push(e.createEmulatedMessage(o.default.ACTION_UP, t)) })), r.clear()), l }, e.prototype.release = function () { e.unbindListeners(this) }, e.SIMULATE_MULTI_TOUCH = "SIMULATE_MULTI_TOUCH", e.STROKE_STYLE = "#00BEA4", e.EVENT_ACTION_MAP = ((r = { touchstart: o.default.ACTION_DOWN, touchend: o.default.ACTION_UP, touchmove: o.default.ACTION_MOVE, touchcancel: o.default.ACTION_UP, mousedown: o.default.ACTION_DOWN, mousemove: o.default.ACTION_MOVE, mouseup: o.default.ACTION_UP })[e.SIMULATE_MULTI_TOUCH] = -1, r), e.options = !!f.default.supportsPassive() && { passive: !1 }, e.idToPointerMap = new Map, e.pointerToIdMap = new Map, e.touchPointRadius = 10, e.centerPointRadius = 5, e.pointImagesLoaded = !1, e.eventListeners = new Map, e.onInteractionEvent = function (t) { var n = e.eventListeners.get(t.type); n && n.forEach((function (e) { e.onInteraction(t) })) }, e.onKeyEvent = function (t) { var n = e.eventListeners.get(t.type); n && n.forEach((function (e) { e.onKey(t) })) }, e }(); t.InteractionHandler = p }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.ACTION_DOWN = 0, e.ACTION_UP = 1, e.ACTION_MOVE = 2, e.BUTTON_PRIMARY = 1, e.BUTTON_SECONDARY = 2, e.BUTTON_TERTIARY = 4, e }(); t.default = r }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.HostTracker = void 0; var r = n(0), i = n(12), o = n(93), a = n(4), s = n(39), u = n(94), c = n(22), l = "[HostTracker]", d = function (t) { function n() { var e = t.call(this, { action: a.ACTION.LIST_HOSTS }) || this; return e.trackers = [], e.openNewConnection(), e.ws && (e.ws.binaryType = "arraybuffer"), e } return r.__extends(n, t), n.start = function () { this.getInstance() }, n.getInstance = function () { return this.instance || (this.instance = new n), this.instance }, n.prototype.onSocketClose = function (e) { console.log(l, "WS closed"), this.emit("disconnected", e) }, n.prototype.onSocketMessage = function (e) { var t, n = this; try { t = JSON.parse(e.data) } catch (t) { return console.error(l, t.message), void console.log(l, e.data) } switch (t.type) { case o.MessageType.ERROR: var r = t; console.error(l, r.data), this.emit("error", r.data); break; case o.MessageType.HOSTS: (r = t).data.local && r.data.local.forEach((function (e) { var t = e.type, r = "https:" === location.protocol, i = location.port ? parseInt(location.port, 10) : r ? 443 : 80, o = location.hostname; if ("android" === t || "ios" === t) { var a = { useProxy: !1, secure: r, port: i, hostname: o, type: t }; n.startTracker(a) } else console.warn(l, 'Unsupported host type: "' + t + '"') })), r.data.remote && r.data.remote.forEach((function (e) { return n.startTracker(e) })); break; default: console.log(l, "Unknown message type: " + t.type) } }, n.prototype.startTracker = function (e) { switch (e.type) { case "android": this.trackers.push(s.DeviceTracker.start(e)); break; case "ios": this.trackers.push(u.DeviceTracker.start(e)); break; default: console.warn(l, 'Unsupported host type: "' + e.type + '"') } }, n.prototype.onSocketOpen = function () { }, n.prototype.destroy = function () { t.prototype.destroy.call(this), this.trackers.forEach((function (e) { e.destroy() })), this.trackers.length = 0 }, n.prototype.supportMultiplexing = function () { return !0 }, n.prototype.getChannelInitData = function () { var t = e.alloc(4); return t.write(c.ChannelCode.HSTS, "ascii"), t }, n }(i.ManagerClient); t.HostTracker = d }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MsePlayer = void 0; var r = n(0), i = n(11), o = r.__importStar(n(102)), a = r.__importDefault(n(5)), s = r.__importDefault(n(3)), u = function (e) { function t(n, r, i, a) { void 0 === i && (i = t.playerFullName), void 0 === a && (a = t.createElement()); var s = e.call(this, n, r, i, t.storageKeyPrefix, a) || this; return s.tag = a, s.videoStats = [], s.noDecodedFramesSince = -1, s.currentTimeNotChangedSince = -1, s.bigBufferSince = -1, s.aheadOfBufferSince = -1, s.fpf = t.DEFAULT_FRAMES_PER_FRAGMENT, s.supportsScreenshot = !0, s.waitUntilSegmentRemoved = !1, s.blocks = [], s.frames = [], s.jumpEnd = -1, s.lastTime = -1, s.canPlay = !1, s.seekingSince = -1, s.isSafari = !!window.safari, s.isChrome = navigator.userAgent.includes("Chrome"), s.isMac = navigator.platform.startsWith("Mac"), s.MAX_TIME_TO_RECOVER = 200, s.MAX_BUFFER = s.isSafari ? 2 : s.isChrome && s.isMac ? .9 : .2, s.MAX_AHEAD = -.2, s.videoHeight = -1, s.videoWidth = -1, s.onVideoError = function (e) { console.error("[" + s.name + "]", e) }, s.onVideoCanPlay = function () { s.onCanPlayHandler() }, s.checkVideoResize = function () { if (s.tag) { var e = s.tag, t = e.videoHeight, n = e.videoWidth; s.videoHeight === t && s.videoWidth === n || s.handleVideoResize(n, t) } }, s.cleanSourceBuffer = function () { if (s.sourceBuffer && !(s.sourceBuffer.updating || s.blocks.length < 10)) try { s.sourceBuffer.removeEventListener("updateend", s.cleanSourceBuffer), s.waitUntilSegmentRemoved = !1; var e = s.blocks[0].start, t = s.blocks[4].end; s.blocks = s.blocks.slice(5), s.sourceBuffer.remove(e, t); for (var n = s.frames.shift(); n;) { if (!s.checkForIFrame(n)) { s.frames.unshift(n); break } n = s.frames.shift() } } catch (e) { console.error("[" + s.name + "]", "Failed to clean source buffer") } }, s.jumpToEnd = function () { if (s.sourceBuffer && !s.sourceBuffer.updating && s.tag.buffered.length) { var e = s.tag.buffered.end(s.tag.seekable.length - 1); console.log("[" + s.name + "]", "Jumping to the end (" + s.jumpEnd + ", " + (e - s.jumpEnd) + ")."), s.tag.currentTime = e, s.jumpEnd = -1, s.sourceBuffer.removeEventListener("updateend", s.jumpToEnd) } }, a.oncontextmenu = function (e) { return e.preventDefault(), !1 }, a.addEventListener("error", s.onVideoError), a.addEventListener("canplay", s.onVideoCanPlay), o.setLogger((function () { }), console.error), s } return r.__extends(t, e), t.createElement = function (e) { var t = document.createElement("video"); return t.muted = !0, t.autoplay = !0, t.setAttribute("muted", "muted"), t.setAttribute("autoplay", "autoplay"), "string" == typeof e && (t.id = e), t.className = "video-layer", t }, t.isSupported = function () { return "undefined" != typeof MediaSource && MediaSource.isTypeSupported(o.mimeType) }, t.createConverter = function (e, n, r) { return void 0 === n && (n = t.DEFAULT_FRAMES_PER_SECOND), void 0 === r && (r = t.DEFAULT_FRAMES_PER_FRAGMENT), new o.default(e, n, r) }, t.prototype.getVideoPlaybackQuality = function () { var e = this.tag; if (void 0 !== e.mozDecodedFrames) return null; var t = Date.now(); if ("function" == typeof this.tag.getVideoPlaybackQuality) { var n = this.tag.getVideoPlaybackQuality(); return { timestamp: t, decodedFrames: n.totalVideoFrames, droppedFrames: n.droppedVideoFrames } } return void 0 !== e.webkitDecodedFrameCount ? { timestamp: t, decodedFrames: e.webkitDecodedFrameCount, droppedFrames: e.webkitDroppedFrameCount } : null }, t.prototype.onCanPlayHandler = function () { this.canPlay = !0, this.tag.play(), this.tag.removeEventListener("canplay", this.onVideoCanPlay), this.checkVideoResize() }, t.prototype.handleVideoResize = function (e, t) { this.videoWidth = e, this.videoHeight = t }, t.prototype.calculateMomentumStats = function () { var e = this.getVideoPlaybackQuality(); if (e) { var t = Date.now(), n = t - 1e3; for (this.videoStats.push(e); this.videoStats.length && this.videoStats[0].timestamp < n;)this.videoStats.shift(); for (; this.inputBytes.length && this.inputBytes[0].timestamp < n;)this.inputBytes.shift(); var r = 0; this.inputBytes.forEach((function (e) { r += e.bytes })); var i = this.inputBytes.length; if (this.videoStats.length) { var o = this.videoStats[0], a = e.decodedFrames - o.decodedFrames, s = e.droppedFrames - o.droppedFrames; this.momentumQualityStats = { decodedFrames: a, droppedFrames: s, inputBytes: r, inputFrames: i, timestamp: t } } } }, t.prototype.resetStats = function () { e.prototype.resetStats.call(this), this.videoStats = [] }, t.prototype.getImageDataURL = function () { var e = document.createElement("canvas"); e.width = this.tag.clientWidth, e.height = this.tag.clientHeight; var t = e.getContext("2d"); return t && t.drawImage(this.tag, 0, 0, e.width, e.height), e.toDataURL() }, t.prototype.play = function () { if (e.prototype.play.call(this), this.getState() === i.BasePlayer.STATE.PLAYING) { if (!this.converter) { var n = t.DEFAULT_FRAMES_PER_SECOND; this.videoSettings && (n = this.videoSettings.maxFps), this.converter = t.createConverter(this.tag, n, this.fpf), this.canPlay = !1, this.resetStats() } this.converter.play() } }, t.prototype.pause = function () { e.prototype.pause.call(this), this.stopConverter() }, t.prototype.stop = function () { e.prototype.stop.call(this), this.stopConverter() }, t.prototype.setVideoSettings = function (n, r, o) { if (this.videoSettings && this.videoSettings.maxFps !== n.maxFps) { var a = this.getState(); this.converter && (this.stop(), this.converter = t.createConverter(this.tag, n.maxFps, this.fpf), this.canPlay = !1), a === i.BasePlayer.STATE.PLAYING && this.play() } e.prototype.setVideoSettings.call(this, n, r, o) }, t.prototype.getPreferredVideoSetting = function () { return t.preferredVideoSettings }, t.prototype.pushFrame = function (t) { e.prototype.pushFrame.call(this, t), this.checkForIFrame(t) ? this.checkForBadState() : this.frames.push(t) }, t.prototype.checkForBadState = function () { var e = this, t = this.tag.currentTime, n = Date.now(), r = !1; this.momentumQualityStats && (0 === this.momentumQualityStats.decodedFrames && this.momentumQualityStats.inputFrames > 0 ? -1 === this.noDecodedFramesSince ? this.noDecodedFramesSince = n : n - this.noDecodedFramesSince > this.MAX_TIME_TO_RECOVER && (r = !0) : this.noDecodedFramesSince = -1); if (t === this.lastTime && -1 === this.currentTimeNotChangedSince ? this.currentTimeNotChangedSince = n : this.currentTimeNotChangedSince = -1, this.lastTime = t, this.tag.buffered.length) { var i = this.tag.buffered.end(0), o = i - t; if ((0 | i) - t > this.MAX_BUFFER) if (-1 === this.bigBufferSince) this.bigBufferSince = n; else n - this.bigBufferSince > this.MAX_TIME_TO_RECOVER && (r = !0); else this.bigBufferSince = -1; if (o < this.MAX_AHEAD) if (-1 === this.aheadOfBufferSince) this.aheadOfBufferSince = n; else n - this.aheadOfBufferSince > this.MAX_TIME_TO_RECOVER && (r = !0); else this.aheadOfBufferSince = -1; if (-1 !== this.currentTimeNotChangedSince) n - this.currentTimeNotChangedSince > this.MAX_TIME_TO_RECOVER && (r = !0); if (!r) return; var a = 0; if (-1 !== this.seekingSince && (a = n - this.seekingSince) < 1500) return; var s = function () { e.seekingSince = -1, e.tag.removeEventListener("seeked", s), e.tag.play() }; -1 !== this.seekingSince && console.warn("[" + this.name + "]", "Attempt to seek while already seeking! " + a), this.seekingSince = n, this.tag.addEventListener("seeked", s), this.tag.currentTime = this.tag.buffered.end(0) } }, t.prototype.checkForIFrame = function (e) { if (!this.converter) return !1; if (this.sourceBuffer = this.converter.sourceBuffer, i.BasePlayer.isIFrame(e)) { var t = 0, n = 0; if (this.tag.buffered && this.tag.buffered.length && (t = this.tag.buffered.start(0), n = this.tag.buffered.end(0)), 0 !== n && t < n) { var r = { start: t, end: n }; if (this.blocks.push(r), this.blocks.length > 10) return this.waitUntilSegmentRemoved = !0, this.sourceBuffer.addEventListener("updateend", this.cleanSourceBuffer), this.converter.appendRawData(e), !0 } this.sourceBuffer && (this.sourceBuffer.onupdateend = this.checkVideoResize) } return !this.waitUntilSegmentRemoved && (this.converter.appendRawData(e), !0) }, t.prototype.stopConverter = function () { this.converter && (this.converter.appendRawData(new Uint8Array([])), this.converter.pause(), delete this.converter) }, t.prototype.getFitToScreenStatus = function () { return t.getFitToScreenStatus(this.udid, this.displayInfo) }, t.prototype.loadVideoSettings = function () { return t.loadVideoSettings(this.udid, this.displayInfo) }, t.storageKeyPrefix = "MseDecoder", t.playerFullName = "H264 Converter", t.playerCodeName = "mse", t.preferredVideoSettings = new a.default({ lockedVideoOrientation: -1, bitrate: 7340032, maxFps: 60, iFrameInterval: 10, bounds: new s.default(720, 720), sendFrameMeta: !1 }), t.DEFAULT_FRAMES_PER_FRAGMENT = 1, t.DEFAULT_FRAMES_PER_SECOND = 60, t }(i.BasePlayer); t.MsePlayer = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0); n(46); var i = r.__importStar(n(25)), o = n(16), a = n(43), s = n(20); window.onload = function () { return r.__awaiter(this, void 0, void 0, (function () { var e; return r.__generator(this, (function (t) { switch (t.label) { case 0: return [4, Promise.resolve().then((function () { return r.__importStar(n(44)) }))]; case 1: return e = t.sent().MsePlayer, o.StreamClientScrcpy.registerPlayer(e), a.HostTracker.start(), 1e3, 3e4, new Promise((function (e) { var t = 0, n = setTimeout((function r() { try { !0 === document.getElementsByClassName("link-stream")[0].hasAttribute("href") && (setTimeout((function () { clearInterval(n) })), e("Glasses connected")) } catch (e) { console.log("[Dev]: Waiting for Oculus connection \n" + e.name + "  " + e.message) } t++, n = 1e3 * t > 3e4 ? setTimeout(r, 5e3) : setTimeout(r, 1e3) }), 1e3) })).then((function () { var e = document.getElementsByClassName("link-stream")[0].getAttribute("href"); if (null !== e) { var t = e.replace(/^#!/, ""), n = i.parse(t); o.StreamClientScrcpy.start(n) } })).then((function () { s.BaseDeviceTracker.setVideoStanding() })), [2] } })) })) } }, function (e, t, n) { }, function (e, t, n) { "use strict"; function r(e, t) { return Object.prototype.hasOwnProperty.call(e, t) } e.exports = function (e, t, n, o) { t = t || "&", n = n || "="; var a = {}; if ("string" != typeof e || 0 === e.length) return a; var s = /\+/g; e = e.split(t); var u = 1e3; o && "number" == typeof o.maxKeys && (u = o.maxKeys); var c = e.length; u > 0 && c > u && (c = u); for (var l = 0; l < c; ++l) { var d, f, h, p, E = e[l].replace(s, "%20"), v = E.indexOf(n); v >= 0 ? (d = E.substr(0, v), f = E.substr(v + 1)) : (d = E, f = ""), h = decodeURIComponent(d), p = decodeURIComponent(f), r(a, h) ? i(a[h]) ? a[h].push(p) : a[h] = [a[h], p] : a[h] = p } return a }; var i = Array.isArray || function (e) { return "[object Array]" === Object.prototype.toString.call(e) } }, function (e, t, n) { "use strict"; var r = function (e) { switch (typeof e) { case "string": return e; case "boolean": return e ? "true" : "false"; case "number": return isFinite(e) ? e : ""; default: return "" } }; e.exports = function (e, t, n, s) { return t = t || "&", n = n || "=", null === e && (e = void 0), "object" == typeof e ? o(a(e), (function (a) { var s = encodeURIComponent(r(a)) + n; return i(e[a]) ? o(e[a], (function (e) { return s + encodeURIComponent(r(e)) })).join(t) : s + encodeURIComponent(r(e[a])) })).join(t) : s ? encodeURIComponent(r(s)) + n + encodeURIComponent(r(e)) : "" }; var i = Array.isArray || function (e) { return "[object Array]" === Object.prototype.toString.call(e) }; function o(e, t) { if (e.map) return e.map(t); for (var n = [], r = 0; r < e.length; r++)n.push(t(e[r], r)); return n } var a = Object.keys || function (e) { var t = []; for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && t.push(n); return t } }, function (e, t, n) { "use strict"; var r, i = "object" == typeof Reflect ? Reflect : null, o = i && "function" == typeof i.apply ? i.apply : function (e, t, n) { return Function.prototype.apply.call(e, t, n) }; r = i && "function" == typeof i.ownKeys ? i.ownKeys : Object.getOwnPropertySymbols ? function (e) { return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)) } : function (e) { return Object.getOwnPropertyNames(e) }; var a = Number.isNaN || function (e) { return e != e }; function s() { s.init.call(this) } e.exports = s, e.exports.once = function (e, t) { return new Promise((function (n, r) { function i() { void 0 !== o && e.removeListener("error", o), n([].slice.call(arguments)) } var o; "error" !== t && (o = function (n) { e.removeListener(t, i), r(n) }, e.once("error", o)), e.once(t, i) })) }, s.EventEmitter = s, s.prototype._events = void 0, s.prototype._eventsCount = 0, s.prototype._maxListeners = void 0; var u = 10; function c(e) { if ("function" != typeof e) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof e) } function l(e) { return void 0 === e._maxListeners ? s.defaultMaxListeners : e._maxListeners } function d(e, t, n, r) { var i, o, a, s; if (c(n), void 0 === (o = e._events) ? (o = e._events = Object.create(null), e._eventsCount = 0) : (void 0 !== o.newListener && (e.emit("newListener", t, n.listener ? n.listener : n), o = e._events), a = o[t]), void 0 === a) a = o[t] = n, ++e._eventsCount; else if ("function" == typeof a ? a = o[t] = r ? [n, a] : [a, n] : r ? a.unshift(n) : a.push(n), (i = l(e)) > 0 && a.length > i && !a.warned) { a.warned = !0; var u = new Error("Possible EventEmitter memory leak detected. " + a.length + " " + String(t) + " listeners added. Use emitter.setMaxListeners() to increase limit"); u.name = "MaxListenersExceededWarning", u.emitter = e, u.type = t, u.count = a.length, s = u, console && console.warn && console.warn(s) } return e } function f() { if (!this.fired) return this.target.removeListener(this.type, this.wrapFn), this.fired = !0, 0 === arguments.length ? this.listener.call(this.target) : this.listener.apply(this.target, arguments) } function h(e, t, n) { var r = { fired: !1, wrapFn: void 0, target: e, type: t, listener: n }, i = f.bind(r); return i.listener = n, r.wrapFn = i, i } function p(e, t, n) { var r = e._events; if (void 0 === r) return []; var i = r[t]; return void 0 === i ? [] : "function" == typeof i ? n ? [i.listener || i] : [i] : n ? function (e) { for (var t = new Array(e.length), n = 0; n < t.length; ++n)t[n] = e[n].listener || e[n]; return t }(i) : v(i, i.length) } function E(e) { var t = this._events; if (void 0 !== t) { var n = t[e]; if ("function" == typeof n) return 1; if (void 0 !== n) return n.length } return 0 } function v(e, t) { for (var n = new Array(t), r = 0; r < t; ++r)n[r] = e[r]; return n } Object.defineProperty(s, "defaultMaxListeners", { enumerable: !0, get: function () { return u }, set: function (e) { if ("number" != typeof e || e < 0 || a(e)) throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + e + "."); u = e } }), s.init = function () { void 0 !== this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = Object.create(null), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0 }, s.prototype.setMaxListeners = function (e) { if ("number" != typeof e || e < 0 || a(e)) throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + e + "."); return this._maxListeners = e, this }, s.prototype.getMaxListeners = function () { return l(this) }, s.prototype.emit = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t.push(arguments[n]); var r = "error" === e, i = this._events; if (void 0 !== i) r = r && void 0 === i.error; else if (!r) return !1; if (r) { var a; if (t.length > 0 && (a = t[0]), a instanceof Error) throw a; var s = new Error("Unhandled error." + (a ? " (" + a.message + ")" : "")); throw s.context = a, s } var u = i[e]; if (void 0 === u) return !1; if ("function" == typeof u) o(u, this, t); else { var c = u.length, l = v(u, c); for (n = 0; n < c; ++n)o(l[n], this, t) } return !0 }, s.prototype.addListener = function (e, t) { return d(this, e, t, !1) }, s.prototype.on = s.prototype.addListener, s.prototype.prependListener = function (e, t) { return d(this, e, t, !0) }, s.prototype.once = function (e, t) { return c(t), this.on(e, h(this, e, t)), this }, s.prototype.prependOnceListener = function (e, t) { return c(t), this.prependListener(e, h(this, e, t)), this }, s.prototype.removeListener = function (e, t) { var n, r, i, o, a; if (c(t), void 0 === (r = this._events)) return this; if (void 0 === (n = r[e])) return this; if (n === t || n.listener === t) 0 == --this._eventsCount ? this._events = Object.create(null) : (delete r[e], r.removeListener && this.emit("removeListener", e, n.listener || t)); else if ("function" != typeof n) { for (i = -1, o = n.length - 1; o >= 0; o--)if (n[o] === t || n[o].listener === t) { a = n[o].listener, i = o; break } if (i < 0) return this; 0 === i ? n.shift() : function (e, t) { for (; t + 1 < e.length; t++)e[t] = e[t + 1]; e.pop() }(n, i), 1 === n.length && (r[e] = n[0]), void 0 !== r.removeListener && this.emit("removeListener", e, a || t) } return this }, s.prototype.off = s.prototype.removeListener, s.prototype.removeAllListeners = function (e) { var t, n, r; if (void 0 === (n = this._events)) return this; if (void 0 === n.removeListener) return 0 === arguments.length ? (this._events = Object.create(null), this._eventsCount = 0) : void 0 !== n[e] && (0 == --this._eventsCount ? this._events = Object.create(null) : delete n[e]), this; if (0 === arguments.length) { var i, o = Object.keys(n); for (r = 0; r < o.length; ++r)"removeListener" !== (i = o[r]) && this.removeAllListeners(i); return this.removeAllListeners("removeListener"), this._events = Object.create(null), this._eventsCount = 0, this } if ("function" == typeof (t = n[e])) this.removeListener(e, t); else if (void 0 !== t) for (r = t.length - 1; r >= 0; r--)this.removeListener(e, t[r]); return this }, s.prototype.listeners = function (e) { return p(this, e, !0) }, s.prototype.rawListeners = function (e) { return p(this, e, !1) }, s.listenerCount = function (e, t) { return "function" == typeof e.listenerCount ? e.listenerCount(t) : E.call(e, t) }, s.prototype.listenerCount = E, s.prototype.eventNames = function () { return this._eventsCount > 0 ? r(this._events) : [] } }, function (e, t, n) { "use strict"; t.byteLength = function (e) { var t = c(e), n = t[0], r = t[1]; return 3 * (n + r) / 4 - r }, t.toByteArray = function (e) { var t, n, r = c(e), a = r[0], s = r[1], u = new o(function (e, t, n) { return 3 * (t + n) / 4 - n }(0, a, s)), l = 0, d = s > 0 ? a - 4 : a; for (n = 0; n < d; n += 4)t = i[e.charCodeAt(n)] << 18 | i[e.charCodeAt(n + 1)] << 12 | i[e.charCodeAt(n + 2)] << 6 | i[e.charCodeAt(n + 3)], u[l++] = t >> 16 & 255, u[l++] = t >> 8 & 255, u[l++] = 255 & t; 2 === s && (t = i[e.charCodeAt(n)] << 2 | i[e.charCodeAt(n + 1)] >> 4, u[l++] = 255 & t); 1 === s && (t = i[e.charCodeAt(n)] << 10 | i[e.charCodeAt(n + 1)] << 4 | i[e.charCodeAt(n + 2)] >> 2, u[l++] = t >> 8 & 255, u[l++] = 255 & t); return u }, t.fromByteArray = function (e) { for (var t, n = e.length, i = n % 3, o = [], a = 0, s = n - i; a < s; a += 16383)o.push(l(e, a, a + 16383 > s ? s : a + 16383)); 1 === i ? (t = e[n - 1], o.push(r[t >> 2] + r[t << 4 & 63] + "==")) : 2 === i && (t = (e[n - 2] << 8) + e[n - 1], o.push(r[t >> 10] + r[t >> 4 & 63] + r[t << 2 & 63] + "=")); return o.join("") }; for (var r = [], i = [], o = "undefined" != typeof Uint8Array ? Uint8Array : Array, a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", s = 0, u = a.length; s < u; ++s)r[s] = a[s], i[a.charCodeAt(s)] = s; function c(e) { var t = e.length; if (t % 4 > 0) throw new Error("Invalid string. Length must be a multiple of 4"); var n = e.indexOf("="); return -1 === n && (n = t), [n, n === t ? 0 : 4 - n % 4] } function l(e, t, n) { for (var i, o, a = [], s = t; s < n; s += 3)i = (e[s] << 16 & 16711680) + (e[s + 1] << 8 & 65280) + (255 & e[s + 2]), a.push(r[(o = i) >> 18 & 63] + r[o >> 12 & 63] + r[o >> 6 & 63] + r[63 & o]); return a.join("") } i["-".charCodeAt(0)] = 62, i["_".charCodeAt(0)] = 63 }, function (e, t) { t.read = function (e, t, n, r, i) { var o, a, s = 8 * i - r - 1, u = (1 << s) - 1, c = u >> 1, l = -7, d = n ? i - 1 : 0, f = n ? -1 : 1, h = e[t + d]; for (d += f, o = h & (1 << -l) - 1, h >>= -l, l += s; l > 0; o = 256 * o + e[t + d], d += f, l -= 8); for (a = o & (1 << -l) - 1, o >>= -l, l += r; l > 0; a = 256 * a + e[t + d], d += f, l -= 8); if (0 === o) o = 1 - c; else { if (o === u) return a ? NaN : 1 / 0 * (h ? -1 : 1); a += Math.pow(2, r), o -= c } return (h ? -1 : 1) * a * Math.pow(2, o - r) }, t.write = function (e, t, n, r, i, o) { var a, s, u, c = 8 * o - i - 1, l = (1 << c) - 1, d = l >> 1, f = 23 === i ? Math.pow(2, -24) - Math.pow(2, -77) : 0, h = r ? 0 : o - 1, p = r ? 1 : -1, E = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0; for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0, a = l) : (a = Math.floor(Math.log(t) / Math.LN2), t * (u = Math.pow(2, -a)) < 1 && (a--, u *= 2), (t += a + d >= 1 ? f / u : f * Math.pow(2, 1 - d)) * u >= 2 && (a++, u /= 2), a + d >= l ? (s = 0, a = l) : a + d >= 1 ? (s = (t * u - 1) * Math.pow(2, i), a += d) : (s = t * Math.pow(2, d - 1) * Math.pow(2, i), a = 0)); i >= 8; e[n + h] = 255 & s, h += p, s /= 256, i -= 8); for (a = a << i | s, c += i; c > 0; e[n + h] = 255 & a, h += p, a /= 256, c -= 8); e[n + h - p] |= 128 * E } }, function (e, t) { var n = {}.toString; e.exports = Array.isArray || function (e) { return "[object Array]" == n.call(e) } }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DragAndDropHandler = void 0; var r = function () { function e() { } return e.attachListeners = function (e) { e.addEventListener("drop", this.dropHandler), e.addEventListener("dragover", this.dragOverHandler), e.addEventListener("dragleave", this.dragLeaveHandler), e.addEventListener("dragenter", this.dragEnterHandler) }, e.detachListeners = function (e) { e.removeEventListener("drop", this.dropHandler), e.removeEventListener("dragover", this.dragOverHandler), e.removeEventListener("dragleave", this.dragLeaveHandler), e.removeEventListener("dragenter", this.dragEnterHandler) }, e.addEventListener = function (e) { this.listeners.has(e) || (this.attachListeners(e.getElement()), this.listeners.add(e)) }, e.removeEventListener = function (e) { this.listeners.has(e) && (this.detachListeners(e.getElement()), this.listeners.delete(e)) }, e.listeners = new Set, e.dropHandler = function (t) { if (!t.dataTransfer) return !1; var n = []; if (t.dataTransfer.items) { for (var r = 0; r < t.dataTransfer.items.length; r++)if ("file" === t.dataTransfer.items[r].kind) { var i = t.dataTransfer.items[r].getAsFile(); i && n.push(i) } } else for (r = 0; r < t.dataTransfer.files.length; r++)n.push(t.dataTransfer.files[r]); var o = !1; return e.listeners.forEach((function (e) { e.getElement() === t.currentTarget && (o = o || e.onFilesDrop(n)) })), !!o && (t.preventDefault(), !0) }, e.dragOverHandler = function (e) { e.preventDefault() }, e.dragLeaveHandler = function (t) { var n = !1; return e.listeners.forEach((function (e) { e.getElement() === t.currentTarget && (n = n || e.onDragLeave()) })), !!n && (t.preventDefault(), !0) }, e.dragEnterHandler = function (t) { var n = !1; return e.listeners.forEach((function (e) { e.getElement() === t.currentTarget && (n = n || e.onDragEnter()) })), !!n && (t.preventDefault(), !0) }, e }(); t.DragAndDropHandler = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.FilePushResponseStatus = void 0, function (e) { e[e.NEW_PUSH_ID = 1] = "NEW_PUSH_ID", e[e.NO_ERROR = 0] = "NO_ERROR", e[e.ERROR_INVALID_NAME = -1] = "ERROR_INVALID_NAME", e[e.ERROR_NO_SPACE = -2] = "ERROR_NO_SPACE", e[e.ERROR_FAILED_TO_DELETE = -3] = "ERROR_FAILED_TO_DELETE", e[e.ERROR_FAILED_TO_CREATE = -4] = "ERROR_FAILED_TO_CREATE", e[e.ERROR_FILE_NOT_FOUND = -5] = "ERROR_FILE_NOT_FOUND", e[e.ERROR_FAILED_TO_WRITE = -6] = "ERROR_FAILED_TO_WRITE", e[e.ERROR_FILE_IS_BUSY = -7] = "ERROR_FILE_IS_BUSY", e[e.ERROR_INVALID_STATE = -8] = "ERROR_INVALID_STATE", e[e.ERROR_UNKNOWN_ID = -9] = "ERROR_UNKNOWN_ID", e[e.ERROR_NO_FREE_ID = -10] = "ERROR_NO_FREE_ID", e[e.ERROR_INCORRECT_SIZE = -11] = "ERROR_INCORRECT_SIZE", e[e.ERROR_OTHER = -12] = "ERROR_OTHER" }(t.FilePushResponseStatus || (t.FilePushResponseStatus = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0).__importDefault(n(27)), i = "[DragAndPushLogger]", o = function () { function e(t) { var n = this; if (this.ctx = null, this.timeoutMap = new Map, this.dirtyMap = new Map, this.pushLineMap = new Map, this.linePushMap = new Map, this.dirtyLines = [], this.cleanDirtyLine = function (t) { if (n.ctx) { var r = e.X, i = e.Y, o = e.HEIGHT, a = r, s = i + o * t * 2, u = n.dirtyMap.get(t); if (u) { var c = e.HEIGHT / 2, l = 2 * c; n.ctx.clearRect(a - c, s - o - c, u + l, o + l) } n.dirtyLines[t] = !1 } }, t instanceof HTMLCanvasElement) { var r = t; this.ctx = r.getContext("2d") } } return e.prototype.logText = function (t, n, r, o) { var a = this; if (void 0 === r && (r = !1), void 0 === o && (o = !1), this.ctx) { o && console.error(i, t), this.cleanDirtyLine(n); var s = e.X, u = e.Y, c = e.HEIGHT, l = s, d = u + c * n * 2; this.ctx.save(), this.ctx.font = c + "px monospace"; var f = this.ctx.measureText(t), h = Math.abs(f.actualBoundingBoxLeft) + Math.abs(f.actualBoundingBoxRight); this.dirtyMap.set(n, h), this.ctx.fillStyle = e.LOG_BACKGROUND; var p = e.HEIGHT / 2 - 1, E = 2 * p; if (this.ctx.fillRect(l - p, d - c - p, h + E, c + E), this.ctx.fillStyle = o ? e.ERROR_COLOR : e.DEBUG_COLOR, this.ctx.fillText(t, l, d), this.ctx.restore(), r) { this.dirtyLines[n] = !0; var v = this.timeoutMap.get(n); v && clearTimeout(v), v = window.setTimeout((function () { a.cleanDirtyLine(n); var e = a.linePushMap.get(n); "string" == typeof e && (a.linePushMap.delete(n), a.pushLineMap.delete(e)) }), 5e3), this.timeoutMap.set(n, v) } } else o ? console.error(i, t) : console.log(i, t) }, e.prototype.onDragEnter = function () { return this.logText("Drop APK files here", 1), !0 }, e.prototype.onDragLeave = function () { return this.cleanDirtyLine(1), !0 }, e.prototype.onDrop = function () { return this.cleanDirtyLine(1), !0 }, e.prototype.onError = function (e) { var t = "string" == typeof e ? e : e.message; this.logText(t, 1, !0) }, e.prototype.onFilePushUpdate = function (e) { var t = e.pushId, n = e.message, i = e.fileName, o = e.error, a = t + "/" + i, s = r.default.REQUEST_NEW_PUSH_ID + "/" + i, u = this.pushLineMap.get(a), c = !1; if (void 0 === u && a !== s && void 0 !== (u = this.pushLineMap.get(s)) && (this.pushLineMap.delete(s), c = !0), void 0 === u) { for (u = 2; this.dirtyLines[u];)u++; c = !0 } c && (this.pushLineMap.set(a, u), this.linePushMap.set(u, a)), this.logText('Upload "' + i + '": ' + n, u, !0, o) }, e.X = 20, e.Y = 40, e.HEIGHT = 12, e.LOG_BACKGROUND = "rgba(0,0,0, 0.5)", e.DEBUG_COLOR = "hsl(136, 85%,50%)", e.ERROR_COLOR = "hsl(336,85%,50%)", e }(); t.default = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.KeyInputHandler = void 0; var r = n(0), i = n(57), o = r.__importDefault(n(28)), a = n(58), s = function () { function e() { } return e.attachListeners = function () { document.body.addEventListener("keydown", this.handler), document.body.addEventListener("keyup", this.handler) }, e.detachListeners = function () { document.body.removeEventListener("keydown", this.handler), document.body.removeEventListener("keyup", this.handler) }, e.addEventListener = function (e) { this.listeners.size || this.attachListeners(), this.listeners.add(e) }, e.removeEventListener = function (e) { this.listeners.delete(e), this.listeners.size || this.detachListeners() }, e.repeatCounter = new Map, e.listeners = new Set, e.handler = function (t) { var n = t, r = a.KeyToCodeMap.get(n.code); if (r) { var s, u = 0; if ("keydown" === n.type) { if (s = o.default.ACTION_DOWN, n.repeat) { var c = e.repeatCounter.get(r); "number" != typeof c ? c = 1 : c++, u = c, e.repeatCounter.set(r, c) } } else { if ("keyup" !== n.type) return; s = o.default.ACTION_UP, e.repeatCounter.delete(r) } var l = (n.getModifierState("Alt") ? o.default.META_ALT_ON : 0) | (n.getModifierState("Shift") ? o.default.META_SHIFT_ON : 0) | (n.getModifierState("Control") ? o.default.META_CTRL_ON : 0) | (n.getModifierState("Meta") ? o.default.META_META_ON : 0) | (n.getModifierState("CapsLock") ? o.default.META_CAPS_LOCK_ON : 0) | (n.getModifierState("ScrollLock") ? o.default.META_SCROLL_LOCK_ON : 0) | (n.getModifierState("NumLock") ? o.default.META_NUM_LOCK_ON : 0), d = new i.KeyCodeControlMessage(s, r, u, l); e.listeners.forEach((function (e) { e.onKeyEvent(d) })), t.preventDefault() } }, e }(); t.KeyInputHandler = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.KeyCodeControlMessage = void 0; var r = n(0), i = n(2), o = n(10), a = function (e) { function t(t, n, r, i) { var a = e.call(this, o.ControlMessage.TYPE_KEYCODE) || this; return a.action = t, a.keycode = n, a.repeat = r, a.metaState = i, a } return r.__extends(t, e), t.prototype.toBuffer = function () { var e = new i.Buffer(t.PAYLOAD_LENGTH + 1), n = 0; return n = e.writeInt8(this.type, n), n = e.writeInt8(this.action, n), n = e.writeInt32BE(this.keycode, n), n = e.writeInt32BE(this.repeat, n), e.writeInt32BE(this.metaState, n), e }, t.prototype.toString = function () { return "KeyCodeControlMessage{action=" + this.action + ", keycode=" + this.keycode + ", metaState=" + this.metaState + "}" }, t.prototype.toJSON = function () { return { type: this.type, action: this.action, keycode: this.keycode, metaState: this.metaState, repeat: this.repeat } }, t.PAYLOAD_LENGTH = 13, t }(o.ControlMessage); t.KeyCodeControlMessage = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.KeyToCodeMap = void 0; var r = n(0), i = r.__importDefault(n(28)), o = r.__importDefault(n(59)); t.KeyToCodeMap = new Map([[o.default.Backquote, i.default.KEYCODE_GRAVE], [o.default.Backslash, i.default.KEYCODE_BACKSLASH], [o.default.BracketLeft, i.default.KEYCODE_LEFT_BRACKET], [o.default.BracketRight, i.default.KEYCODE_RIGHT_BRACKET], [o.default.Comma, i.default.KEYCODE_COMMA], [o.default.Digit0, i.default.KEYCODE_0], [o.default.Digit1, i.default.KEYCODE_1], [o.default.Digit2, i.default.KEYCODE_2], [o.default.Digit3, i.default.KEYCODE_3], [o.default.Digit4, i.default.KEYCODE_4], [o.default.Digit5, i.default.KEYCODE_5], [o.default.Digit6, i.default.KEYCODE_6], [o.default.Digit7, i.default.KEYCODE_7], [o.default.Digit8, i.default.KEYCODE_8], [o.default.Digit9, i.default.KEYCODE_9], [o.default.Equal, i.default.KEYCODE_EQUALS], [o.default.IntlRo, i.default.KEYCODE_RO], [o.default.IntlYen, i.default.KEYCODE_YEN], [o.default.KeyA, i.default.KEYCODE_A], [o.default.KeyB, i.default.KEYCODE_B], [o.default.KeyC, i.default.KEYCODE_C], [o.default.KeyD, i.default.KEYCODE_D], [o.default.KeyE, i.default.KEYCODE_E], [o.default.KeyF, i.default.KEYCODE_F], [o.default.KeyG, i.default.KEYCODE_G], [o.default.KeyH, i.default.KEYCODE_H], [o.default.KeyI, i.default.KEYCODE_I], [o.default.KeyJ, i.default.KEYCODE_J], [o.default.KeyK, i.default.KEYCODE_K], [o.default.KeyL, i.default.KEYCODE_L], [o.default.KeyM, i.default.KEYCODE_M], [o.default.KeyN, i.default.KEYCODE_N], [o.default.KeyO, i.default.KEYCODE_O], [o.default.KeyP, i.default.KEYCODE_P], [o.default.KeyQ, i.default.KEYCODE_Q], [o.default.KeyR, i.default.KEYCODE_R], [o.default.KeyS, i.default.KEYCODE_S], [o.default.KeyT, i.default.KEYCODE_T], [o.default.KeyU, i.default.KEYCODE_U], [o.default.KeyV, i.default.KEYCODE_V], [o.default.KeyW, i.default.KEYCODE_W], [o.default.KeyX, i.default.KEYCODE_X], [o.default.KeyY, i.default.KEYCODE_Y], [o.default.KeyZ, i.default.KEYCODE_Z], [o.default.Minus, i.default.KEYCODE_MINUS], [o.default.Period, i.default.KEYCODE_PERIOD], [o.default.Quote, i.default.KEYCODE_APOSTROPHE], [o.default.Semicolon, i.default.KEYCODE_SEMICOLON], [o.default.Slash, i.default.KEYCODE_SLASH], [o.default.KanaMode, i.default.KEYCODE_KANA], [o.default.Delete, i.default.KEYCODE_FORWARD_DEL], [o.default.End, i.default.KEYCODE_MOVE_END], [o.default.Help, i.default.KEYCODE_HELP], [o.default.Home, i.default.KEYCODE_MOVE_HOME], [o.default.Insert, i.default.KEYCODE_INSERT], [o.default.PageDown, i.default.KEYCODE_PAGE_DOWN], [o.default.PageUp, i.default.KEYCODE_PAGE_UP], [o.default.AltLeft, i.default.KEYCODE_ALT_LEFT], [o.default.AltRight, i.default.KEYCODE_ALT_RIGHT], [o.default.Backspace, i.default.KEYCODE_DEL], [o.default.CapsLock, i.default.KEYCODE_CAPS_LOCK], [o.default.ControlLeft, i.default.KEYCODE_CTRL_LEFT], [o.default.ControlRight, i.default.KEYCODE_CTRL_RIGHT], [o.default.Enter, i.default.KEYCODE_ENTER], [o.default.MetaLeft, i.default.KEYCODE_META_LEFT], [o.default.MetaRight, i.default.KEYCODE_META_RIGHT], [o.default.ShiftLeft, i.default.KEYCODE_SHIFT_LEFT], [o.default.ShiftRight, i.default.KEYCODE_SHIFT_RIGHT], [o.default.Space, i.default.KEYCODE_SPACE], [o.default.Tab, i.default.KEYCODE_TAB], [o.default.ArrowLeft, i.default.KEYCODE_DPAD_LEFT], [o.default.ArrowUp, i.default.KEYCODE_DPAD_UP], [o.default.ArrowRight, i.default.KEYCODE_DPAD_RIGHT], [o.default.ArrowDown, i.default.KEYCODE_DPAD_DOWN], [o.default.NumLock, i.default.KEYCODE_NUM_LOCK], [o.default.Numpad0, i.default.KEYCODE_NUMPAD_0], [o.default.Numpad1, i.default.KEYCODE_NUMPAD_1], [o.default.Numpad2, i.default.KEYCODE_NUMPAD_2], [o.default.Numpad3, i.default.KEYCODE_NUMPAD_3], [o.default.Numpad4, i.default.KEYCODE_NUMPAD_4], [o.default.Numpad5, i.default.KEYCODE_NUMPAD_5], [o.default.Numpad6, i.default.KEYCODE_NUMPAD_6], [o.default.Numpad7, i.default.KEYCODE_NUMPAD_7], [o.default.Numpad8, i.default.KEYCODE_NUMPAD_8], [o.default.Numpad9, i.default.KEYCODE_NUMPAD_9], [o.default.NumpadAdd, i.default.KEYCODE_NUMPAD_ADD], [o.default.NumpadComma, i.default.KEYCODE_NUMPAD_COMMA], [o.default.NumpadDecimal, i.default.KEYCODE_NUMPAD_DOT], [o.default.NumpadDivide, i.default.KEYCODE_NUMPAD_DIVIDE], [o.default.NumpadEnter, i.default.KEYCODE_NUMPAD_ENTER], [o.default.NumpadEqual, i.default.KEYCODE_NUMPAD_EQUALS], [o.default.NumpadMultiply, i.default.KEYCODE_NUMPAD_MULTIPLY], [o.default.NumpadParenLeft, i.default.KEYCODE_NUMPAD_LEFT_PAREN], [o.default.NumpadParenRight, i.default.KEYCODE_NUMPAD_RIGHT_PAREN], [o.default.NumpadSubtract, i.default.KEYCODE_NUMPAD_SUBTRACT], [o.default.Escape, i.default.KEYCODE_ESCAPE], [o.default.F1, i.default.KEYCODE_F1], [o.default.F2, i.default.KEYCODE_F2], [o.default.F3, i.default.KEYCODE_F3], [o.default.F4, i.default.KEYCODE_F4], [o.default.F5, i.default.KEYCODE_F5], [o.default.F6, i.default.KEYCODE_F6], [o.default.F7, i.default.KEYCODE_F7], [o.default.F8, i.default.KEYCODE_F8], [o.default.F9, i.default.KEYCODE_F9], [o.default.F10, i.default.KEYCODE_F10], [o.default.F11, i.default.KEYCODE_F11], [o.default.F12, i.default.KEYCODE_F12], [o.default.Fn, i.default.KEYCODE_FUNCTION], [o.default.PrintScreen, i.default.KEYCODE_SYSRQ], [o.default.Pause, i.default.KEYCODE_BREAK]]) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.Backquote = "Backquote", e.Backslash = "Backslash", e.BracketLeft = "BracketLeft", e.BracketRight = "BracketRight", e.Comma = "Comma", e.Digit0 = "Digit0", e.Digit1 = "Digit1", e.Digit2 = "Digit2", e.Digit3 = "Digit3", e.Digit4 = "Digit4", e.Digit5 = "Digit5", e.Digit6 = "Digit6", e.Digit7 = "Digit7", e.Digit8 = "Digit8", e.Digit9 = "Digit9", e.Equal = "Equal", e.IntlBackslash = "IntlBackslash", e.IntlRo = "IntlRo", e.IntlYen = "IntlYen", e.KeyA = "KeyA", e.KeyB = "KeyB", e.KeyC = "KeyC", e.KeyD = "KeyD", e.KeyE = "KeyE", e.KeyF = "KeyF", e.KeyG = "KeyG", e.KeyH = "KeyH", e.KeyI = "KeyI", e.KeyJ = "KeyJ", e.KeyK = "KeyK", e.KeyL = "KeyL", e.KeyM = "KeyM", e.KeyN = "KeyN", e.KeyO = "KeyO", e.KeyP = "KeyP", e.KeyQ = "KeyQ", e.KeyR = "KeyR", e.KeyS = "KeyS", e.KeyT = "KeyT", e.KeyU = "KeyU", e.KeyV = "KeyV", e.KeyW = "KeyW", e.KeyX = "KeyX", e.KeyY = "KeyY", e.KeyZ = "KeyZ", e.Minus = "Minus", e.Period = "Period", e.Quote = "Quote", e.Semicolon = "Semicolon", e.Slash = "Slash", e.AltLeft = "AltLeft", e.AltRight = "AltRight", e.Backspace = "Backspace", e.CapsLock = "CapsLock", e.ContextMenu = "ContextMenu", e.ControlLeft = "ControlLeft", e.ControlRight = "ControlRight", e.Enter = "Enter", e.MetaLeft = "MetaLeft", e.MetaRight = "MetaRight", e.ShiftLeft = "ShiftLeft", e.ShiftRight = "ShiftRight", e.Space = "Space", e.Tab = "Tab", e.Convert = "Convert", e.KanaMode = "KanaMode", e.Lang1 = "Lang1", e.Lang2 = "Lang2", e.Lang3 = "Lang3", e.Lang4 = "Lang4", e.Lang5 = "Lang5", e.NonConvert = "NonConvert", e.Delete = "Delete", e.End = "End", e.Help = "Help", e.Home = "Home", e.Insert = "Insert", e.PageDown = "PageDown", e.PageUp = "PageUp", e.ArrowDown = "ArrowDown", e.ArrowLeft = "ArrowLeft", e.ArrowRight = "ArrowRight", e.ArrowUp = "ArrowUp", e.NumLock = "NumLock", e.Numpad0 = "Numpad0", e.Numpad1 = "Numpad1", e.Numpad2 = "Numpad2", e.Numpad3 = "Numpad3", e.Numpad4 = "Numpad4", e.Numpad5 = "Numpad5", e.Numpad6 = "Numpad6", e.Numpad7 = "Numpad7", e.Numpad8 = "Numpad8", e.Numpad9 = "Numpad9", e.NumpadAdd = "NumpadAdd", e.NumpadBackspace = "NumpadBackspace", e.NumpadClear = "NumpadClear", e.NumpadClearEntry = "NumpadClearEntry", e.NumpadComma = "NumpadComma", e.NumpadDecimal = "NumpadDecimal", e.NumpadDivide = "NumpadDivide", e.NumpadEnter = "NumpadEnter", e.NumpadEqual = "NumpadEqual", e.NumpadHash = "NumpadHash", e.NumpadMemoryAdd = "NumpadMemoryAdd", e.NumpadMemoryClear = "NumpadMemoryClear", e.NumpadMemoryRecall = "NumpadMemoryRecall", e.NumpadMemoryStore = "NumpadMemoryStore", e.NumpadMemorySubtract = "NumpadMemorySubtract", e.NumpadMultiply = "NumpadMultiply", e.NumpadParenLeft = "NumpadParenLeft", e.NumpadParenRight = "NumpadParenRight", e.NumpadStar = "NumpadStar", e.NumpadSubtract = "NumpadSubtract", e.Escape = "Escape", e.F1 = "F1", e.F2 = "F2", e.F3 = "F3", e.F4 = "F4", e.F5 = "F5", e.F6 = "F6", e.F7 = "F7", e.F8 = "F8", e.F9 = "F9", e.F10 = "F10", e.F11 = "F11", e.F12 = "F12", e.Fn = "Fn", e.FnLock = "FnLock", e.PrintScreen = "PrintScreen", e.ScrollLock = "ScrollLock", e.Pause = "Pause", e.BrowserBack = "BrowserBack", e.BrowserFavorites = "BrowserFavorites", e.BrowserForward = "BrowserForward", e.BrowserHome = "BrowserHome", e.BrowserRefresh = "BrowserRefresh", e.BrowserSearch = "BrowserSearch", e.BrowserStop = "BrowserStop", e.Eject = "Eject", e.LaunchApp1 = "LaunchApp1", e.LaunchApp2 = "LaunchApp2", e.LaunchMail = "LaunchMail", e.MediaPlayPause = "MediaPlayPause", e.MediaSelect = "MediaSelect", e.MediaStop = "MediaStop", e.MediaTrackNext = "MediaTrackNext", e.MediaTrackPrevious = "MediaTrackPrevious", e.Power = "Power", e.Sleep = "Sleep", e.AudioVolumeDown = "AudioVolumeDown", e.AudioVolumeMute = "AudioVolumeMute", e.AudioVolumeUp = "AudioVolumeUp", e.WakeUp = "WakeUp", e.Hyper = "Hyper", e.Super = "Super", e.Turbo = "Turbo", e.Abort = "Abort", e.Resume = "Resume", e.Suspend = "Suspend", e.Again = "Again", e.Copy = "Copy", e.Cut = "Cut", e.Find = "Find", e.Open = "Open", e.Paste = "Paste", e.Props = "Props", e.Select = "Select", e.Undo = "Undo", e.Hiragana = "Hiragana", e.Katakana = "Katakana", e.Unidentified = "Unidentified", e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ConfigureScrcpy = void 0; var r = n(0); n(61); var i = r.__importDefault(n(5)), o = n(16), a = r.__importDefault(n(3)), s = r.__importDefault(n(1)), u = n(18), c = n(29), l = r.__importDefault(n(6)), d = n(31), f = n(19), h = n(32), p = function (e) { function t(t, n, i) { var a = e.call(this, i) || this; return a.tracker = t, a.statusText = "", a.connectionCount = 0, a.onEncoders = function (e) { for (var t, n = a.encoderSelectElement || document.createElement("select"); t = n.firstChild;)n.removeChild(t); e.unshift(""), e.forEach((function (e) { var t = document.createElement("option"); t.setAttribute("value", e), t.innerText = e, n.appendChild(t) })), a.encoderSelectElement = n }, a.onDisplayInfo = function (e) { var t; a.statusText = "Ready", a.updateStatus(), null === (t = a.dialogContainer) || void 0 === t || t.classList.add("ready"); for (var n, r = a.displayIdSelectElement || document.createElement("select"); n = r.firstChild;)r.removeChild(n); var i = -1; if (e.forEach((function (e, t) { var n = e.displayInfo, o = n.displayId, s = n.size, c = document.createElement("option"); c.setAttribute("value", o.toString()), c.innerText = "ID: " + o + "; " + s.width + "x" + s.height, r.appendChild(c), (a.displayInfo && a.displayInfo.displayId === o || !a.displayInfo && o === u.DisplayInfo.DEFAULT_DISPLAY) && (i = t) })), i > -1) { r.selectedIndex = i; var o = e[i], s = o.videoSettings, c = o.connectionCount, l = o.displayInfo; a.displayInfo = l, c > 0 && s ? a.fillInputsFromVideoSettings(s, !1) : a.updateVideoSettingsForPlayer(), a.connectionCount = c, a.updateStatus() } a.displayIdSelectElement = r, a.dialogBody && (a.dialogBody.classList.remove("hidden"), a.dialogBody.classList.add("visible")) }, a.onConnected = function () { a.statusText = "Waiting for info...", a.updateStatus(), a.okButton && (a.okButton.disabled = !1) }, a.onDisconnected = function () { a.statusText = "Disconnected", a.updateStatus(), a.okButton && (a.okButton.disabled = !0), a.dialogBody && (a.dialogBody.classList.remove("visible"), a.dialogBody.classList.add("hidden")) }, a.onPlayerChange = function () { a.updateVideoSettingsForPlayer() }, a.onDisplayIdChange = function () { var e = a.displayIdSelectElement; if (e && a.streamReceiver) { var t = e.options[e.selectedIndex].value, n = parseInt(t, 10); isNaN(n) || (a.displayInfo = a.streamReceiver.getDisplayInfo(n)), a.updateVideoSettingsForPlayer() } }, a.onBackgroundClick = function (e) { e.target === e.currentTarget && a.cancel() }, a.cancel = function () { a.streamReceiver && (a.detachEventsListeners(a.streamReceiver), a.streamReceiver.stop()), a.emit("closed", { dialog: a, result: !1 }), a.removeUI() }, a.resetSettings = function () { var e = a.getPlayer(); e && a.fillInputsFromVideoSettings(e.getPreferredVideoSetting(), !1) }, a.loadSettings = function () { a.updateVideoSettingsForPlayer() }, a.saveSettings = function () { var e = a.buildVideoSettings(), t = a.getPlayer(); if (e && t) { var n = a.getFitToScreenValue(); t.saveVideoSettings(a.udid, e, n, a.displayInfo) } }, a.openStream = function () { var e = a.buildVideoSettings(); if (e && a.streamReceiver && a.playerName) { var t = a.getFitToScreenValue(); a.detachEventsListeners(a.streamReceiver), a.emit("closed", { dialog: a, result: !0 }), a.removeUI(); var n = o.StreamClientScrcpy.createPlayer(a.playerName, a.udid, a.displayInfo); if (n) { a.setPreviouslyUsedPlayer(a.playerName), n.setVideoSettings(e, t, !1); var i = r.__assign(r.__assign({}, a.params), { udid: a.udid, fitToScreen: t }); o.StreamClientScrcpy.start(i, a.streamReceiver, n, t, e), a.streamReceiver.triggerInitialInfoEvents() } } }, a.udid = n.udid, a.escapedUdid = s.default.escapeUdid(a.udid), a.playerStorageKey = "configure_stream::" + a.escapedUdid + "::player", a.deviceName = n["ro.product.model"], a.TAG = "ConfigureScrcpy[" + a.udid + "]", a.createStreamReceiver(i), a.setTitle(a.deviceName + ". Configure stream"), a.background = a.createUI(), a } return r.__extends(t, e), t.prototype.getTracker = function () { return this.tracker }, t.prototype.createStreamReceiver = function (e) { this.streamReceiver && (this.detachEventsListeners(this.streamReceiver), this.streamReceiver.stop()), this.streamReceiver = new h.StreamReceiverScrcpy(e), this.attachEventsListeners(this.streamReceiver) }, t.prototype.attachEventsListeners = function (e) { e.on("encoders", this.onEncoders), e.on("displayInfo", this.onDisplayInfo), e.on("connected", this.onConnected), e.on("disconnected", this.onDisconnected) }, t.prototype.detachEventsListeners = function (e) { e.off("encoders", this.onEncoders), e.off("displayInfo", this.onDisplayInfo), e.off("connected", this.onConnected), e.off("disconnected", this.onDisconnected) }, t.prototype.updateStatus = function () { if (this.connectionStatusElement) { var e = this.statusText; this.connectionCount && (e = e + ". Other clients: " + this.connectionCount + "."), this.connectionStatusElement.innerText = e } }, t.prototype.getPlayer = function () { if (this.playerSelectElement) { var e = this.playerSelectElement.options[this.playerSelectElement.selectedIndex].value; return o.StreamClientScrcpy.getPlayers().find((function (t) { return t.playerFullName === e })) } }, t.prototype.updateVideoSettingsForPlayer = function () { var e = this.getPlayer(); if (e) { this.playerName = e.playerFullName; var t = e.loadVideoSettings(this.udid, this.displayInfo), n = e.getFitToScreenStatus(this.udid, this.displayInfo); this.fillInputsFromVideoSettings(t, n) } }, t.prototype.getBasicInput = function (e) { var t = document.getElementById(e + "_" + this.escapedUdid); return t || null }, t.prototype.fillInputsFromVideoSettings = function (e, t) { if (this.displayInfo && this.displayInfo.displayId !== e.displayId && console.error(this.TAG, "Display id from VideoSettings and DisplayInfo don't match"), this.fillBasicInput({ id: "bitrate" }, e), this.fillBasicInput({ id: "maxFps" }, e), this.fillBasicInput({ id: "iFrameInterval" }, e), this.fillBasicInput({ id: "codecOptions" }, e), e.bounds) { var n = e.bounds, r = n.width, i = n.height, o = this.getBasicInput("maxWidth"); o && (o.value = r.toString(10)); var a = this.getBasicInput("maxHeight"); a && (a.value = i.toString(10)) } if (this.encoderSelectElement) { var s = e.encoderName || "", u = Array.from(this.encoderSelectElement.options).find((function (e) { return e.value === s })); u && (this.encoderSelectElement.selectedIndex = u.index) } this.fitToScreenCheckbox && (this.fitToScreenCheckbox.checked = t, this.onFitToScreenChanged(t)) }, t.prototype.onFitToScreenChanged = function (e) { var t = this.getBasicInput("maxHeight"), n = this.getBasicInput("maxWidth"); if (this.fitToScreenCheckbox && t && n) if (t.disabled = n.disabled = e, e) t.setAttribute(f.Attribute.VALUE, t.value), t.value = "", n.setAttribute(f.Attribute.VALUE, n.value), n.value = ""; else { var r = t.getAttribute(f.Attribute.VALUE); "string" == typeof r && (t.value = r, t.removeAttribute(f.Attribute.VALUE)); var i = n.getAttribute(f.Attribute.VALUE); "string" == typeof i && (n.value = i, n.removeAttribute(f.Attribute.VALUE)) } }, t.prototype.fillBasicInput = function (e, t) { var n = this.getBasicInput(e.id), r = t[e.id]; n && (void 0 !== r && "-" !== r && 0 !== r && null !== r ? (n.value = r.toString(10), "range" === n.getAttribute("type") && n.dispatchEvent(new Event("input"))) : n.value = "") }, t.prototype.appendBasicInput = function (e, t) { var n = document.createElement("label"); n.classList.add("label"), n.innerText = t.label + ":", n.id = "label_" + t.id + "_" + this.escapedUdid, e.appendChild(n); var r = document.createElement("input"); r.classList.add("input"), r.id = n.htmlFor = t.id + "_" + this.escapedUdid; var i = t.range; return i && (n.setAttribute("title", t.label), r.oninput = function () { var e = i.formatter ? i.formatter(parseInt(r.value, 10)) : r.value; n.innerText = t.label + " (" + e + "):" }, r.setAttribute("type", "range"), r.setAttribute("max", i.max.toString()), r.setAttribute("min", i.min.toString()), r.setAttribute("step", i.step.toString())), e.appendChild(r), r }, t.prototype.getNumberValueFromInput = function (e) { var t = document.getElementById(e + "_" + this.escapedUdid).value; return parseInt(t, 10) }, t.prototype.getStringValueFromInput = function (e) { return document.getElementById(e + "_" + this.escapedUdid).value }, t.prototype.getValueFromSelect = function (e) { var t = document.getElementById(e + "_" + this.escapedUdid); return t.options[t.selectedIndex].value }, t.prototype.buildVideoSettings = function () { try { var e = this.getNumberValueFromInput("bitrate"), t = this.getNumberValueFromInput("maxFps"), n = this.getNumberValueFromInput("iFrameInterval"), r = this.getNumberValueFromInput("maxWidth"), o = this.getNumberValueFromInput("maxHeight"), s = this.getNumberValueFromInput("displayId"), u = this.getStringValueFromInput("codecOptions") || void 0, c = void 0; !isNaN(r) && !isNaN(o) && r && o && (c = new a.default(r, o)); var l = this.getValueFromSelect("encoderName") || void 0; return new i.default({ bitrate: e, bounds: c, maxFps: t, iFrameInterval: n, displayId: s, codecOptions: u, encoderName: l }) } catch (e) { return console.error(this.TAG, e.message), null } }, t.prototype.getFitToScreenValue = function () { return !!this.fitToScreenCheckbox && this.fitToScreenCheckbox.checked }, t.prototype.getPreviouslyUsedPlayer = function () { if (!window.localStorage) return ""; var e = window.localStorage.getItem(this.playerStorageKey); return e || "" }, t.prototype.setPreviouslyUsedPlayer = function (e) { window.localStorage && window.localStorage.setItem(this.playerStorageKey, e) }, t.prototype.createUI = function () { var e = this, t = "configureDialog", n = document.createElement("div"); n.classList.add("dialog-background", t); var r = this.dialogContainer = document.createElement("div"); r.classList.add("dialog-container", t); var i = document.createElement("div"); i.classList.add("dialog-header", t, "control-wrapper"); var a = new c.ToolBoxButton("Back", l.default.Icon.ARROW_BACK); a.addEventListener("click", (function () { e.cancel() })), a.getAllElements().forEach((function (e) { i.appendChild(e) })); var u = document.createElement("span"); u.classList.add("dialog-title", "main-title"), u.innerText = this.deviceName, i.appendChild(u); var f = this.dialogBody = document.createElement("div"); f.classList.add("dialog-body", "dialog-block", t, "hidden"); var h = document.createElement("div"); h.classList.add("controls"); var p = document.createElement("label"); p.classList.add("label"), p.innerText = "Player:", h.appendChild(p); var E = this.playerSelectElement = document.createElement("select"); E.classList.add("input"), E.id = p.htmlFor = "player_" + this.escapedUdid, h.appendChild(E), f.appendChild(h); var v = this.getPreviouslyUsedPlayer(); o.StreamClientScrcpy.getPlayers().forEach((function (e, t) { var n = e.playerFullName, r = document.createElement("option"); r.setAttribute("value", n), r.innerText = n, E.appendChild(r), n === v && (E.selectedIndex = t) })), E.onchange = this.onPlayerChange, this.updateVideoSettingsForPlayer(); var m = document.createElement("div"); m.classList.add("controls", "control-wrapper"); var y = document.createElement("label"); y.classList.add("label"), y.innerText = "Display:", m.appendChild(y), this.displayIdSelectElement || (this.displayIdSelectElement = document.createElement("select")), m.appendChild(this.displayIdSelectElement), this.displayIdSelectElement.classList.add("input"), this.displayIdSelectElement.id = y.htmlFor = "displayId_" + this.escapedUdid, this.displayIdSelectElement.onchange = this.onDisplayIdChange, this.appendBasicInput(m, { label: "Bitrate", id: "bitrate", range: { min: 524288, max: 8388608, step: 524288, formatter: s.default.prettyBytes } }), this.appendBasicInput(m, { label: "Max FPS", id: "maxFps", range: { min: 1, max: 60, step: 1 } }), this.appendBasicInput(m, { label: "I-Frame interval", id: "iFrameInterval" }); var _ = document.createElement("label"); _.innerText = "Fit to screen", _.classList.add("label"), m.appendChild(_); var g = new d.ToolBoxCheckbox("Fit to screen", { off: l.default.Icon.TOGGLE_OFF, on: l.default.Icon.TOGGLE_ON }, "fit_to_screen"); g.getAllElements().forEach((function (t) { m.appendChild(t), t instanceof HTMLLabelElement && (_.htmlFor = t.htmlFor, t.classList.add("input")), t instanceof HTMLInputElement && (e.fitToScreenCheckbox = t) })), g.addEventListener("click", (function (t, n) { var r = n.getElement(); e.onFitToScreenChanged(r.checked) })), this.appendBasicInput(m, { label: "Max width", id: "maxWidth" }), this.appendBasicInput(m, { label: "Max height", id: "maxHeight" }), this.appendBasicInput(m, { label: "Codec options", id: "codecOptions" }); var S = document.createElement("label"); S.classList.add("label"), S.innerText = "Encoder:", m.appendChild(S), this.encoderSelectElement || (this.encoderSelectElement = document.createElement("select")), m.appendChild(this.encoderSelectElement), this.encoderSelectElement.classList.add("input"), this.encoderSelectElement.id = S.htmlFor = "encoderName_" + this.escapedUdid, f.appendChild(m); var C = document.createElement("div"); C.classList.add("controls"); var O = this.resetSettingsButton = document.createElement("button"); O.classList.add("button"), O.innerText = "Reset settings", O.addEventListener("click", this.resetSettings), C.appendChild(O); var T = this.loadSettingsButton = document.createElement("button"); T.classList.add("button"), T.innerText = "Load settings", T.addEventListener("click", this.loadSettings), C.appendChild(T); var D = this.saveSettingsButton = document.createElement("button"); D.classList.add("button"), D.innerText = "Save settings", D.addEventListener("click", this.saveSettings), C.appendChild(D), f.appendChild(C); var I = document.createElement("div"); I.classList.add("dialog-footer", "dialog-block", t); var w = document.createElement("span"); w.classList.add("subtitle"), this.connectionStatusElement = w, I.appendChild(w), this.statusText = "Connecting...", this.updateStatus(); var b = this.okButton = document.createElement("button"); return b.innerText = "Open", b.disabled = !0, b.addEventListener("click", this.openStream), I.appendChild(b), f.appendChild(I), r.appendChild(i), r.appendChild(f), r.appendChild(I), n.appendChild(r), n.addEventListener("click", this.onBackgroundClick), document.body.appendChild(n), n }, t.prototype.removeUI = function () { var e, t, n, r; document.body.removeChild(this.background), null === (e = this.okButton) || void 0 === e || e.removeEventListener("click", this.openStream), null === (t = this.resetSettingsButton) || void 0 === t || t.removeEventListener("click", this.resetSettings), null === (n = this.loadSettingsButton) || void 0 === n || n.removeEventListener("click", this.loadSettings), null === (r = this.saveSettingsButton) || void 0 === r || r.removeEventListener("click", this.saveSettings), this.background.removeEventListener("click", this.onBackgroundClick) }, t }(n(7).BaseClient); t.ConfigureScrcpy = p }, function (e, t, n) { }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="var(--svg-button-fill)"><path d="M40 10H8c-2.21 0-3.98 1.79-3.98 4L4 34c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V14c0-2.21-1.79-4-4-4zm-18 6h4v4h-4v-4zm0 6h4v4h-4v-4zm-6-6h4v4h-4v-4zm0 6h4v4h-4v-4zm-2 4h-4v-4h4v4zm0-6h-4v-4h4v4zm18 14H16v-4h16v4zm0-8h-4v-4h4v4zm0-6h-4v-4h4v4zm6 6h-4v-4h4v4zm0-6h-4v-4h4v4z"></path><path d="M0 0h48v48H0zm0 0h48v48H0z" fill="none"></path></svg>' }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="var(--svg-button-fill)"><path d="M0 0h48v48H0z" fill="none"></path><path d="M12 20c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm24 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm-12 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path></svg>' }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="var(--svg-button-fill)"><circle cx="24" cy="24" r="6.4"></circle><path d="M18 4l-3.66 4H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4h-6.34L30 4H18zm6 30c-5.52 0-10-4.48-10-10s4.48-10 10-10 10 4.48 10 10-4.48 10-10 10z"></path><path d="M0 0h48v48H0z" fill="none"></path></svg>' }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"></path><path d="M26 6h-4v20h4V6zm9.67 4.33l-2.83 2.83C35.98 15.73 38 19.62 38 24c0 7.73-6.27 14-14 14s-14-6.27-14-14c0-4.38 2.02-8.27 5.16-10.84l-2.83-2.83C8.47 13.63 6 18.52 6 24c0 9.94 8.06 18 18 18s18-8.06 18-18c0-5.48-2.47-10.37-6.33-13.67z" fill="var(--svg-button-fill)" stroke="var(--svg-button-fill)"></path></svg>' }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z" fill="var(--svg-button-fill)" stroke="var(--svg-button-fill)"></path><path d="M0 0h48v48H0z" fill="none"></path></svg>' }, function (e, t) { e.exports = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z" fill="var(--svg-button-fill)" stroke="var(--svg-button-fill)"></path><path d="M0 0h48v48H0z" fill="none"></path></svg>' }, function (e, t) { e.exports = '<svg viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>Artboard 1</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="Artboard-1" sketch:type="MSArtboardGroup"><g id="System_Back" sketch:type="MSLayerGroup"><g id="Page-1" sketch:type="MSShapeGroup"><g id="System_Back"><g id="Rectangle-118-+-back-12-Copy-11"><rect id="Rectangle-118" x="0" y="0" width="48" height="48"></rect><path d="M36.7088473,10.9494765 L36.7088478,37.6349688 C36.7088478,39.4039498 35.4820844,40.0949115 33.9646508,39.1757647 L12.1373795,25.9544497 C10.6218013,25.0364267 10.6199459,23.5491414 12.1373794,22.6299946 L33.9646503,9.40868054 C35.4802284,8.49065763 36.7088473,9.16835511 36.7088473,10.9494765 Z M33.5088482,13.4305237 L33.5088482,35.1305245 L15.5088482,24.2805241 L33.5088482,13.4305237 Z" id="Shape" fill="var(--svg-button-fill)"></path></g></g></g></g></g></g></svg>' }, function (e, t) { e.exports = '<svg viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>System_Home</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="System_Home" sketch:type="MSArtboardGroup"><g id="Rectangle-119-+-home-12-Copy-11" sketch:type="MSLayerGroup"><rect id="Rectangle-119" sketch:type="MSShapeGroup" x="0" y="0" width="48" height="48"></rect><path d="M24,35.2 L24,35.2 C30.1855892,35.2 35.2,30.1855892 35.2,24 C35.2,17.8144108 30.1855892,12.8 24,12.8 C17.8144108,12.8 12.8,17.8144108 12.8,24 C12.8,30.1855892 17.8144108,35.2 24,35.2 L24,35.2 Z M24,38.4 L24,38.4 C16.0470996,38.4 9.6,31.9529004 9.6,24 C9.6,16.0470996 16.0470996,9.6 24,9.6 C31.9529004,9.6 38.4,16.0470996 38.4,24 C38.4,31.9529004 31.9529004,38.4 24,38.4 L24,38.4 Z" id="Shape" fill="var(--svg-button-fill)" sketch:type="MSShapeGroup"></path></g></g></g></svg>' }, function (e, t) { e.exports = '<svg viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>System_Overview</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="System_Overview" sketch:type="MSArtboardGroup"><g id="Rectangle-120-+-recent-12-Copy-11" sketch:type="MSLayerGroup"><rect id="Rectangle-120" sketch:type="MSShapeGroup" x="0" y="0" width="48" height="48"></rect><path d="M12.7921429,12.8 L12.7921429,12.8 C12.7959945,12.8 12.8,12.7959954 12.8,12.7921429 L12.8,35.2078571 C12.8,35.2040055 12.7959954,35.2 12.7921429,35.2 L35.2078571,35.2 C35.2040055,35.2 35.2,35.2040046 35.2,35.2078571 L35.2,12.7921429 C35.2,12.7959945 35.2040046,12.8 35.2078571,12.8 L12.7921429,12.8 Z M12.7921429,9.6 L12.7921429,9.6 L35.2078571,9.6 C36.9718035,9.6 38.4,11.029171 38.4,12.7921429 L38.4,35.2078571 C38.4,36.9718035 36.970829,38.4 35.2078571,38.4 L12.7921429,38.4 C11.0281965,38.4 9.6,36.970829 9.6,35.2078571 L9.6,12.7921429 C9.6,11.0281965 11.029171,9.6 12.7921429,9.6 L12.7921429,9.6 Z" id="Shape" fill="var(--svg-button-fill)" sketch:type="MSShapeGroup"></path></g></g></g></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2C6.47,2 2,6.47 2,12s4.47,10 10,10 10,-4.47 10,-10S17.53,2 12,2zM12,20c-4.41,0 -8,-3.59 -8,-8s3.59,-8 8,-8 8,3.59 8,8 -3.59,8 -8,8zM15.59,7L12,10.59 8.41,7 7,8.41 10.59,12 7,15.59 8.41,17 12,13.41 15.59,17 17,15.59 13.41,12 17,8.41z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2.02c-5.51,0 -9.98,4.47 -9.98,9.98s4.47,9.98 9.98,9.98 9.98,-4.47 9.98,-9.98S17.51,2.02 12,2.02zM12,19.98c-4.4,0 -7.98,-3.58 -7.98,-7.98S7.6,4.02 12,4.02 19.98,7.6 19.98,12 16.4,19.98 12,19.98zM12.75,5l-4.5,8.5h3.14L11.39,19l4.36,-8.5h-3z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.65,6.35C16.2,4.9 14.21,4 12,4c-4.42,0 -7.99,3.58 -7.99,8s3.57,8 7.99,8c3.73,0 6.84,-2.55 7.73,-6h-2.08c-0.82,2.33 -3.04,4 -5.65,4 -3.31,0 -6,-2.69 -6,-6s2.69,-6 6,-6c1.66,0 3.14,0.69 4.22,1.78L13,11h7V4l-2.35,2.35z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.43,12.98c0.04,-0.32 0.07,-0.64 0.07,-0.98 0,-0.34 -0.03,-0.66 -0.07,-0.98l2.11,-1.65c0.19,-0.15 0.24,-0.42 0.12,-0.64l-2,-3.46c-0.09,-0.16 -0.26,-0.25 -0.44,-0.25 -0.06,0 -0.12,0.01 -0.17,0.03l-2.49,1c-0.52,-0.4 -1.08,-0.73 -1.69,-0.98l-0.38,-2.65C14.46,2.18 14.25,2 14,2h-4c-0.25,0 -0.46,0.18 -0.49,0.42l-0.38,2.65c-0.61,0.25 -1.17,0.59 -1.69,0.98l-2.49,-1c-0.06,-0.02 -0.12,-0.03 -0.18,-0.03 -0.17,0 -0.34,0.09 -0.43,0.25l-2,3.46c-0.13,0.22 -0.07,0.49 0.12,0.64l2.11,1.65c-0.04,0.32 -0.07,0.65 -0.07,0.98 0,0.33 0.03,0.66 0.07,0.98l-2.11,1.65c-0.19,0.15 -0.24,0.42 -0.12,0.64l2,3.46c0.09,0.16 0.26,0.25 0.44,0.25 0.06,0 0.12,-0.01 0.17,-0.03l2.49,-1c0.52,0.4 1.08,0.73 1.69,0.98l0.38,2.65c0.03,0.24 0.24,0.42 0.49,0.42h4c0.25,0 0.46,-0.18 0.49,-0.42l0.38,-2.65c0.61,-0.25 1.17,-0.59 1.69,-0.98l2.49,1c0.06,0.02 0.12,0.03 0.18,0.03 0.17,0 0.34,-0.09 0.43,-0.25l2,-3.46c0.12,-0.22 0.07,-0.49 -0.12,-0.64l-2.11,-1.65zM17.45,11.27c0.04,0.31 0.05,0.52 0.05,0.73 0,0.21 -0.02,0.43 -0.05,0.73l-0.14,1.13 0.89,0.7 1.08,0.84 -0.7,1.21 -1.27,-0.51 -1.04,-0.42 -0.9,0.68c-0.43,0.32 -0.84,0.56 -1.25,0.73l-1.06,0.43 -0.16,1.13 -0.2,1.35h-1.4l-0.19,-1.35 -0.16,-1.13 -1.06,-0.43c-0.43,-0.18 -0.83,-0.41 -1.23,-0.71l-0.91,-0.7 -1.06,0.43 -1.27,0.51 -0.7,-1.21 1.08,-0.84 0.89,-0.7 -0.14,-1.13c-0.03,-0.31 -0.05,-0.54 -0.05,-0.74s0.02,-0.43 0.05,-0.73l0.14,-1.13 -0.89,-0.7 -1.08,-0.84 0.7,-1.21 1.27,0.51 1.04,0.42 0.9,-0.68c0.43,-0.32 0.84,-0.56 1.25,-0.73l1.06,-0.43 0.16,-1.13 0.2,-1.35h1.39l0.19,1.35 0.16,1.13 1.06,0.43c0.43,0.18 0.83,0.41 1.23,0.71l0.91,0.7 1.06,-0.43 1.27,-0.51 0.7,1.21 -1.07,0.85 -0.89,0.7 0.14,1.13zM12,8c-2.21,0 -4,1.79 -4,4s1.79,4 4,4 4,-1.79 4,-4 -1.79,-4 -4,-4zM12,14c-1.1,0 -2,-0.9 -2,-2s0.9,-2 2,-2 2,0.9 2,2 -0.9,2 -2,2z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,18h18v-2L3,16v2zM3,13h18v-2L3,11v2zM3,6v2h18L21,6L3,6z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11H7.83l5.59,-5.59L12,4l-8,8 8,8 1.41,-1.41L7.83,13H20v-2z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17,7L7,7c-2.76,0 -5,2.24 -5,5s2.24,5 5,5h10c2.76,0 5,-2.24 5,-5s-2.24,-5 -5,-5zM17,15c-1.66,0 -3,-1.34 -3,-3s1.34,-3 3,-3 3,1.34 3,3 -1.34,3 -3,3z"></path></svg>' }, function (e, t) { e.exports = '<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17,7H7c-2.76,0 -5,2.24 -5,5s2.24,5 5,5h10c2.76,0 5,-2.24 5,-5s-2.24,-5 -5,-5zM7,15c-1.66,0 -3,-1.34 -3,-3s1.34,-3 3,-3 3,1.34 3,3 -1.34,3 -3,3z"></path></svg>' }, function (e, t, n) { "use strict"; (function (e, r, i) { Object.defineProperty(t, "__esModule", { value: !0 }), t.Multiplexer = void 0; var o = n(0), a = n(8), s = n(82), u = n(35), c = n(13), l = n(36), d = n(83), f = n(84), h = o.__importDefault(n(1)), p = function (t) { function n(r, i, o) { void 0 === i && (i = 0); var a = t.call(this) || this; a.ws = r, a._id = i, a.CONNECTING = 0, a.OPEN = 1, a.CLOSING = 2, a.CLOSED = 3, a.binaryType = "blob", a.channels = new Map, a.nextId = 0, a.maxId = 4294967296, a.storage = [], a.emptyTimer = null, a.onclose = null, a.onerror = null, a.onmessage = null, a.onopen = null, a.url = "", a.readyState = a.CONNECTING, 0 === a._id && (r.binaryType = "arraybuffer", a.readyState = a.ws.readyState), a.messageEmitter = o || r; var c = function (e) { a.readyState = a.ws.readyState, a.dispatchEvent(e) }, l = function (e) { a.readyState = a.ws.readyState, a.dispatchEvent(e), a.channels.clear() }, p = function (e) { a.readyState = a.ws.readyState, a.dispatchEvent(e), a.channels.clear() }, E = function (t) { var n = t.data, r = s.Message.parse(n); switch (r.type) { case u.MessageType.CreateChannel: var i = r.channelId, o = r.data; a.nextId < i && (a.nextId = i); var c = a._createChannel(i, !1); a.emit("channel", { channel: c, data: o }); break; case u.MessageType.RawStringData: var l = a.channels.get(r.channelId); if (l) { c = l.channel; var p = new f.MessageEventClass("message", { data: h.default.utf8ByteArrayToString(e.from(r.data)), lastEventId: t.lastEventId, origin: t.origin, source: t.source }); c.dispatchEvent(p) } else console.error("Channel with id (" + r.channelId + ") not found"); break; case u.MessageType.RawBinaryData: var E = a.channels.get(r.channelId); if (E) { c = E.channel, p = new f.MessageEventClass("message", { data: r.data, lastEventId: t.lastEventId, origin: t.origin, source: t.source }); c.dispatchEvent(p) } else console.error("Channel with id (" + r.channelId + ") not found"); break; case u.MessageType.Data: var v = a.channels.get(r.channelId); if (v) { var m = v.emitter; p = new f.MessageEventClass("message", { data: r.data, lastEventId: t.lastEventId, origin: t.origin, source: t.source }); m.dispatchEvent(p) } else console.error("Channel with id (" + r.channelId + ") not found"); break; case u.MessageType.CloseChannel: var y = a.channels.get(r.channelId); if (y) { (c = y.channel).readyState = c.CLOSING; try { c.dispatchEvent(r.toCloseEvent()) } finally { c.readyState = c.CLOSED } } else console.error("Channel with id (" + r.channelId + ") not found"); break; default: var _ = new Error("Unsupported message type: " + r.type); a.dispatchEvent(new d.ErrorEventClass("error", { error: _ })) } }, v = function () { if (a.storage.length) { var e = a.ws; e instanceof n ? a.storage.forEach((function (t) { return e.sendData(t) })) : a.storage.forEach((function (t) { return e.send(t) })), a.storage.length = 0 } }, m = function () { r.removeEventListener("open", c), r.removeEventListener("error", p), r.removeEventListener("close", l), a.messageEmitter.removeEventListener("message", E), a.off("close", m), a.off("open", v) }; return r.addEventListener("open", c), r.addEventListener("error", p), r.addEventListener("close", l), a.messageEmitter.addEventListener("message", E), a.on("close", m), a.on("open", v), a.scheduleEmptyEvent(), a } return o.__extends(n, t), n.wrap = function (e) { return new n(e) }, Object.defineProperty(n.prototype, "bufferedAmount", { get: function () { return 0 }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, "extensions", { get: function () { return "" }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, "protocol", { get: function () { return "" }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, "id", { get: function () { return this._id }, enumerable: !1, configurable: !0 }), n.prototype.scheduleEmptyEvent = function () { var e = this; this.emptyTimer = r((function () { e.emptyTimer = null, e.emit("empty", e) })) }, n.prototype.clearEmptyEvent = function () { this.emptyTimer && (i(this.emptyTimer), this.emptyTimer = null) }, n.prototype.close = function (e, t) { if (void 0 === e && (e = 1e3), this.readyState !== this.CLOSED && this.readyState !== this.CLOSING) if (this._id) { this.readyState = this.CLOSING; try { var r = s.Message.fromCloseEvent(this._id, e, t).toBuffer(); this.ws instanceof n ? this.ws.sendData(r) : this.ws.send(r), this.emit("close", new l.CloseEventClass("close", { code: e, reason: t })) } finally { this.readyState = this.CLOSED } } else this.ws.close(e, t) }, n.prototype.send = function (t) { this.ws instanceof n && (t = "string" == typeof t ? s.Message.createBuffer(u.MessageType.RawStringData, this._id, e.from(t)) : s.Message.createBuffer(u.MessageType.RawBinaryData, this._id, e.from(t))), this._send(t) }, n.prototype.sendData = function (t) { this.ws instanceof n && (t = s.Message.createBuffer(u.MessageType.Data, this._id, e.from(t))), this._send(t) }, n.prototype._send = function (e) { var t = this.readyState; if (t === this.OPEN) this.ws instanceof n ? this.ws.sendData(e) : this.ws.send(e); else { if (t !== this.ws.CONNECTING) throw Error("Socket is already in CLOSING or CLOSED state."); this.storage.push(e) } }, n.prototype._createChannel = function (e, t) { var i = this, o = new a.TypedEmitter, s = new n(this, e, o); return this.channels.set(e, { channel: s, emitter: o }), t ? this.readyState === this.OPEN && r((function () { s.readyState = i.OPEN, s.dispatchEvent(new c.EventClass("open")) })) : s.readyState = this.readyState, s.addEventListener("close", (function () { i.channels.delete(e), i.channels.size || i.scheduleEmptyEvent() })), this.clearEmptyEvent(), s }, n.prototype.createChannel = function (e) { if (this.readyState === this.CLOSING || this.readyState === this.CLOSED) throw Error("Incorrect socket state"); var t = this.getNextId(), n = this._createChannel(t, !0); return this.sendData(s.Message.createBuffer(u.MessageType.CreateChannel, t, e)), n }, n.prototype.getNextId = function () { for (var e = !1; this.channels.has(++this.nextId);)if (this.nextId === this.maxId) { if (e) throw Error("No available id"); this.nextId = 0, e = !0 } return this.nextId }, n.prototype.dispatchEvent = function (e) { return "close" === e.type && "function" == typeof this.onclose && Reflect.apply(this.onclose, this, [e]), "open" === e.type && "function" == typeof this.onopen && Reflect.apply(this.onopen, this, [e]), "message" === e.type && "function" == typeof this.onmessage && Reflect.apply(this.onmessage, this, [e]), "error" === e.type && "function" == typeof this.onerror && Reflect.apply(this.onerror, this, [e]), t.prototype.dispatchEvent.call(this, e) }, n }(a.TypedEmitter); t.Multiplexer = p }).call(this, n(2).Buffer, n(34).setImmediate, n(34).clearImmediate) }, function (e, t, n) { (function (e, t) { !function (e, n) { "use strict"; if (!e.setImmediate) { var r, i, o, a, s, u = 1, c = {}, l = !1, d = e.document, f = Object.getPrototypeOf && Object.getPrototypeOf(e); f = f && f.setTimeout ? f : e, "[object process]" === {}.toString.call(e.process) ? r = function (e) { t.nextTick((function () { p(e) })) } : !function () { if (e.postMessage && !e.importScripts) { var t = !0, n = e.onmessage; return e.onmessage = function () { t = !1 }, e.postMessage("", "*"), e.onmessage = n, t } }() ? e.MessageChannel ? ((o = new MessageChannel).port1.onmessage = function (e) { p(e.data) }, r = function (e) { o.port2.postMessage(e) }) : d && "onreadystatechange" in d.createElement("script") ? (i = d.documentElement, r = function (e) { var t = d.createElement("script"); t.onreadystatechange = function () { p(e), t.onreadystatechange = null, i.removeChild(t), t = null }, i.appendChild(t) }) : r = function (e) { setTimeout(p, 0, e) } : (a = "setImmediate$" + Math.random() + "$", s = function (t) { t.source === e && "string" == typeof t.data && 0 === t.data.indexOf(a) && p(+t.data.slice(a.length)) }, e.addEventListener ? e.addEventListener("message", s, !1) : e.attachEvent("onmessage", s), r = function (t) { e.postMessage(a + t, "*") }), f.setImmediate = function (e) { "function" != typeof e && (e = new Function("" + e)); for (var t = new Array(arguments.length - 1), n = 0; n < t.length; n++)t[n] = arguments[n + 1]; var i = { callback: e, args: t }; return c[u] = i, r(u), u++ }, f.clearImmediate = h } function h(e) { delete c[e] } function p(e) { if (l) setTimeout(p, 0, e); else { var t = c[e]; if (t) { l = !0; try { !function (e) { var t = e.callback, n = e.args; switch (n.length) { case 0: t(); break; case 1: t(n[0]); break; case 2: t(n[0], n[1]); break; case 3: t(n[0], n[1], n[2]); break; default: t.apply(void 0, n) } }(t) } finally { h(e), l = !1 } } } } }("undefined" == typeof self ? void 0 === e ? this : e : self) }).call(this, n(17), n(81)) }, function (e, t) { var n, r, i = e.exports = {}; function o() { throw new Error("setTimeout has not been defined") } function a() { throw new Error("clearTimeout has not been defined") } function s(e) { if (n === setTimeout) return setTimeout(e, 0); if ((n === o || !n) && setTimeout) return n = setTimeout, setTimeout(e, 0); try { return n(e, 0) } catch (t) { try { return n.call(null, e, 0) } catch (t) { return n.call(this, e, 0) } } } !function () { try { n = "function" == typeof setTimeout ? setTimeout : o } catch (e) { n = o } try { r = "function" == typeof clearTimeout ? clearTimeout : a } catch (e) { r = a } }(); var u, c = [], l = !1, d = -1; function f() { l && u && (l = !1, u.length ? c = u.concat(c) : d = -1, c.length && h()) } function h() { if (!l) { var e = s(f); l = !0; for (var t = c.length; t;) { for (u = c, c = []; ++d < t;)u && u[d].run(); d = -1, t = c.length } u = null, l = !1, function (e) { if (r === clearTimeout) return clearTimeout(e); if ((r === a || !r) && clearTimeout) return r = clearTimeout, clearTimeout(e); try { r(e) } catch (t) { try { return r.call(null, e) } catch (t) { return r.call(this, e) } } }(e) } } function p(e, t) { this.fun = e, this.array = t } function E() { } i.nextTick = function (e) { var t = new Array(arguments.length - 1); if (arguments.length > 1) for (var n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; c.push(new p(e, t)), 1 !== c.length || l || s(h) }, p.prototype.run = function () { this.fun.apply(null, this.array) }, i.title = "browser", i.browser = !0, i.env = {}, i.argv = [], i.version = "", i.versions = {}, i.on = E, i.addListener = E, i.once = E, i.off = E, i.removeListener = E, i.removeAllListeners = E, i.emit = E, i.prependListener = E, i.prependOnceListener = E, i.listeners = function (e) { return [] }, i.binding = function (e) { throw new Error("process.binding is not supported") }, i.cwd = function () { return "/" }, i.chdir = function (e) { throw new Error("process.chdir is not supported") }, i.umask = function () { return 0 } }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.Message = void 0; var r = n(0), i = n(35), o = r.__importDefault(n(1)), a = n(36), s = function () { function t(e, t, n) { this.type = e, this.channelId = t, this.data = n } return t.parse = function (n) { var r = new e(n); return new t(r.readUInt8(0), r.readUInt32LE(1), n.slice(5)) }, t.fromCloseEvent = function (n, r, a) { var s = a ? o.default.stringToUtf8ByteArray(a) : e.alloc(0), u = e.alloc(6 + s.byteLength); return u.writeUInt16LE(r, 0), s.byteLength && (u.writeUInt32LE(s.byteLength, 2), u.set(s, 6)), new t(i.MessageType.CloseChannel, n, u) }, t.createBuffer = function (t, n, r) { var i = e.alloc(5 + (r ? r.byteLength : 0)); return i.writeUInt8(t, 0), i.writeUInt32LE(n, 1), (null == r ? void 0 : r.byteLength) && i.set(e.from(r), 5), i }, t.prototype.toCloseEvent = function () { var t, n; if (this.data && this.data.byteLength) { var r = e.from(this.data); if (t = r.readUInt16LE(0), r.byteLength > 6) { var i = r.readUInt32LE(2); n = o.default.utf8ByteArrayToString(r.slice(6, 6 + i)) } } return new a.CloseEventClass("close", { code: t, reason: n, wasClean: 1e3 === t }) }, t.prototype.toBuffer = function () { return t.createBuffer(this.type, this.channelId, this.data) }, t }(); t.Message = s }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ErrorEventClass = t.ErrorEvent2 = void 0; var r = n(0), i = function (e) { function t(t, n) { var r = void 0 === n ? {} : n, i = r.colno, o = r.error, a = r.filename, s = r.lineno, u = r.message, c = e.call(this, t) || this; return c.error = o, c.colno = i || 0, c.filename = a || "", c.lineno = s || 0, c.message = u || "", c } return r.__extends(t, e), t }(n(13).Event2); t.ErrorEvent2 = i, t.ErrorEventClass = "undefined" != typeof ErrorEvent ? ErrorEvent : i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MessageEventClass = t.MessageEvent2 = void 0; var r = n(0), i = function (e) { function t(t, n) { var i = void 0 === n ? {} : n, o = i.data, a = void 0 === o ? null : o, s = i.origin, u = void 0 === s ? "" : s, c = i.lastEventId, l = void 0 === c ? "" : c, d = i.source, f = void 0 === d ? null : d, h = i.ports, p = void 0 === h ? [] : h, E = e.call(this, t) || this; return E.data = a, E.origin = "" + u, E.lastEventId = "" + l, E.source = f, E.ports = r.__spread(p), E } return r.__extends(t, e), t }(n(13).Event2); t.MessageEvent2 = i, t.MessageEventClass = "undefined" != typeof MessageEvent ? MessageEvent : i }, function (e, t, n) { }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ARGS_STRING = t.SERVER_PROCESS_NAME = t.LOG_LEVEL = t.SERVER_TYPE = t.SERVER_VERSION = t.SERVER_PORT = t.SERVER_PACKAGE = void 0, t.SERVER_PACKAGE = "com.genymobile.scrcpy.Server", t.SERVER_PORT = 8886, t.SERVER_VERSION = "1.19-ws1", t.SERVER_TYPE = "web", t.LOG_LEVEL = "ERROR"; var r = [t.SERVER_VERSION, t.SERVER_TYPE, t.LOG_LEVEL, t.SERVER_PORT, !0]; t.SERVER_PROCESS_NAME = "app_process", t.ARGS_STRING = "/ " + t.SERVER_PACKAGE + " " + r.join(" ") + " 2>&1 > /dev/null" }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.FeaturedInteractionHandler = void 0; var r = n(0), i = n(41), o = r.__importDefault(n(42)), a = n(92), s = function (e) { function t(n, r) { var a = e.call(this, n, t.touchEventsNames, t.keyEventsNames) || this; return a.listener = r, a.storedFromMouseEvent = new Map, a.storedFromTouchEvent = new Map, a.onMouseEnter = function () { a.over = !0 }, a.onMouseLeave = function () { a.lastPosition = void 0, a.over = !1, a.storedFromMouseEvent.forEach((function (e) { a.listener.sendMessage(i.InteractionHandler.createEmulatedMessage(o.default.ACTION_UP, e)) })), a.storedFromMouseEvent.clear(), a.clearCanvas() }, a.tag.addEventListener("mouseleave", a.onMouseLeave), a.tag.addEventListener("mouseenter", a.onMouseEnter), a } return r.__extends(t, e), t.prototype.buildScrollEvent = function (e, n) { var r = [], o = i.InteractionHandler.buildTouchOnClient(e, n); if (o) { var s = e.deltaX > 0 ? -1 : e.deltaX < -0 ? 1 : 0, u = e.deltaY > 0 ? -1 : e.deltaY < -0 ? 1 : 0, c = Date.now(); (!this.lastScrollEvent || c - this.lastScrollEvent.time > t.SCROLL_EVENT_THROTTLING_TIME || this.lastScrollEvent.vScroll !== u || this.lastScrollEvent.hScroll !== s) && (this.lastScrollEvent = { time: c, hScroll: s, vScroll: u }, r.push(new a.ScrollControlMessage(o.touch.position, s, u))) } return r }, t.prototype.onInteraction = function (e) { var t = this, n = this.player.getScreenInfo(); if (n) { var r, i; if (e instanceof MouseEvent) { if (e.target !== this.tag) return; window.WheelEvent && e instanceof WheelEvent ? r = this.buildScrollEvent(e, n) : (i = this.storedFromMouseEvent, r = this.buildTouchEvent(e, n, i)), this.over && (this.lastPosition = e) } else { if (!(window.TouchEvent && e instanceof TouchEvent)) return void console.error("[FeaturedTouchHandler]", "Unsupported event", e); if (e.target !== this.tag) return; i = this.storedFromTouchEvent, r = this.formatTouchEvent(e, n, i) } e.cancelable && e.preventDefault(), e.stopPropagation(), r.forEach((function (e) { t.listener.sendMessage(e) })) } }, t.prototype.onKey = function (e) { if (this.lastPosition) { var t = this.player.getScreenInfo(); if (t) { var n = e.ctrlKey, r = e.shiftKey, o = this.lastPosition, a = o.target, s = o.button, u = o.buttons, c = o.clientY, l = o.clientX, d = { ctrlKey: n, shiftKey: r, type: i.InteractionHandler.SIMULATE_MULTI_TOUCH, target: a, button: s, buttons: u, clientX: l, clientY: c }; this.buildTouchEvent(d, t, new Map) } } }, t.prototype.release = function () { e.prototype.release.call(this), this.tag.removeEventListener("mouseleave", this.onMouseLeave), this.tag.removeEventListener("mouseenter", this.onMouseEnter), this.storedFromMouseEvent.clear() }, t.touchEventsNames = ["touchstart", "touchend", "touchmove", "touchcancel", "mousedown", "mouseup", "mousemove", "wheel"], t.keyEventsNames = ["keydown", "keyup"], t.SCROLL_EVENT_THROTTLING_TIME = 30, t }(i.InteractionHandler); t.FeaturedInteractionHandler = s }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.TouchControlMessage = void 0; var r = n(0), i = n(10), o = function (t) { function n(e, n, r, o, a) { var s = t.call(this, i.ControlMessage.TYPE_TOUCH) || this; return s.action = e, s.pointerId = n, s.position = r, s.pressure = o, s.buttons = a, s } return r.__extends(n, t), n.prototype.toBuffer = function () { var t = new e(n.PAYLOAD_LENGTH + 1), r = 0; return r = t.writeUInt8(this.type, r), r = t.writeUInt8(this.action, r), r = t.writeUInt32BE(0, r), r = t.writeUInt32BE(this.pointerId, r), r = t.writeUInt32BE(this.position.point.x, r), r = t.writeUInt32BE(this.position.point.y, r), r = t.writeUInt16BE(this.position.screenSize.width, r), r = t.writeUInt16BE(this.position.screenSize.height, r), r = t.writeUInt16BE(this.pressure * n.MAX_PRESSURE_VALUE, r), t.writeUInt32BE(this.buttons, r), t }, n.prototype.toString = function () { return "TouchControlMessage{action=" + this.action + ", pointerId=" + this.pointerId + ", position=" + this.position + ", pressure=" + this.pressure + ", buttons=" + this.buttons + "}" }, n.prototype.toJSON = function () { return { type: this.type, action: this.action, pointerId: this.pointerId, position: this.position.toJSON(), pressure: this.pressure, buttons: this.buttons } }, n.PAYLOAD_LENGTH = 28, n.MAX_PRESSURE_VALUE = 65535, n }(i.ControlMessage); t.TouchControlMessage = o }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0).__importDefault(n(23)), i = function () { function e(e, t) { this.point = e, this.screenSize = t } return e.prototype.equals = function (e) { return this === e || null !== e && (this.point.equals(e.point) && this.screenSize.equals(e.screenSize)) }, e.prototype.rotate = function (t) { switch (t) { case 1: return new e(new r.default(this.screenSize.height - this.point.y, this.point.x), this.screenSize.rotate()); case 2: return new e(new r.default(this.screenSize.width - this.point.x, this.screenSize.height - this.point.y), this.screenSize); case 3: return new e(new r.default(this.point.y, this.screenSize.width - this.point.x), this.screenSize.rotate()); default: return this } }, e.prototype.toString = function () { return "Position{point=" + this.point + ", screenSize=" + this.screenSize + "}" }, e.prototype.toJSON = function () { return { point: this.point.toJSON(), screenSize: this.screenSize.toJSON() } }, e }(); t.default = i }, function (e, t, n) { "use strict"; n.r(t), t.default = n.p + "0adc36cf9cddfe4b6056c3ca47abaca0.png" }, function (e, t, n) { "use strict"; n.r(t), t.default = n.p + "1279f368b5bb729ca7b35990042f9928.png" }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }), t.ScrollControlMessage = void 0; var r = n(0), i = n(10), o = function (t) { function n(e, n, r) { var o = t.call(this, i.ControlMessage.TYPE_SCROLL) || this; return o.position = e, o.hScroll = n, o.vScroll = r, o } return r.__extends(n, t), n.prototype.toBuffer = function () { var t = new e(n.PAYLOAD_LENGTH + 1), r = 0; return r = t.writeUInt8(this.type, r), r = t.writeUInt32BE(this.position.point.x, r), r = t.writeUInt32BE(this.position.point.y, r), r = t.writeUInt16BE(this.position.screenSize.width, r), r = t.writeUInt16BE(this.position.screenSize.height, r), r = t.writeInt32BE(this.hScroll, r), t.writeInt32BE(this.vScroll, r), t }, n.prototype.toString = function () { return "ScrollControlMessage{hScroll=" + this.hScroll + ", vScroll=" + this.vScroll + ", position=" + this.position + "}" }, n.prototype.toJSON = function () { return { type: this.type, position: this.position.toJSON(), hScroll: this.hScroll, vScroll: this.vScroll } }, n.PAYLOAD_LENGTH = 20, n }(i.ControlMessage); t.ScrollControlMessage = o }).call(this, n(2).Buffer) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MessageType = void 0, function (e) { e.HOSTS = "hosts", e.ERROR = "error" }(t.MessageType || (t.MessageType = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DeviceTracker = void 0; var r, i = n(0), o = n(20), a = n(4), s = i.__importDefault(n(1)), u = n(14), c = n(40), l = n(22), d = n(95), f = function (e) { function t(n, r) { var o = e.call(this, i.__assign(i.__assign({}, n), { action: t.ACTION }), r) || this; return o.tableId = "appl_devices_list", t.instancesByUrl.set(r, o), o.buildDeviceTable(), o.openNewConnection(), o } return i.__extends(t, e), t.start = function (e) { var n = this.buildUrlForTracker(e).toString(), r = this.instancesByUrl.get(n); return r || (r = new t(e, n)), r }, t.getInstance = function (e) { return this.start(e) }, t.prototype.onSocketOpen = function () { }, t.prototype.buildDeviceRow = function (e, n) { var o = this, l = this.id + "_" + s.default.escapeUdid(n.udid), f = n.state === c.DeviceState.CONNECTED, h = "device_services_" + l, p = u.html(r || (r = i.__makeTemplateObject(['<div class="device ', '">\n            <div class="device-header">\n                <div class="device-name">"', '"</div>\n                <div class="device-model">', '</div>\n                <div class="device-serial">', '</div>\n                <div class="device-version">\n                    <div class="release-version">', '</div>\n                </div>\n                <div class="device-state" title="State: ', '"></div>\n            </div>\n            <div id="', '" class="services"></div>\n        </div>'], ['<div class="device ', '">\n            <div class="device-header">\n                <div class="device-name">"', '"</div>\n                <div class="device-model">', '</div>\n                <div class="device-serial">', '</div>\n                <div class="device-version">\n                    <div class="release-version">', '</div>\n                </div>\n                <div class="device-state" title="State: ', '"></div>\n            </div>\n            <div id="', '" class="services"></div>\n        </div>'])), f ? "active" : "not-active", n.name, n.model, n.udid, n.version, n.state, h).content, E = p.getElementById(h); if (E) { var v = "" + t.AttributePrefixPlayerFor + l; d.StreamClientQVHack.getPlayers().forEach((function (e) { var r = e.playerCodeName, i = e.playerFullName, s = document.createElement("div"); s.classList.add("desc-block"), s.setAttribute("name", encodeURIComponent(v)), s.setAttribute(t.AttributePlayerFullName, encodeURIComponent(i)), s.setAttribute(t.AttributePlayerCodeName, encodeURIComponent(r)); var u = { action: a.ACTION.STREAM_WS_QVH, player: r, udid: n.udid }, c = t.buildLink(u, "Stream (" + i + ")", o.params); s.appendChild(c), E.appendChild(s) })), e.appendChild(p) } }, t.prototype.getChannelCode = function () { return l.ChannelCode.ATRC }, t.ACTION = a.ACTION.APPL_DEVICE_LIST, t.instancesByUrl = new Map, t }(o.BaseDeviceTracker); t.DeviceTracker = f }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.StreamClientQVHack = void 0; var r = n(0), i = n(7), o = n(96), a = n(97), s = r.__importDefault(n(99)), u = n(100), c = r.__importDefault(n(3)), l = n(101), d = n(11), f = n(108), h = n(4), p = r.__importDefault(n(1)), E = n(109), v = "[StreamClientQVHack]", m = function (e) { function t(t) { var n = e.call(this, t) || this; n.deviceName = "", n.wdaConnection = new s.default, n.onViewVideoResize = function () { n.runWebDriverAgent() }, n.onInputVideoResize = function (e) { n.wdaConnection.setScreenInfo(e) }, n.udid = n.params.udid; var i = n.udid; return -1 !== i.indexOf("-") && (i = i.replace("-", ""), i += "\0".repeat(16)), n.managerClient = new u.WsQVHackClient(r.__assign(r.__assign({}, n.params), { action: h.ACTION.PROXY_WDA })), n.streamReceiver = new E.StreamReceiverQVHack(r.__assign(r.__assign({}, n.params), { udid: i })), n.startStream(), n.setTitle(n.udid + " stream"), n.setBodyClass("stream"), n } return r.__extends(t, e), t.registerPlayer = function (e) { e.isSupported() && this.players.set(e.playerFullName, e) }, t.getPlayers = function () { return Array.from(this.players.values()) }, t.getPlayerClass = function (e) { var t, n, i; try { for (var o = r.__values(this.players.values()), a = o.next(); !a.done; a = o.next()) { var s = a.value; s.playerFullName !== e && s.playerCodeName !== e || (i = s) } } catch (e) { t = { error: e } } finally { try { a && !a.done && (n = o.return) && n.call(o) } finally { if (t) throw t.error } } return i || l.MsePlayerForQVHack }, t.createPlayer = function (e, t) { var n = this.getPlayerClass(t); return n ? new n(e) : new l.MsePlayerForQVHack(e) }, t.start = function (e) { return new t(e) }, t.prototype.parseParameters = function (t) { var n = e.prototype.parseParameters.call(this, t), i = n.action; if (i !== h.ACTION.STREAM_WS_QVH) throw Error("Incorrect action"); return r.__assign(r.__assign({}, n), { action: i, udid: p.default.parseStringEnv(t.udid), player: p.default.parseStringEnv(t.player) }) }, t.prototype.runWebDriverAgent = function () { var e = this; "boolean" != typeof this.waitForWda && (this.waitForWda = !0, this.managerClient.runWebDriverAgent(this.udid).then((function (t) { e.waitForWda = !1; var n = t.data; 0 === n.code ? e.wdaConnection.setClient(e.managerClient) : console.error(v, "Failed to run WebDriverAgent. Reason: " + n.text + ", code: " + n.code) })).finally((function () { var t; null === (t = e.videoWrapper) || void 0 === t || t.classList.remove("wait") }))) }, t.prototype.startStream = function (e) { var n, r = this, i = this.params, s = i.udid, u = i.player; if (!s) throw Error('Invalid udid value: "' + s + '"'); n = e || t.createPlayer(s, u), this.setTouchListeners(n), n.pause(); var c = document.createElement("div"); c.className = "device-view"; var l = new o.QVHackMoreBox(s, n); l.setOnStop((function (e) { var t; e && e instanceof Event && "error" === e.type && console.error(v, e), (t = c.parentElement) && t.removeChild(c), (t = f.parentElement) && t.removeChild(f), r.streamReceiver.stop(), r.managerClient.stop(), n.stop() })); var f = l.getHolderElement(), h = a.QVHackToolBox.createToolBox(s, n, this, this.wdaConnection, f).getHolderElement(); c.appendChild(h); var p = document.createElement("div"); p.className = "video wait", c.appendChild(p), c.appendChild(f), n.setParent(p), n.on("video-view-resize", this.onViewVideoResize), n.on("input-video-resize", this.onInputVideoResize), this.videoWrapper = p, document.body.appendChild(c); var E = t.getMaxSize(h); E && n.setBounds(E), this.streamReceiver.on("video", (function (e) { var t = d.BasePlayer.STATE; n.getState() === t.PAUSED && n.play(), n.getState() === t.PLAYING && n.pushFrame(new Uint8Array(e)) })) }, t.getMaxSize = function (e) { if (e) { var t = document.body, n = t.clientWidth - e.clientWidth & -16, r = -16 & t.clientHeight; return new c.default(n, r) } }, t.prototype.getDeviceName = function () { return this.deviceName }, t.prototype.setTouchListeners = function (e) { this.touchHandler || (this.touchHandler = new f.SimpleInteractionHandler(e, this)) }, t.prototype.performClick = function (e) { this.wdaConnection.wdaPerformClick(e) }, t.prototype.performScroll = function (e, t) { this.wdaConnection.wdaPerformScroll(e, t) }, t.ACTION = h.ACTION.STREAM_WS_QVH, t.players = new Map, t }(i.BaseClient); t.StreamClientQVHack = m }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.QVHackMoreBox = void 0; var r = n(11), i = function () { function e(t, n) { var i = this; this.onViewVideoResize = function (e) { i.holder.style.width = e.width - 20 + "px" }; var o = n.getName(), a = document.createElement("div"); a.className = "more-box"; var s = document.createElement("p"); s.innerText = t + " (" + o + ")", s.className = "text-with-shadow", a.appendChild(s); var u = "show_video_quality_" + t + "_" + o, c = document.createElement("label"), l = document.createElement("input"); l.type = "checkbox", l.checked = r.BasePlayer.DEFAULT_SHOW_QUALITY_STATS, l.id = u, c.htmlFor = u, c.innerText = "Show quality stats", e.wrap("p", [l, c], a), l.onchange = function () { n.setShowQualityStats(l.checked) }; var d = document.createElement("button"); d.innerText = "Disconnect", d.onclick = function (e) { e && e instanceof Event && "error" === e.type && console.error("[QVHackMoreBox]", e); var t = a.parentElement; t && t.removeChild(a), n.off("video-view-resize", i.onViewVideoResize), i.onStop && (i.onStop(), delete i.onStop) }, e.wrap("p", [d], a), n.on("video-view-resize", this.onViewVideoResize), this.holder = a } return e.wrap = function (e, t, n) { var r = document.createElement(e); t.forEach((function (e) { r.appendChild(e) })), n.appendChild(r) }, e.prototype.getHolderElement = function () { return this.holder }, e.prototype.setOnStop = function (e) { this.onStop = e }, e }(); t.QVHackMoreBox = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.QVHackToolBox = void 0; var r = n(0), i = n(98), o = r.__importDefault(n(6)), a = n(29), s = n(31), u = [{ title: "Home", name: "home", icon: o.default.Icon.HOME }], c = function (e) { function t(t) { return e.call(this, t) || this } return r.__extends(t, e), t.createToolBox = function (e, n, r, i, c) { var l = n.getName(), d = u.slice(), f = function (e, t) { var n; if (null === (n = t.optional) || void 0 === n ? void 0 : n.name) { var r = t.optional.name; i.wdaPressButton(r) } }, h = d.map((function (e) { var t = new a.ToolBoxButton(e.title, e.icon, { name: e.name }); return t.addEventListener("click", f), t })); if (n.supportsScreenshot) { var p = new a.ToolBoxButton("Take screenshot", o.default.Icon.CAMERA); p.addEventListener("click", (function () { n.createScreenshot(r.getDeviceName()) })), h.push(p) } if (c) { var E = new s.ToolBoxCheckbox("More", o.default.Icon.MORE, "show_more_" + e + "_" + l); E.addEventListener("click", (function (e, t) { var n = t.getElement(); c.style.display = n.checked ? "block" : "none" })), h.unshift(E) } return new t(h) }, t }(i.ToolBox); t.QVHackToolBox = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ToolBox = void 0; var r = function () { function e(e) { var t = this; this.holder = document.createElement("div"), this.holder.classList.add("control-buttons-list", "control-wrapper"), e.forEach((function (e) { e.getAllElements().forEach((function (e) { t.holder.appendChild(e) })) })) } return e.prototype.getHolderElement = function () { return this.holder }, e }(); t.ToolBox = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), i = r.__importDefault(n(23)), o = function () { function e() { } return e.prototype.setScreenInfo = function (e) { this.screenInfo = e }, e.prototype.getScreenInfo = function () { return this.screenInfo }, e.prototype.wdaPressButton = function (e) { var t; return r.__awaiter(this, void 0, void 0, (function () { return r.__generator(this, (function (n) { return [2, null === (t = this.client) || void 0 === t ? void 0 : t.requestWebDriverAgent("pressButton", { name: e })] })) })) }, e.prototype.wdaPerformClick = function (t) { var n; return r.__awaiter(this, void 0, void 0, (function () { var i, o, a; return r.__generator(this, (function (r) { switch (r.label) { case 0: return this.screenInfo ? (o = this.wdaScreen) ? [3, 2] : [4, this.getWdaScreen()] : [2]; case 1: o = r.sent(), r.label = 2; case 2: return i = o, [4, e.calculatePhysicalPoint(this.screenInfo, i, t)]; case 3: return (a = r.sent()) ? [2, null === (n = this.client) || void 0 === n ? void 0 : n.requestWebDriverAgent("click", { x: a.x, y: a.y })] : [2] } })) })) }, e.prototype.wdaPerformScroll = function (t, n) { var i; return r.__awaiter(this, void 0, void 0, (function () { var o, a, s, u; return r.__generator(this, (function (r) { switch (r.label) { case 0: return this.screenInfo ? (a = this.wdaScreen) ? [3, 2] : [4, this.getWdaScreen()] : [2]; case 1: a = r.sent(), r.label = 2; case 2: return o = a, s = e.calculatePhysicalPoint(this.screenInfo, o, t), u = e.calculatePhysicalPoint(this.screenInfo, o, n), s && u ? [2, null === (i = this.client) || void 0 === i ? void 0 : i.requestWebDriverAgent("scroll", { from: { x: s.x, y: s.y }, to: { x: u.x, y: u.y } })] : [2] } })) })) }, e.prototype.getWdaScreen = function () { var e; return r.__awaiter(this, void 0, void 0, (function () { var t; return r.__generator(this, (function (n) { switch (n.label) { case 0: return this.wdaScreen ? [2, this.wdaScreen] : [4, null === (e = this.client) || void 0 === e ? void 0 : e.requestWebDriverAgent("getScreen")]; case 1: if ((t = n.sent()).data.success) return [2, this.wdaScreen = t.data.response]; throw Error("Invalid response") } })) })) }, e.calculatePhysicalPoint = function (e, t, n) { var r = t.statusBarSize, o = e.videoSize, a = e.deviceRotation, s = e.contentRect, u = s.right, c = s.left, l = s.bottom, d = s.top, f = (o.width >= o.height ? l - d : u - c) / r.width, h = n.rotate(a); if (o.equals(h.screenSize)) { var p = h.point, E = s.left + p.x * s.getWidth() / o.width, v = s.top + p.y * s.getHeight() / o.height, m = Math.round(E / f), y = Math.round(v / f); return new i.default(m, y) } }, e.prototype.setClient = function (e) { this.client = e }, e }(); t.default = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.WsQVHackClient = void 0; var r = n(0), i = n(12), o = n(21), a = n(4), s = r.__importDefault(n(1)), u = "[WsQVHackClient]", c = function (e) { function t(t) { var n = e.call(this, t) || this; return n.stopped = !1, n.commands = [], n.hasSession = !1, n.messageId = 0, n.wait = new Map, n.openNewConnection(), n } return r.__extends(t, e), t.prototype.parseParameters = function (t) { var n = e.prototype.parseParameters.call(this, t), i = n.action; if (i !== a.ACTION.PROXY_WDA) throw Error("Incorrect action"); return r.__assign(r.__assign({}, n), { action: i, udid: s.default.parseStringEnv(t.udid) }) }, t.prototype.buildDirectWebSocketUrl = function () { var t = e.prototype.buildDirectWebSocketUrl.call(this); return t.searchParams.set("udid", this.params.udid), t }, t.prototype.onSocketClose = function (e) { var t = this; this.emit("connected", !1), console.log(u, "Connection closed: " + e.reason), this.stopped || setTimeout((function () { t.openNewConnection() }), 2e3) }, t.prototype.onSocketMessage = function (e) { var t = this; new Response(e.data).text().then((function (e) { var n = JSON.parse(e), r = n.type, i = n.id, o = t.wait.get(i); if (o) o.resolve(n); else switch (r) { case "devicelist": var a = n.data; return void t.emit("device-list", a); case "device": var s = n.data; return void t.emit("device", s); default: throw Error("Unsupported message") } })).catch((function (t) { console.error(u, t.message), console.log(u, e.data) })) }, t.prototype.onSocketOpen = function () { for (this.emit("connected", !0); this.commands.length;) { var e = this.commands.shift(); e && this.sendCommand(e) } }, t.prototype.sendCommand = function (e) { this.ws && this.ws.readyState === this.ws.OPEN ? this.ws.send(e) : this.commands.push(e) }, t.prototype.getNextId = function () { return ++this.messageId }, t.prototype.sendMessage = function (e) { return r.__awaiter(this, void 0, void 0, (function () { var t = this; return r.__generator(this, (function (n) { return this.sendCommand(JSON.stringify(e)), [2, new Promise((function (n, r) { t.wait.set(e.id, { resolve: n, reject: r }) }))] })) })) }, t.prototype.runWebDriverAgent = function (e) { return r.__awaiter(this, void 0, void 0, (function () { var t, n; return r.__generator(this, (function (r) { switch (r.label) { case 0: return t = { id: this.getNextId(), type: o.ControlCenterCommand.RUN_WDA, data: { udid: e } }, [4, this.sendMessage(t)]; case 1: return n = r.sent(), this.hasSession = !0, [2, n] } })) })) }, t.prototype.requestWebDriverAgent = function (e, t) { return r.__awaiter(this, void 0, void 0, (function () { var n; return r.__generator(this, (function (r) { if (!this.hasSession) throw Error("No session"); return n = { id: this.getNextId(), type: o.ControlCenterCommand.REQUEST_WDA, data: { method: e, args: t } }, [2, this.sendMessage(n)] })) })) }, t.prototype.stop = function () { this.stopped || (this.stopped = !0, this.ws && this.ws.readyState === this.ws.OPEN && this.ws.close()) }, t }(i.ManagerClient); t.WsQVHackClient = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MsePlayerForQVHack = void 0; var r = n(0), i = n(44), o = r.__importDefault(n(38)), a = r.__importDefault(n(9)), s = r.__importDefault(n(3)), u = r.__importDefault(n(5)), c = function (e) { function t(n, r, i, o) { return void 0 === i && (i = "MSE_Player_For_QVHack"), void 0 === o && (o = t.createElement()), e.call(this, n, r, i, o) || this } return r.__extends(t, e), t.prototype.handleVideoResize = function (t, n) { e.prototype.handleVideoResize.call(this, t, n); var r = t, i = n; if (this.bounds) { var u = this.bounds, c = u.w, l = u.h; if (r > c || i > l) { var d = void 0, f = void 0; l > (d = c > r ? i : c * i / r) && (l = d), c > (f = l == i ? r : l * r / i) && (c = f), r = 0 | c, i = 0 | l, this.tag.style.maxWidth = r + "px", this.tag.style.maxHeight = i + "px" } } var h = new o.default(new a.default(0, 0, t, n), new s.default(r, i), 0); this.emit("input-video-resize", h), this.setScreenInfo(new o.default(new a.default(0, 0, r, i), new s.default(r, i), 0)) }, t.prototype.needScreenInfoBeforePlay = function () { return !1 }, t.prototype.getPreferredVideoSetting = function () { return t.preferredVideoSettings }, t.prototype.setVideoSettings = function () { }, t.preferredVideoSettings = new u.default({ lockedVideoOrientation: -1, bitrate: 8e6, maxFps: 30, iFrameInterval: 10, bounds: new s.default(720, 720), sendFrameMeta: !1 }), t }(i.MsePlayer); t.MsePlayerForQVHack = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(103), i = n(106), o = n(15), a = n(107); t.mimeType = 'video/mp4; codecs="avc1.42E01E"'; var s = n(15); t.setLogger = s.setLogger; var u = function () { function e(e, n, r) { if (void 0 === n && (n = 60), void 0 === r && (r = n), this.element = e, this.fps = n, this.fpf = r, this.receiveBuffer = new a.default, this.queue = [], !MediaSource || !MediaSource.isTypeSupported(t.mimeType)) throw new Error("Your browser is not supported: " + t.mimeType); this.reset() } return Object.defineProperty(e, "errorNotes", { get: function () { var e; return (e = {})[MediaError.MEDIA_ERR_ABORTED] = "fetching process aborted by user", e[MediaError.MEDIA_ERR_NETWORK] = "error occurred when downloading", e[MediaError.MEDIA_ERR_DECODE] = "error occurred when decoding", e[MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED] = "audio/video not supported", e }, enumerable: !0, configurable: !0 }), e.prototype.setup = function () { var e = this; return this.mediaReadyPromise = new Promise((function (n, r) { e.mediaSource.addEventListener("sourceopen", (function () { o.log("Media Source opened."), e.sourceBuffer = e.mediaSource.addSourceBuffer(t.mimeType), e.sourceBuffer.addEventListener("updateend", (function () { o.log("  SourceBuffer updateend"), o.log("    sourceBuffer.buffered.length=" + e.sourceBuffer.buffered.length); for (var t = 0, n = e.sourceBuffer.buffered.length; t < n; t++)o.log("    sourceBuffer.buffered [" + t + "]: " + e.sourceBuffer.buffered.start(t) + ", " + e.sourceBuffer.buffered.end(t)); if (o.log("  mediasource.duration=" + e.mediaSource.duration), o.log("  mediasource.readyState=" + e.mediaSource.readyState), o.log("  video.duration=" + e.element.duration), o.log("    video.buffered.length=" + e.element.buffered.length), o.isEnable()) for (t = 0, n = e.element.buffered.length; t < n; t++)o.log("    video.buffered [" + t + "]: " + e.element.buffered.start(t) + ", " + e.element.buffered.end(t)); if (o.log("  video.currentTime=" + e.element.currentTime), o.log("  video.readyState=" + e.element.readyState), !e.sourceBuffer.updating) { var r = e.queue.shift(); r && e.doAppend(r) } })), e.sourceBuffer.addEventListener("error", (function () { o.error("  SourceBuffer errored!") })), e.mediaReady = !0, n() }), !1), e.mediaSource.addEventListener("sourceclose", (function () { o.log("Media Source closed."), e.mediaReady = !1 }), !1), e.element.src = URL.createObjectURL(e.mediaSource) })), this.mediaReadyPromise }, e.prototype.play = function () { var e = this; if (this.element.paused) if (this.mediaReady && this.element.readyState >= 2) this.element.play(); else { var t = function () { e.play(), e.element.removeEventListener("canplaythrough", t) }; this.element.addEventListener("canplaythrough", t) } }, e.prototype.pause = function () { this.element.paused || this.element.pause() }, e.prototype.reset = function () { if (this.receiveBuffer.clear(), this.mediaSource && "open" === this.mediaSource.readyState && this.sourceBuffer.updating) { var e = this.mediaSource; this.sourceBuffer.addEventListener("updateend", (function () { e.endOfStream() })) } this.mediaSource = new MediaSource, this.remuxer = new r.default(this.fps, this.fpf, 60 * this.fps), this.mediaReady = !1, this.mediaReadyPromise = void 0, this.queue = [], this.setup() }, e.prototype.appendRawData = function (e) { for (var t = 0, n = this.receiveBuffer.append(e); t < n.length; t++) { var r = n[t], i = this.remuxer.remux(r); i && this.writeFragment(i[0], i[1]) } }, e.prototype.writeFragment = function (e, t) { var n = this.remuxer; if (n.mp4track.isKeyFrame && this.writeBuffer(i.default.initSegment([n.mp4track], 1 / 0, n.timescale)), t && t.byteLength) { o.log(" Put fragment: " + n.seqNum + ", frames=" + n.mp4track.samples.length + ", size=" + t.byteLength); var r = i.default.fragmentSegment(n.seqNum, e, n.mp4track, t); this.writeBuffer(r), n.flush() } else o.error("Nothing payload!") }, e.prototype.writeBuffer = function (e) { var t = this; this.mediaReady ? this.sourceBuffer.updating || this.queue.length ? this.queue.push(e) : this.doAppend(e) : (this.queue.push(e), this.mediaReadyPromise && (this.mediaReadyPromise.then((function () { if (!t.sourceBuffer.updating) { var e = t.queue.shift(); e && t.doAppend(e) } })), this.mediaReadyPromise = void 0)) }, e.prototype.doAppend = function (t) { var n = this.element.error; if (n) o.error("MSE Error Occured: " + e.errorNotes[n.code]), this.element.pause(), "open" === this.mediaSource.readyState && this.mediaSource.endOfStream(); else try { this.sourceBuffer.appendBuffer(t), o.log("  appended buffer: size=" + t.byteLength) } catch (e) { o.error("MSE Error occured while appending buffer. " + e.name + ": " + e.message) } }, e }(); t.default = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(104), i = n(15), o = n(24), a = 1, s = function () { function e(t, n, i) { this.fps = t, this.framePerFragment = n, this.timescale = i, this.readyToDecode = !1, this.totalDTS = 0, this.stepDTS = Math.round(this.timescale / this.fps), this.frameCount = 0, this.seq = 1, this.mp4track = { id: e.getTrackID(), type: "video", len: 0, codec: "", sps: [], pps: [], seiBuffering: !1, width: 0, height: 0, timescale: i, duration: i, samples: [], isKeyFrame: !0 }, this.unitSamples = [[]], this.parser = new r.default(this) } return e.getTrackID = function () { return a++ }, Object.defineProperty(e.prototype, "seqNum", { get: function () { return this.seq }, enumerable: !0, configurable: !0 }), e.prototype.remux = function (e) { return this.mp4track.seiBuffering && e.type() === o.default.SEI ? this.createNextFrame() : (this.parser.parseNAL(e) && (this.unitSamples[this.unitSamples.length - 1].push(e), this.mp4track.len += e.getSize(), this.mp4track.isKeyFrame = e.isKeyframe()), this.mp4track.seiBuffering || e.type() !== o.default.IDR && e.type() !== o.default.NDR ? void 0 : this.createNextFrame()) }, e.prototype.createNextFrame = function () { if (this.mp4track.len > 0) { if (this.frameCount++, this.frameCount % this.framePerFragment == 0) { var e = this.getFragment(); if (e) { var t = this.totalDTS; return this.totalDTS = this.stepDTS * this.frameCount, [t, e] } i.log("No mp4 sample data.") } this.unitSamples.push([]) } }, e.prototype.flush = function () { this.seq++, this.mp4track.len = 0, this.mp4track.samples = [], this.mp4track.isKeyFrame = !1, this.unitSamples = [[]] }, e.prototype.getFragment = function () { if (this.checkReadyToDecode()) { var e = new Uint8Array(this.mp4track.len); this.mp4track.samples = []; for (var t = 0, n = 0, r = this.unitSamples.length; n < r; n++) { var i = this.unitSamples[n]; if (0 !== i.length) { for (var o = { size: 0, cts: this.stepDTS * n }, a = 0, s = i; a < s.length; a++) { var u = s[a]; o.size += u.getSize(), e.set(u.getData(), t), t += u.getSize() } this.mp4track.samples.push(o) } } if (0 !== t) return e } }, e.prototype.checkReadyToDecode = function () { return !(!this.readyToDecode || 0 === this.unitSamples.filter((function (e) { return e.length > 0 })).length) || (i.log("Not ready to decode! readyToDecode(" + this.readyToDecode + ") is false or units is empty."), !1) }, e }(); t.default = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(105), i = n(15), o = n(24), a = function () { function e(e) { this.remuxer = e, this.track = e.mp4track } return e.prototype.parseSEI = function (t) { for (var n = 0, r = e.readSEI(t); n < r.length; n++) { switch (r[n].type) { case 0: this.track.seiBuffering = !0; break; case 5: return !0 } } return !1 }, e.prototype.parseSPS = function (t) { var n = e.readSPS(t); this.track.width = n.width, this.track.height = n.height, this.track.sps = [t], this.track.codec = "avc1."; for (var r = new DataView(t.buffer, t.byteOffset + 1, 4), i = 0; i < 3; ++i) { var o = r.getUint8(i).toString(16); o.length < 2 && (o = "0" + o), this.track.codec += o } }, e.prototype.parsePPS = function (e) { this.track.pps = [e] }, e.prototype.parseNAL = function (e) { if (!e) return !1; var t = !1; switch (e.type()) { case o.default.NDR: case o.default.IDR: t = !0; break; case o.default.SEI: t = this.parseSEI(e.getData().subarray(4)); break; case o.default.SPS: this.parseSPS(e.getData().subarray(4)), i.log(" Found SPS type NALU frame."), !this.remuxer.readyToDecode && this.track.pps.length > 0 && this.track.sps.length > 0 && (this.remuxer.readyToDecode = !0); break; case o.default.PPS: this.parsePPS(e.getData().subarray(4)), i.log(" Found PPS type NALU frame."), !this.remuxer.readyToDecode && this.track.pps.length > 0 && this.track.sps.length > 0 && (this.remuxer.readyToDecode = !0); break; default: i.log(" Found Unknown type NALU frame. type=" + e.type()) }return t }, e.skipScalingList = function (e, t) { for (var n = 8, r = 8, i = 0; i < t; i++) { if (0 !== r) r = (n + e.readEG() + 256) % 256; n = 0 === r ? n : r } }, e.readSPS = function (e) { var t = this.parseSPS(e), n = t.pic_width_in_mbs_minus1, r = t.frame_crop_left_offset, i = t.frame_crop_right_offset, o = t.frame_mbs_only_flag, a = t.pic_height_in_map_units_minus1, s = t.frame_crop_top_offset, u = t.frame_crop_bottom_offset, c = t.sar, l = c[0] / c[1]; return { width: Math.ceil((16 * (n + 1) - 2 * r - 2 * i) * l), height: (2 - o) * (a + 1) * 16 - (o ? 2 : 4) * (s + u) } }, e.parseSPS = function (t) { var n = new r.default(t), o = 0, a = 0, s = 0, u = 0; n.readUByte(); var c = n.readUByte(), l = n.readUByte(), d = n.readBits(8), f = n.readUEG(); if (100 === c || 110 === c || 122 === c || 244 === c || 44 === c || 83 === c || 86 === c || 118 === c || 128 === c || 138 === c || 139 === c || 134 === c) { var h = n.readUEG(); if (3 === h && n.skipBits(1), n.skipUEG(), n.skipUEG(), n.skipBits(1), n.readBoolean()) for (var p = 3 !== h ? 8 : 12, E = 0; E < p; ++E)n.readBoolean() && (E < 6 ? e.skipScalingList(n, 16) : e.skipScalingList(n, 64)) } n.skipUEG(); var v = n.readUEG(); if (0 === v) n.readUEG(); else if (1 === v) { n.skipBits(1), n.skipEG(), n.skipEG(); var m = n.readUEG(); for (E = 0; E < m; ++E)n.skipEG() } n.skipUEG(), n.skipBits(1); var y = n.readUEG(), _ = n.readUEG(), g = n.readBits(1); 0 === g && n.skipBits(1), n.skipBits(1), n.readBoolean() && (o = n.readUEG(), a = n.readUEG(), s = n.readUEG(), u = n.readUEG()); var S = [1, 1]; if (n.readBoolean()) { if (n.readBoolean()) { var C = n.readUByte(); switch (C) { case 1: S = [1, 1]; break; case 2: S = [12, 11]; break; case 3: S = [10, 11]; break; case 4: S = [16, 11]; break; case 5: S = [40, 33]; break; case 6: S = [24, 11]; break; case 7: S = [20, 11]; break; case 8: S = [32, 11]; break; case 9: S = [80, 33]; break; case 10: S = [18, 11]; break; case 11: S = [15, 11]; break; case 12: S = [64, 33]; break; case 13: S = [160, 99]; break; case 14: S = [4, 3]; break; case 15: S = [3, 2]; break; case 16: S = [2, 1]; break; case 255: S = [n.readUByte() << 8 | n.readUByte(), n.readUByte() << 8 | n.readUByte()]; break; default: i.error("  H264: Unknown aspectRatioIdc=" + C) } } if (n.readBoolean() && n.skipBits(1), n.readBoolean() && (n.skipBits(4), n.readBoolean() && n.skipBits(24)), n.readBoolean() && (n.skipUEG(), n.skipUEG()), n.readBoolean()) if (n.bitsAvailable > 64) { var O = n.readUInt(), T = n.readUInt(), D = n.readBoolean(), I = T / (2 * O); i.log("timescale: " + T + "; unitsInTick: " + O + "; fixedFramerate: " + D + "; avgFrameDuration: " + I) } else i.log("Truncated VUI (" + n.bitsAvailable + ")") } return { profile_idc: c, constraint_set_flags: l, level_idc: d, seq_parameter_set_id: f, pic_width_in_mbs_minus1: y, pic_height_in_map_units_minus1: _, frame_mbs_only_flag: g, frame_crop_left_offset: o, frame_crop_right_offset: a, frame_crop_top_offset: s, frame_crop_bottom_offset: u, sar: S } }, e.readSEI = function (e) { var t = new r.default(e); t.skipBits(8); for (var n = []; t.bitsAvailable > 24;)n.push(this.readSEIMessage(t)); return n }, e.readSEIMessage = function (e) { function t() { for (var t = 0; ;) { var n = e.readUByte(); if (t += n, 255 !== n) break } return t } var n = t(), r = t(); return this.readSEIPayload(e, n, r) }, e.readSEIPayload = function (e, t, n) { var r; return r = { type: t }, e.skipBits(8 * n), e.skipBits(e.bitsAvailable % 8), r }, e }(); t.default = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.data = e, this.index = 0, this.bitLength = 8 * e.byteLength } return Object.defineProperty(e.prototype, "bitsAvailable", { get: function () { return this.bitLength - this.index }, enumerable: !0, configurable: !0 }), e.prototype.skipBits = function (e) { if (this.bitsAvailable < e) throw new Error("no bytes available"); this.index += e }, e.prototype.readBits = function (e) { return this.getBits(e, this.index) }, e.prototype.getBits = function (e, t, n) { if (void 0 === n && (n = !0), this.bitsAvailable < e) throw new Error("no bytes available"); var r = t % 8, i = this.data[t / 8 | 0] & 255 >>> r, o = 8 - r; if (o >= e) return n && (this.index += e), i >> o - e; n && (this.index += o); var a = e - o; return i << a | this.getBits(a, t + o, n) }, e.prototype.skipLZ = function () { var e; for (e = 0; e < this.bitLength - this.index; ++e)if (0 !== this.getBits(1, this.index + e, !1)) return this.index += e, e; return e }, e.prototype.skipUEG = function () { this.skipBits(1 + this.skipLZ()) }, e.prototype.skipEG = function () { this.skipBits(1 + this.skipLZ()) }, e.prototype.readUEG = function () { var e = this.skipLZ(); return this.readBits(e + 1) - 1 }, e.prototype.readEG = function () { var e = this.readUEG(); return 1 & e ? 1 + e >>> 1 : -1 * (e >>> 1) }, e.prototype.readBoolean = function () { return 1 === this.readBits(1) }, e.prototype.readUByte = function () { return this.readBits(8) }, e.prototype.readUShort = function () { return this.readBits(16) }, e.prototype.readUInt = function () { return this.readBits(32) }, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.init = function () { for (var t in e.initalized = !0, e.types = { avc1: [], avcC: [], btrt: [], dinf: [], dref: [], esds: [], ftyp: [], hdlr: [], mdat: [], mdhd: [], mdia: [], mfhd: [], minf: [], moof: [], moov: [], mp4a: [], mvex: [], mvhd: [], sdtp: [], stbl: [], stco: [], stsc: [], stsd: [], stsz: [], stts: [], styp: [], tfdt: [], tfhd: [], traf: [], trak: [], trun: [], trep: [], trex: [], tkhd: [], vmhd: [], smhd: [] }, e.types) e.types.hasOwnProperty(t) && (e.types[t] = [t.charCodeAt(0), t.charCodeAt(1), t.charCodeAt(2), t.charCodeAt(3)]); var n = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0]), r = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]), i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]); e.STTS = e.STSC = e.STCO = i, e.STSZ = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]), e.VMHD = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]), e.SMHD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), e.STSD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]), e.FTYP = e.box(e.types.ftyp, new Uint8Array([105, 115, 111, 53, 0, 0, 0, 1, 97, 118, 99, 49, 105, 115, 111, 53, 100, 97, 115, 104])), e.STYP = e.box(e.types.styp, new Uint8Array([109, 115, 100, 104, 0, 0, 0, 0, 109, 115, 100, 104, 109, 115, 105, 120])), e.DINF = e.box(e.types.dinf, e.box(e.types.dref, r)), e.HDLR = e.box(e.types.hdlr, n) }, e.box = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; for (var r = 8, i = 0, o = t; i < o.length; i++) { var a = o[i]; r += a.byteLength } var s = new Uint8Array(r); s[0] = r >> 24 & 255, s[1] = r >> 16 & 255, s[2] = r >> 8 & 255, s[3] = 255 & r, s.set(e, 4), r = 8; for (var u = 0, c = t; u < c.length; u++) { var l = c[u]; s.set(l, r), r += l.byteLength } return s }, e.mdat = function (t) { return e.box(e.types.mdat, t) }, e.mdhd = function (t) { return e.box(e.types.mdhd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, 255 & t, 0, 0, 0, 0, 85, 196, 0, 0])) }, e.mdia = function (t) { return e.box(e.types.mdia, e.mdhd(t.timescale), e.HDLR, e.minf(t)) }, e.mfhd = function (t) { return e.box(e.types.mfhd, new Uint8Array([0, 0, 0, 0, t >> 24, t >> 16 & 255, t >> 8 & 255, 255 & t])) }, e.minf = function (t) { return e.box(e.types.minf, e.box(e.types.vmhd, e.VMHD), e.DINF, e.stbl(t)) }, e.moof = function (t, n, r) { return e.box(e.types.moof, e.mfhd(t), e.traf(r, n)) }, e.moov = function (t, n, r) { for (var i = [], o = 0, a = t; o < a.length; o++) { var s = a[o]; i.push(e.trak(s)) } return e.box.apply(e, [e.types.moov, e.mvhd(r, n), e.mvex(t)].concat(i)) }, e.mvhd = function (t, n) { var r = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, 255 & t, n >> 24 & 255, n >> 16 & 255, n >> 8 & 255, 255 & n, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2]); return e.box(e.types.mvhd, r) }, e.mvex = function (t) { for (var n = [], r = 0, i = t; r < i.length; r++) { var o = i[r]; n.push(e.trex(o)) } return e.box.apply(e, [e.types.mvex].concat(n, [e.trep()])) }, e.trep = function () { return e.box(e.types.trep, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1])) }, e.stbl = function (t) { return e.box(e.types.stbl, e.stsd(t), e.box(e.types.stts, e.STTS), e.box(e.types.stsc, e.STSC), e.box(e.types.stsz, e.STSZ), e.box(e.types.stco, e.STCO)) }, e.avc1 = function (t) { for (var n = [], r = [], i = 0, o = t.sps; i < o.length; i++) { var a = (c = o[i]).byteLength; n.push(a >>> 8 & 255), n.push(255 & a), n = n.concat(Array.prototype.slice.call(c)) } for (var s = 0, u = t.pps; s < u.length; s++) { var c; a = (c = u[s]).byteLength; r.push(a >>> 8 & 255), r.push(255 & a), r = r.concat(Array.prototype.slice.call(c)) } var l = e.box(e.types.avcC, new Uint8Array([1, n[3], n[4], n[5], 255, 224 | t.sps.length].concat(n).concat([t.pps.length]).concat(r))), d = t.width, f = t.height; return e.box(e.types.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, d >> 8 & 255, 255 & d, f >> 8 & 255, 255 & f, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 18, 98, 105, 110, 101, 108, 112, 114, 111, 46, 114, 117, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 17, 17]), l, e.box(e.types.btrt, new Uint8Array([0, 0, 0, 0, 0, 45, 198, 192, 0, 45, 198, 192]))) }, e.stsd = function (t) { return e.box(e.types.stsd, e.STSD, e.avc1(t)) }, e.tkhd = function (t) { var n = t.id, r = t.width, i = t.height; return e.box(e.types.tkhd, new Uint8Array([0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 2, n >> 24 & 255, n >> 16 & 255, n >> 8 & 255, 255 & n, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, "audio" === t.type ? 1 : 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, r >> 8 & 255, 255 & r, 0, 0, i >> 8 & 255, 255 & i, 0, 0])) }, e.traf = function (t, n) { var r = t.id; return e.box(e.types.traf, e.box(e.types.tfhd, new Uint8Array([0, 2, 0, 0, r >> 24, r >> 16 & 255, r >> 8 & 255, 255 & r])), e.box(e.types.tfdt, new Uint8Array([0, 0, 0, 0, n >> 24, n >> 16 & 255, n >> 8 & 255, 255 & n])), e.trun(t, 72)) }, e.trak = function (t) { return t.duration = t.duration || 4294967295, e.box(e.types.trak, e.tkhd(t), e.mdia(t)) }, e.trex = function (t) { var n = t.id; return e.box(e.types.trex, new Uint8Array([0, 0, 0, 0, n >> 24, n >> 16 & 255, n >> 8 & 255, 255 & n, 0, 0, 0, 1, 0, 0, 0, 60, 0, 0, 0, 0, 0, 1, 0, 0])) }, e.trun = function (t, n) { var r = t.samples || [], i = r.length, o = t.isKeyFrame ? 4 : 0, a = 12 + o + 4 * i, s = new Uint8Array(a); n += 8 + a, s.set([0, 0, 2, t.isKeyFrame ? 5 : 1, i >>> 24 & 255, i >>> 16 & 255, i >>> 8 & 255, 255 & i, n >>> 24 & 255, n >>> 16 & 255, n >>> 8 & 255, 255 & n], 0), t.isKeyFrame && s.set([0, 0, 0, 0], 12); for (var u = 0; u < i; u++) { var c = r[u].size; s.set([c >>> 24 & 255, c >>> 16 & 255, c >>> 8 & 255, 255 & c], 12 + o + 4 * u) } return e.box(e.types.trun, s) }, e.initSegment = function (t, n, r) { e.initalized || e.init(); var i = e.moov(t, n, r), o = new Uint8Array(e.FTYP.byteLength + i.byteLength); return o.set(e.FTYP), o.set(i, e.FTYP.byteLength), o }, e.fragmentSegment = function (t, n, r, i) { var o = e.moof(t, n, r), a = e.mdat(i), s = new Uint8Array(e.STYP.byteLength + o.byteLength + a.byteLength); return s.set(e.STYP), s.set(o, e.STYP.byteLength), s.set(a, e.STYP.byteLength + o.byteLength), s }, e.types = {}, e.initalized = !1, e }(); t.default = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(24), i = function () { function e() { } return e.prototype.clear = function () { this.buffer = void 0 }, e.prototype.append = function (e) { var t, n = []; this.buffer && 1 === e[3] && 0 === e[2] && 0 === e[1] && 0 === e[0] && (n.push(new r.default(this.buffer.subarray(4))), t = Uint8Array.from(e)), null == t && (t = this.mergeBuffer(e)); for (var i, o, a = 0, s = (i = t, o = 3, function () { for (var e = 0; o < i.length; o++)switch (i[o]) { case 0: e++; break; case 1: if (3 === e) return o - 3; default: e = 0 } }), u = s(); null != u; u = s())n.push(new r.default(t.subarray(a + 4, u))), a = u; return this.buffer = t.subarray(a), n }, e.prototype.mergeBuffer = function (e) { if (null == this.buffer) return Uint8Array.from(e); var t = new Uint8Array(this.buffer.byteLength + e.length); return this.buffer.byteLength > 0 && t.set(this.buffer, 0), t.set(e, this.buffer.byteLength), t }, e }(); t.default = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SimpleInteractionHandler = void 0; var r = n(0), i = n(41), o = "[SimpleTouchHandler]", a = function (e) { function t(n, r) { var i = e.call(this, n, t.touchEventsNames, []) || this; return i.listener = r, i.storage = new Map, i } return r.__extends(t, e), t.prototype.onInteraction = function (e) { var t = !1; if (e instanceof MouseEvent) { if (e.target === this.tag) { var n = this.player.getScreenInfo(); if (!n) return; var r = this.buildTouchEvent(e, n, this.storage); if (r.length > 1) return void console.warn(o, "Too many events", r); 1 === r.length && (t = !0, "mousedown" === e.type ? this.startPosition = r[0].position : this.startPosition ? this.endPosition = r[0].position : console.warn(o, 'Received "' + e.type + '" before "mousedown"'), this.startPosition && this.drawPointer(this.startPosition.point), this.endPosition && (this.drawPointer(this.endPosition.point), this.startPosition && this.drawLine(this.startPosition.point, this.endPosition.point)), "mouseup" === e.type && this.startPosition && this.endPosition && (this.clearCanvas(), this.startPosition.point.distance(this.endPosition.point) < 10 ? this.listener.performClick(this.endPosition) : this.listener.performScroll(this.startPosition, this.endPosition))), t && (e.cancelable && e.preventDefault(), e.stopPropagation()) } "mouseup" === e.type && (this.startPosition = void 0, this.endPosition = void 0) } }, t.prototype.onKey = function () { throw Error(o + " Unsupported") }, t.touchEventsNames = ["mousedown", "mouseup", "mousemove"], t }(i.InteractionHandler); t.SimpleInteractionHandler = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.StreamReceiverQVHack = void 0; var r = n(0), i = n(33), o = n(4), a = r.__importDefault(n(1)), s = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r.__extends(t, e), t.prototype.parseParameters = function (t) { var n = e.prototype.parseParameters.call(this, t), i = n.action; if (i !== o.ACTION.STREAM_WS_QVH) throw Error("Incorrect action"); return r.__assign(r.__assign({}, n), { action: i, udid: a.default.parseStringEnv(t.udid) }) }, t }(i.StreamReceiver); t.StreamReceiverQVHack = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ScrcpyFilePushStream = void 0; var r = n(0), i = n(111), o = r.__importDefault(n(37)), a = n(26), s = ["application/vnd.android.package-archive"], u = /\.apk$/i, c = function (e) { function t(t) { var n = e.call(this) || this; return n.streamReceiver = t, n.onDeviceMessage = function (e) { if (e.type === o.default.TYPE_PUSH_RESPONSE) { var t = e.getPushStats(); n.emit("response", t) } }, t.on("deviceMessage", n.onDeviceMessage), n } return r.__extends(t, e), t.prototype.hasConnection = function () { return this.streamReceiver.hasConnection() }, t.prototype.isAllowedFile = function (e) { var t = e.type, n = e.name; return t && s.includes(t) || !t && u.test(n) }, t.prototype.sendEventAppend = function (e) { var t = { id: e.id, chunk: e.chunk, state: a.FilePushState.APPEND }; this.streamReceiver.sendEvent(a.CommandControlMessage.createPushFileCommand(t)) }, t.prototype.sendEventFinish = function (e) { var t = { id: e.id, state: a.FilePushState.FINISH }; this.streamReceiver.sendEvent(a.CommandControlMessage.createPushFileCommand(t)) }, t.prototype.sendEventNew = function (e) { var t = { id: e.id, state: a.FilePushState.NEW }; this.streamReceiver.sendEvent(a.CommandControlMessage.createPushFileCommand(t)) }, t.prototype.sendEventStart = function (e) { var t = { id: e.id, fileName: e.fileName, fileSize: e.fileSize, state: a.FilePushState.START }; this.streamReceiver.sendEvent(a.CommandControlMessage.createPushFileCommand(t)) }, t.prototype.release = function () { this.streamReceiver.off("deviceMessage", this.onDeviceMessage) }, t }(i.FilePushStream); t.ScrcpyFilePushStream = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.FilePushStream = void 0; var r = n(0), i = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r.__extends(t, e), t }(n(8).TypedEmitter); t.FilePushStream = i }]);